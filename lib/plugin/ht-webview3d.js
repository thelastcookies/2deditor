!function(X){"use strict";function O(P){var D,B,w,K,F,h,o,c=[],f=0;D=Y.createDiv(),D.style.overflow="hidden";var R=P.getView();R.insertBefore(D,P.getCanvas()),B=U.Default.createDiv(),B.style.WebkitTransformStyle="preserve-3d",B.style.MozTransformStyle="preserve-3d",B.style.transformStyle="preserve-3d",D.appendChild(B),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(t){var c=t.style;q.addEventListener(R,t.event,function(){D.style.pointerEvents=c})}),this.updateWebView=function(){if(P.getWidth()&&P.getHeight()){var Y=P.getCanvas(),E=1*Y.style.width.slice(0,-2),C=1*Y.style.height.slice(0,-2);(c[0]!==E||c[1]!==C)&&(c[0]=E,c[1]=C,D.style.width=E+"px",D.style.height=C+"px",B.style.width=E+"px",B.style.height=C+"px");var v=P._projectMatrix[5]*c[1]/2;v!==w&&(w=v,D.style.WebkitPerspective=w+"px",D.style.MozPerspective=w+"px",D.style.perspective=w+"px"),h="translateZ("+w+"px)"+J(P._viewMatrix);var Q=h+"translate("+c[0]/2+"px,"+c[1]/2+"px)";K===Q||F||(B.style.WebkitTransform=Q,B.style.MozTransform=Q,B.style.transform=Q,K=Q),f++,o=!1,P.dm().each(function(m){m.isWebView&&H(m)});for(var u,R=B.children,G=[],x=0,p=R.length;p>x;x++)u=R[x],u._isHtWebView&&u._renderCookie!==f&&G.push(u);G.length&&G.forEach(function(j){B.removeChild(j)})}};var $=new Array(16),H=function(s){var n=s.getAttach();if(n){n.parentElement!==B&&B.appendChild(n),n._renderCookie=f,o=!0;var d=s.getFinalScale3d(),r=s._prefrenceSize;r&&r[0]?r[1]||(r[1]=r[0]/d[0]*d[1]):r=[d[0],d[1]],n.style.width=r[0]+"px",n.style.height=r[1]+"px";var j=1/r[0],V=1/r[1],O=1,Q=s.mat;$[0]=Q[0]*j,$[1]=Q[1]*j,$[2]=Q[2]*j,$[3]=Q[3]*j,$[4]=Q[4]*V,$[5]=Q[5]*V,$[6]=Q[6]*V,$[7]=Q[7]*V,$[8]=Q[8]*O,$[9]=Q[9]*O,$[10]=Q[10]*O,$[11]=Q[11]*O,$[12]=Q[12],$[13]=Q[13],$[14]=Q[14],$[15]=Q[15];var T=A($,F?"translate("+c[0]/2+"px,"+c[1]/2+"px)"+h:""),N=n.$a2;N!==T&&(n.$a2=T,n.style.WebkitTransform=T,n.style.MozTransform=T,n.style.transform=T)}}}function r(Y){return Math.abs(Y)<1e-10?0:Y}function J(z){var X=z;return"matrix3d("+r(X[0])+","+r(-X[1])+","+r(X[2])+","+r(X[3])+","+r(X[4])+","+r(-X[5])+","+r(X[6])+","+r(X[7])+","+r(X[8])+","+r(-X[9])+","+r(X[10])+","+r(X[11])+","+r(X[12])+","+r(-X[13])+","+r(X[14])+","+r(X[15])+")"}function A(W,u){var k=W,a="matrix3d("+r(k[0])+","+r(k[1])+","+r(k[2])+","+r(k[3])+","+r(-k[4])+","+r(-k[5])+","+r(-k[6])+","+r(-k[7])+","+r(k[8])+","+r(k[9])+","+r(k[10])+","+r(k[11])+","+r(k[12])+","+r(k[13])+","+r(k[14])+","+r(k[15])+")";return"translate(-50%,-50%)"+(u||"")+a}var R="ht",U=X[R],Y=U.Default,q=Y.getInternal(),s=q.superCall,v=U.graph3d.Graph3dView,o=v.prototype.validateImpl;v.prototype.validateImpl=function(){o.call(this);var d=this._webViewRenderer;d||(d=this._webViewRenderer=new O(this)),d.updateWebView()};var u=U.WebView3d=function(){var $=this;s(u,$),$.s({shape3d:"billboard","shape3d.reverse.flip":!0})},k=[1,1,1,1],P=[0,0,0,0];Y.def(R+"."+"WebView3d",U.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(A,X,B){if(!A)return this.detachDOM();if("string"==typeof A){var H=document.createElement("iframe");H.src=A,A=H}var h=A.style;h.position="absolute",h.border=0,h.outline=0,h.padding=0,h.margin=0,A._isHtWebView=!0,this.setAttach(A),this._prefrenceSize=[X,B],this.s("shape3d.blend",P)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(j){this.a("defaultBgColor",j),this.getAttach()||this.s("shape3d.blend",j)},getBgColor:function(){return this.a("defaultBgColor")||k}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);