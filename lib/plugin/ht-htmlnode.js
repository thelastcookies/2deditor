!function(s){"use strict";var D="ht",M=s[D],$=function(){return document},h=function(){return $().body},o=function(G,I,j){G.style.setProperty(I,j,null)},Z=function(v){return $().createElement(v)},J=function(){return Z("div")},B=function(){var v=Z("canvas");return v},f=function(Q,p){o(Q,"-webkit-transform",p),o(Q,"-ms-transform",p),o(Q,"transform",p)},l=function(h,M){o(h,"-webkit-transform-origin",M),o(h,"-ms-transform-origin",M),o(h,"transform-origin",M)},m=function(q,L){q.appendChild(L)},R=function(z,Z){z.removeChild(Z)},L=s.parseInt,Y=M.Default,P=Y.getInternal(),G=P.addEventListener,S=(P.removeEventListener,Math.PI),g="white-space",b="visibility",I="left",q="top",p="width",r="height",V="position",Q="display",E="z-index",N="px",x="0 0",H="absolute",i="visible",w="hidden",v="none",C="block",U="nowrap",a="rgba(0, 0, 0, 0.005)";Y.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var K=M.graph.GraphView.prototype,e=K._42;K.adjustHtmlNodeIndex=!0,K._42=function(X,Q){if(e.call(this,X,Q),this.adjustHtmlNodeIndex)for(var B=this.getDataModel()._datas._as,u=B.length,v=1,R=0;u>R;R++){var g=B[R];if(g instanceof A){var U=this.getDataUI(g);o(U.$2f,E,v+""),o(U.$3f,E,v+1+""),v+=2}}};var X=M.HtmlNodeUI=function(P,T){var k=this;X.superClass.constructor.call(k,P,T);var i=k.$2f=J(),C=k.$3f=B();o(i,V,H),o(i,b,w),o(i,g,U),C.draggable=!1,o(C,V,H),o(C,Q,v),l(C,x),G(i,"change",function(h){var c=h.target,R=c.bind||c.getAttribute("bind"),X=c.type&&"checkbox"===c.type?c.checked:c.value,m=T.getContext();R&&m&&(m[R]=X,k.$4f=JSON.stringify(m))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(b){G(i,b,this.$9f.bind(this))},k)};Y.def(X,P.ui().NodeUI,{_visible:!0,$11f:function(){var T=this,I=T.$3f,G=T._data,$=G.getDraggerImageWidth(),h=G.getDraggerImageHeight(),f=G.getDraggerImage(),F=P.initContext(I);F.beginPath(),P.setCanvas(I,$,h),P.translateAndScale(F,0,0,1),F.clearRect(0,0,$,h),Y.drawImage(F,Y.getImage(f),0,0,$,h),F.restore()},_80o:function(F){X.superClass._80o.call(this,F);var d=this,g=d._data,G=g._padding,O=2*G,Z=d.$2f,P=d.$3f,t=d.gv,K=t.getZoom(),U=t.getTranslateX(),y=t.getTranslateY(),h=t.getView(),W=d._83o,B=g._width,e=g._height,s=W.position,c=W.rotation,u=(B-O)/g.$5f*K,Y=(e-O)/g.$6f*K,M=d._html,n=g._html,l=g.getHtmlType();if("html"===l){var z=g.getContext()||{},x=d.$4f,$=g.$10f,k=JSON.stringify(z);M&&x&&M===n&&x===k||(d.$4f=k,d._html=n,Z.innerHTML=$?$(z):n)}else if(null!=l){var R=g.getHtml();"ht"===l&&(R=R.getView()),M&&M===R&&Z.contains(M)||(d._html=R,Z.innerHTML="",m(Z,R))}if(!Z.parentNode){var _=t.$1f;if(!_){var j=J();o(j,V,H),o(j,E,"0"),_=t.$1f=j;var A=t._canvas.nextSibling;A?h.insertBefore(j,A):m(h,j)}m(_,Z),m(_,P),g.onContentInitialized&&g.onContentInitialized(Z)}if(g._scalable){var D=g.$5f,T=g.$6f;f(Z,"rotate("+180*(c/S)+"deg) scale("+u+","+Y+")"),o(Z,p,""),o(Z,r,""),o(Z,I,(s.x-D/K/2)*K+U+N),o(Z,q,(s.y-T/K/2)*K+y+N)}else{var so=L(Z.style.width),vs=L(Z.style.height),yb=L((B-O)*K),Fj=L((e-O)*K),on="100%",Uc=Z.children[0];o(Uc,p,on),o(Uc,r,on),(so!==yb||vs!==Fj)&&(o(Z,p,yb+N),o(Z,r,Fj+N),"ht"===l&&n.invalidate()),f(Z,"rotate("+180*(c/S)+"deg)"),o(Z,I,(s.x-yb/K/2)*K+U+N),o(Z,q,(s.y-Fj/K/2)*K+y+N)}var Zf=d.dragRect;t.isMovable(g)&&t.isSelected(g)&&Zf?(F.save(),F.fillStyle=a,F.fillRect(Zf.x,Zf.y,Zf.width,Zf.height),F.restore(),o(P,I,Zf.x*K+U+N),o(P,q,Zf.y*K+y+N),f(P,"scale("+K+","+K+")"),o(P,Q,C),d.$11f()):o(P,Q,v),o(Z,b,this._visible?i:w)},dispose:function(){var _=this.gv.$1f;this.$2f.parentNode===_&&_.removeChild(this.$2f),this.$3f.parentNode===_&&_.removeChild(this.$3f)},_84o:function(A){this._visible=A,o(this.$2f,b,A?i:w),o(this.$3f,Q,A?C:v)},_3O:function(){var V=this,p=V.gv,j=V._data;X.superClass._3O.call(V);var i=j.getRect();p.isEditable(j)&&(V.dragRect={x:i.x+i.width+j._padding,y:i.y+10,width:j.getDraggerImageWidth(),height:j.getDraggerImageHeight()},V._68o(V.dragRect))},rectIntersects:function(d){var z=this._79o();return M.Default.intersection(z,d)?!0:void 0},$9f:function(U){var z=this.gv,X=this._data;z.sm().contains(X)&&U.stopPropagation()}});var A=M.HtmlNode=function(){A.superClass.constructor.call(this)};M.Default.def(A,M.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:M.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(f){var o=this,J=o._html;o._html=f,"html"===o.getHtmlType()&&"Handlebars"in s&&(o.$10f=Handlebars.compile(f)),o.$13f(),o.fp("html",J,f)},setContext:function(O){var g=this,t=g._context;g._context=O,g.fp("context",t,O),g.$13f()},setScalable:function(c){var W=this,x=W._scalable;W._scalable=c,W.fp("scalable",x,c),W.$13f()},getHtmlType:function(){var d=this._html;return d?"string"==typeof d?"html":d.getView?"ht":"dom":null},$13f:function(){var Y=this,G=Y._html,n=Y.$10f;if(G){var c=J(),l=!1,W=Y.getHtmlType();if(o(c,V,H),o(c,g,U),o(c,b,w),"html"===W?(c.innerHTML=n?n(Y.getContext()||{}):G,l=!0):"ht"===W?(m(c,G.getView()),l=!0):"dom"===W&&(m(c,G),l=!0),l){var Z=2*Y._padding;m(h(),c),Y.$5f=c.scrollWidth,Y.$6f=c.scrollHeight,Y._width=Y.$5f+Z,Y._height=Y.$6f+Z,Y._originWidth=Y._width,Y._originHeight=Y._height,R(h(),c)}}},getUIClass:function(){return M.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);