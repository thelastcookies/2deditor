!function(H,F,L){"use strict";var Q="ht",n=H[Q],G=n.Default,U=n.graph,x=G.getInternal(),t=x.ui(),o=t.NodeUI.prototype,A=t.ShapeUI.prototype,b=U.GraphView,J=b.prototype,B=t.EdgeUI.prototype,l=n.Node,K=n.Shape,r=n.Edge,v=n.Group,O=G.isTouchable,V=G.preventDefault,g=H.setTimeout,i=G.grow,E=G.isDragging,X=G.getDistance,s=null,f=n.List,u="undefined"!=typeof Float32Array?Float32Array:Array,c=Math,M=c.PI,p="Crossing",z="No Crossing",w=M/2,Y=2*M,C=c.atan2,R=c.sqrt,k=c.pow,m=c.sin,q=c.cos,S=c.min,d=c.max,Z=c.abs,y=c.ceil,T=c.round,e=G.unionPoint,j=G.unionRect,P=G.containsPoint,W=G.clone,h="rgb(52, 152, 219)",N="red",I={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},D={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var W=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],Y=0;Y<W.length;Y++){var n=W[Y];n=0===Y%2?n/400*D.width:n/100*D.height,W[Y]=n}return D.width>120&&(W[4]=D.width-26,W[6]=D.width-40,W[10]=D.width-40,W[12]=D.width-26,W[18]=33),W}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},$={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:h,rotation:.61},{type:"circle",rect:[200,120,70,70],background:h,rotation:.61},{type:"circle",rect:[200,220,70,70],background:h,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:h},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:h}]},a={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:N,rotation:.61}]},_={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:h},{type:"circle",rect:[0,210,90,90],background:h},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:h}]},Ib={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:N},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:N}]},Rh={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:h}]},ag={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:N}]},qb={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},_r={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Rq=function(g){var V=g.touches[0];return V?V:g.changedTouches[0]},Uc=function(d,j,b,c){return C(c-j,b-d)},wk=function(u,v){return{x:u.x*v,y:u.y*v}},pq=function(v,t){v.each(function(C){return v.isSelected(C)?t(C):void 0})},jq=function(d,n){d.reverseEach(function(w){return d.isSelected(w)?n(w):void 0})},Lp=function(o,g,S){var D,A,y,i,$,n=this,q=g,h=n.gv;if(o instanceof K){y=o.getSegments();var a=h.getDataUI(o);$=a._55O.$15l,y&&y.size()||(y=Ag($)),o.isClosePath()&&y.indexOf(5)<0&&(y=new f(y._as),y.add(5)),D=Oo(o,a,q),A=$[D]}else{var s=h.getDataUI(o);$=hs(s,o.s("edge.points")),y=o.s("edge.segments"),y&&y.size()||(y=Ag($)),$=$._as,D=Oo(o,s,q),A=$[D]}if(y&&(i=y.get(q)),2===i||1===i||5===i){var t=$[D+1];5===i&&(t=$[0]);var N=ns(A,S,t);return N}return S},zc=function(M,C,O,T){var x=C/2,S=O/2,l=nh(M,-x,-S,T),A=nh(M,x,-S,T),g=nh(M,-x,S,T),B=nh(M,x,S,T),_=nh(M,0,-S,T),y=nh(M,x,0,T),H=nh(M,0,S,T),F=nh(M,-x,0,T);return[l,A,g,B,_,y,H,F]},ns=function(B,M,H){var r={x:M.x-B.x,y:M.y-B.y},Q={x:H.x-B.x,y:H.y-B.y},b=R(k(H.x-B.x,2)+k(H.y-B.y,2)),Z={x:Q.x/b,y:Q.y/b},h=r.x*Z.x+r.y*Z.y,u={x:Z.x*h,y:Z.y*h};return{x:B.x+u.x,y:B.y+u.y}},nh=function(J,V,W,H){var I=q(H)*V-m(H)*W,O=m(H)*V+q(H)*W;return J?{x:J.x+I,y:J.y+O}:{x:I,y:O}},Eo=function(H,X){return X>2*H?H:X/2},he=function(M,V,g,t){var k=X(M,V);return g=t?S(g,k):Eo(g,k),k?g/=k:g=0,{x:M.x+(V.x-M.x)*g,y:M.y+(V.y-M.y)*g}},Sj=function(g,I){var A,O,b=g.gv,P=g._data,c=P._40I,z=P._41I,L=P.s("edge.offset"),Z=P.s("edge.source.position"),T=P.s("edge.target.position"),q=P.s("edge.source.offset.x"),h=P.s("edge.source.offset.y"),p=P.s("edge.target.offset.x"),u=P.s("edge.target.offset.y"),s=P.s("edge.source.anchor.x"),w=P.s("edge.source.anchor.y"),B=P.s("edge.target.anchor.x"),M=P.s("edge.target.anchor.y");if(I?(A=x.getEdgeAgentPosition(b,c,Z,q,h,s,w),O=x.getEdgeAgentPosition(b,z,T,p,u,B,M)):(A=x.getEdgeAgentPosition(b,c,Z,0,0,s,w),O=x.getEdgeAgentPosition(b,z,T,0,0,B,M)),"points"===P.s("edge.type")&&L&&!P.s("edge.center")&&A){var J=P.s("edge.points")||new f,H=J.size(),Q=he(A,H?J.get(0):O,L,H),_=he(O,H?J.get(H-1):A,L,H);A=Q,O=_}return[A,O]},hs=function(A,n,l){var L=A._78o,r=A._data,Q=r.s("edge.type"),q=[L.sourcePoint,L.targetPoint];return"points"===Q?l&&(q=Sj(A)):q=L.center?Q?l?Sj(A):Sj(A,!0):l?Sj(A):[L.c1,L.c2]:l?Sj(A):Sj(A,!0),n=new f(n?n._as:s),n.add(q[0],0),n.add(q[1]),n},Wh=function(M){return M=new f(M._as),M.removeAt(0),M.removeAt(M.size()-1),M},Ag=function(Y){Y._as||(Y=new f(Y));var E=new f;E.add(1);for(var t=1;t<Y.size();t++)E.add(2);return E},sj=function(N,v){return{x:(N.x+v.x)/2,y:(N.y+v.y)/2}},Pf=function(X,M){return{x:X.x+1*(M.x-X.x)/4,y:X.y+1*(M.y-X.y)/4}},al=function(M,J){return{x:M.x+3*(J.x-M.x)/4,y:M.y+3*(J.y-M.y)/4}},fn=function($,i,p,e){var I=i.x+i.width/2,B=i.y+i.height/2,L=R(I*I+B*B),Y=C(B,I)+p;return{x:e.x+L*q(Y),y:e.y+L*m(Y)}},lf=J.validateImpl,ls=J.isRectEditable,uj=J.isPointEditable,wq=J._42,Dc=A._79o,Vf=B._79o,Gn=A._48O,qi=A._47O,hp=o._48O,qo=o._80o,or=A._80o,vn=o.getSelectWidth,hi=o._47O,Ai=B._47O,rb=J.isEditable,Cd=["northwest","north","northeast","east","southeast","south","southwest","west"],sg=function(J,n,m,t,D,B,c,N,d,R){var H=J.x,$=J.y,j=J.width,b=J.height,G={x:H+j/2,y:$+b/2};t=t||0,n=nh(G,n.x-G.x,n.y-G.y,-t),c&&!N&&(n.x+=d,n.y+=R);var Q=.01;if("northwest"===m?(n.x+D>H+j-Q&&(n.x=H+j-D-Q),n.y+D>$+b-Q&&(n.y=$+b-D-Q),J=e(n,{x:H+j,y:$+b})):"north"===m?(n.y+D>$+b-Q&&(n.y=$+b-D-Q),J=e({x:H,y:n.y},{x:H+j,y:$+b})):"northeast"===m?(n.x<H+D+Q&&(n.x=H+D+Q),n.y+D>$+b-Q&&(n.y=$+b-D-Q),J=e({x:H,y:n.y},{x:n.x,y:$+b})):"west"===m?(n.x+D>H+j-Q&&(n.x=H+j-D-Q),J=e({x:n.x,y:$},{x:H+j,y:$+b})):"east"===m?(n.x<H+D+Q&&(n.x=H+D+Q),J=e({x:H,y:$},{x:n.x,y:$+b})):"southwest"===m?(n.x+D>H+j-Q&&(n.x=H+j-D-Q),n.y<$+D+Q&&(n.y=$+D+Q),J=e({x:n.x,y:$},{x:H+j,y:n.y})):"south"===m?(n.y<$+D+Q&&(n.y=$+D+Q),J=e({x:H,y:$},{x:H+j,y:n.y})):"southeast"===m&&(n.x<H+D+Q&&(n.x=H+D+Q),n.y<$+D+Q&&(n.y=$+D+Q),J=e({x:H,y:$},n)),"keepRatio"===B&&(!c&&N||c&&!N)&&("northeast"===m||"southeast"===m||"northwest"===m||"southwest"===m)){var l=J.width,y=J.height,q=l/j,K=y/b,w=S(q,K);J.width=j*w,J.height=b*w,"northeast"===m?J.y=$+(b-J.height):"northwest"===m?(J.y=$+(b-J.height),J.x=H+(j-J.width)):"southwest"===m&&(J.x=H+(j-J.width))}J.x-=G.x,J.y-=G.y;var W=fn(s,J,t,G);return J.x=W.x-J.width/2,J.y=W.y-J.height/2,J},Uq=function(d,j,h,Q){var q=d.getRotation(),o=j,x=o.x,V=o.y,g=o.width,B=o.height,H={x:x+o.width/2,y:V+o.height/2};Q=nh(H,Q.x-H.x,Q.y-H.y,-q),"northwest"===h?o=e(Q,{x:x+g,y:V+B}):"north"===h?o=e({x:x,y:Q.y},{x:x+g,y:V+B}):"northeast"===h?o=e({x:x,y:Q.y},{x:Q.x,y:V+B}):"west"===h?o=e({x:Q.x,y:V},{x:x+g,y:V+B}):"east"===h?o=e({x:x,y:V},{x:Q.x,y:V+B}):"southwest"===h?o=e({x:Q.x,y:V},{x:x+g,y:Q.y}):"south"===h?o=e({x:x,y:V},{x:x+g,y:Q.y}):"southeast"===h&&(o=e({x:x,y:V},Q)),d.setRect(o),o.x-=H.x,o.y-=H.y;var J=fn(d,o,q,H);d.p(J.x,J.y)},td=function(u,t,F,D,k,a,y,P){var R=s;a?(R=nh(s,k.x-t.x,k.y-t.y,-F),R.x-=y.x,R.y-=y.y):R=nh(s,k.x-t.x,k.y-t.y,0);var p={x:t.x+R.x,y:t.y+R.y};P&&(p=P(p.x,p.y)),p.e=u.getPoints().get(D).e,u.setPoint(D,p);var J=u.getWidth(),h=u.getHeight(),O=u.p().x-J/2,_=u.p().y-h/2;O-=t.x,_-=t.y;var C=fn(u,{x:O,y:_,width:J,height:h},F,t);u.p(C.x,C.y)},Oo=function(O,l,z){var B,o;if(O instanceof K?(B=O.getPoints(),o=O.getSegments()):O instanceof r&&"points"===O.s("edge.type")&&(B=O.s("edge.points"),o=O.s("edge.segments"),B=hs(l,B)),o&&o.size()||(o=Ag(B)),O instanceof K&&O.isClosePath()&&o.indexOf(5)<0&&(o=new f(o._as),o.add(5)),o)for(var Y=-1,$=0;$<o.size();$++){if($===z)return Y;var g=o.get($);1===g?Y+=1:2===g?Y+=1:3===g?Y+=2:4===g&&(Y+=3)}},vg=function(y,E,s){var j,G;if(y instanceof K?(j=y.getPoints(),G=y.getSegments()):y instanceof r&&"points"===y.s("edge.type")&&(j=y.s("edge.points"),G=y.s("edge.segments"),j=hs(E,j)),G&&G.size()||(G=Ag(j)),G)for(var U=-1,D=0;D<G.size();D++){var c=G.get(D);if(1===c?U+=1:2===c?U+=1:3===c?U+=2:4===c&&(U+=3),U===s)return D}},gk=function(s,h){var X=[s[0]-h[0],s[1]-h[1],s[2]-h[2]];return X},Kf=function(){var V=new u(16);return V[0]=1,V[1]=0,V[2]=0,V[3]=0,V[4]=0,V[5]=1,V[6]=0,V[7]=0,V[8]=0,V[9]=0,V[10]=1,V[11]=0,V[12]=0,V[13]=0,V[14]=0,V[15]=1,V},jh=function(j,v){var G=j[0],O=j[1],r=j[2];return j[0]=v[0]*G+v[4]*O+v[8]*r+v[12],j[1]=v[1]*G+v[5]*O+v[9]*r+v[13],j[2]=v[2]*G+v[6]*O+v[10]*r+v[14],j},hn=function(w,c){if(c){var S=m(c),J=q(c),l=w[0],C=w[1],u=w[2],B=w[3],o=w[8],A=w[9],k=w[10],G=w[11];w[0]=l*J-o*S,w[1]=C*J-A*S,w[2]=u*J-k*S,w[3]=B*J-G*S,w[8]=l*S+o*J,w[9]=C*S+A*J,w[10]=u*S+k*J,w[11]=B*S+G*J}},yn=function(g,i){for(var J=g.s("grid.row.count"),p=g.s("grid.column.count"),o=0;J>o;o++)for(var S=0;p>S;S++){var e=g.getCellRect(o,S);if(P(e,i))return{rowIndex:o,columnIndex:S,rect:e,grid:g}}return null},Vb=function(I,Q,g,w,B,M){var r={},D=g-I,m=w-Q,X=c.sqrt(D*D+m*m),O=D/X,Z=m/X,e=(-I+B)*O+(-Q+M)*Z;return 0>=e?(r.x=I,r.y=Q):e>=X?(r.x=g,r.y=w):(r.x=I+e*O,r.y=Q+e*Z),D=B-r.x,m=M-r.y,r.z=c.sqrt(D*D+m*m),r},bc=function(Y,g){var J,W,N,c,b,G,a,w,I=Y.getPoints(),Q=Y.getSegments(),h=Y.p(),u=Y.getRotation();if(!Q||!(Q.indexOf(3)>0||Q.indexOf(4)>0)){for(w=0;w<=I.size()-1;w++)if(w===I.size()-1?(b=I.get(0),c=I.get(w)):(c=I.get(w),b=I.get(w+1)),c=nh(h,c.x-h.x,c.y-h.y,u),b=nh(h,b.x-h.x,b.y-h.y,u),G=Vb(c.x,c.y,b.x,b.y,g.x,g.y),a=G.z,a<(Y.s("shape.border.width")||10)){W=c,N=b,J=w;break}if(J!=s){var e=Vb(W.x,W.y,N.x,N.y,g.x,g.y),B=X(W,e);return{attachIndex:J,attachOffset:B}}}},wb=function(D){for(var B=D._data,b=B.p(),T=B.getRotation(),m=B.getPoints(),t=s,c=[],l=0;l<m.size();l++)t=m.get(l),c.push(nh(b,t.x-b.x,t.y-b.y,T));D._55O.$15l=c};G.setImage("xeditinteractor_parentIcon",$),G.setImage("xeditinteractor_hostIcon",a),G.setImage("xeditinteractor_edgeIcon",_),G.setImage("xeditinteractor_removeIcon",Ib),G.setImage("xeditinteractor_sourceIcon",Rh),G.setImage("xeditinteractor_targetIcon",ag),G.setImage("xeditinteractor_elevationIcon",qb),G.setImage("xeditinteractor_tallIcon",_r),J._editPointSize=O?24:9,J._edgeHelpers=["parent","remove","source","target"],J._leftTopHelpers=["parent"],J._rightTopHelpers=["host"],J._leftBottomHelpers=["edge"],J._rightBottomHelpers=["remove"],Cd=Cd.concat(Cd).concat(Cd),B._79o=function(){var W=this,y=W.gv,O=y.getZoom(),V=y._editInteractor,Q=Vf.call(W);if(!Q)return null;var w=Sj(W,!0),v=w[0],R=w[1],x={x:Q.x,y:Q.y,width:Q.width,height:Q.height},b=e(v,R);if(V instanceof U.XEditInteractor){x=j(x,b);var _=W._55O,c=y.getEditPointSize()/O+2,t=0;_&&_._43O&&(t+=c/2,i(x,t))}return x},B._47O=function(g){var h=this,X=h.gv,N=X._editInteractor;N instanceof U.XEditInteractor||Ai.call(h,g)},B.rectIntersects=function(z){var c=this,h=c._data,j=c.gv,d=j.getZoom(),$=c._55O,X=j._editInteractor;if(X instanceof U.XEditInteractor&&j.isEditable(h)&&$&&$._43O&&"points"===h.s("edge.type")){var K=h.s("edge.points"),I=h.s("edge.segments");K=hs(c,K),I&&I.size()||(I=Ag(K)),K=K._as;var M=!1,t=O?5:1,A=z.x+t,_=z.y+t,R={x:A,y:_};if(X._edge===h&&X._hoverSegmentIndex>=0){var N=j._editInteractor._hoverSegmentIndex,G=I.get(N),n=Oo(h,c,N),E=s;if(n!=s&&n>=0){var b=K[n],i=j.getSegmentHoverWidth()/d;if(2===G||1===G){var f=K[n+1];E=io(new Dl(b.x,b.y),new Dl(f.x,f.y),new Dl(R.x-i,R.y-i),new Dl(R.x+2*i,R.y+2*i)),E.$62l===p&&(M=!0)}else if(3===G){var y=K[n+1],f=K[n+2];E=Pp(new Dl(b.x,b.y),new Dl(y.x,y.y),new Dl(f.x,f.y),new Dl(R.x-i,R.y-i),new Dl(R.x+2*i,R.y+2*i)),E.$62l===p&&(M=!0)}else if(4===G){var V=K[n+1],W=K[n+2];f=K[n+3],E=Ar(new Dl(b.x,b.y),new Dl(V.x,V.y),new Dl(W.x,W.y),new Dl(f.x,f.y),new Dl(R.x-i,R.y-i),new Dl(R.x+2*i,R.y+2*i)),E.$62l===p&&(M=!0)}}}if(M)return!0}return s},A._47O=function(h){var p=this,w=p.gv,M=w._editInteractor;M instanceof U.XEditInteractor||qi.call(p,h)},A.rectIntersects=function(v){var m=this,f=m._data,V=m.gv,T=V.getZoom(),e=m._55O,k=V._editInteractor;if(k instanceof U.XEditInteractor&&V.isEditable(f)&&e&&e._43O){var R=e.$15l,b=!1,F=O?5:1,A=v.x+F,X=v.y+F,S={x:A,y:X};if(R&&R.length===f.getPoints().size()||(wb(m),R=e.$15l),k._shape===f&&k._hoverSegmentIndex>=0){var Z=f.getSegments();Z&&Z.size()||(Z=Ag(R));var h=V._editInteractor._hoverSegmentIndex,I=Z.get(h),_=Oo(f,m,h),H=s;if(_!=s&&_>=0){var w=R[_],W=V.getSegmentHoverWidth()/T;if(2===I||1===I){var u=R[_+1];H=io(new Dl(w.x,w.y),new Dl(u.x,u.y),new Dl(S.x-W,S.y-W),new Dl(S.x+2*W,S.y+2*W)),H.$62l===p&&(b=!0)}else if(3===I){var J=R[_+1],u=R[_+2];H=Pp(new Dl(w.x,w.y),new Dl(J.x,J.y),new Dl(u.x,u.y),new Dl(S.x-W,S.y-W),new Dl(S.x+2*W,S.y+2*W)),H.$62l===p&&(b=!0)}else if(4===I){var n=R[_+1],P=R[_+2];u=R[_+3],H=Ar(new Dl(w.x,w.y),new Dl(n.x,n.y),new Dl(P.x,P.y),new Dl(u.x,u.y),new Dl(S.x-W,S.y-W),new Dl(S.x+2*W,S.y+2*W)),H.$62l===p&&(b=!0)}}}if(b)return!0}return s},A._48O=function(){var r=this,X=r.gv,W=X._editInteractor;W instanceof U.XEditInteractor?(o._48O.call(r),r._55O._43O&&wb(r)):Gn.call(r)},A._79o=function(){var R=this,p=R.gv,Z=p.getZoom(),x=p._editInteractor,W=Dc.call(R);if(W){var o={x:W.x,y:W.y,width:W.width,height:W.height};if(x instanceof U.XEditInteractor){var $=R._55O,N=p.getEditPointSize()/Z+2,u=0;$&&$._43O&&(u+=N/2,i(o,u))}return o}},o._47O=function(c){var K=this,A=K.gv,d=A._editInteractor;if(d instanceof U.XEditInteractor);else{var S=K._55O;S&&S._98o&&hi.call(K,c)}},o.getSelectWidth=function(){var i=this,d=i.gv,N=d._editInteractor,H=i._data;return d.isEditable(H)&&N instanceof U.XEditInteractor?0:vn.call(i)},o._80o=function(u){var x=this,$=x.gv._editInteractor;if(qo.call(x,u),$&&$._debug){u.save(),u.beginPath(),u.lineWidth=1,u.strokeStyle="green";var F=x._79o();F&&(u.rect(F.x,F.y,F.width,F.height),u.stroke()),u.restore()}},A._80o=function(K){var w=this,a=w.gv._editInteractor;if(or.call(w,K),a&&a._debug){K.save(),K.beginPath(),K.lineWidth=1,K.strokeStyle="green";var Y=w._79o();K.rect(Y.x,Y.y,Y.width,Y.height),K.stroke(),K.restore()}},o._48O=function(){var x=this,R=x.gv,T=x._data,d=R._editInteractor,q=x._55O,P=T.p(),h=T.getRotation();if(d instanceof U.XEditInteractor){if(q._42O){var O=zc(P,T.getWidth(),T.getHeight(),h),t=O[0],A=O[1],f=O[2],_=O[3],Q=O[4],a=O[5],F=O[6],J=O[7];q.$45l=[t,Q,A,a,_,F,f,J]}}else hp.call(x)},J.getResizeMode=function(){return this.$25l||"normal"},J.setResizeMode=function(O){var j=this.$25l;this.$25l=O,this.fp("resizeMode",j,O)},J.getSnapAngle=function(){return this.$26l||Math.PI/36},J.setSnapAngle=function(O){var q=this.$26l;this.$26l=O,this.fp("snapAngle",q,O)},J.getSnapSpacing=function(){return this.$27l},J.setSnapSpacing=function(_){var u=this.$27l;this.$27l=_,this.fp("snapSpacing",u,_)},J.getPointSnapSpacing=function(){return this._pointSnapSpacing},J.setPointSnapSpacing=function(k){var S=this._pointSnapSpacing;this._pointSnapSpacing=k,this.fp("pointSnapSpacing",S,k)},J.setHelperEditableFunc=function(b){var i=this._helperEditableFunc;this._helperEditableFunc=b,this.fp("helperEditableFunc",i,b)},J.getHelperEditableFunc=function(){return this._helperEditableFunc},J.setLeftTopHelpers=function(g){var D=this._leftTopHelpers;this._leftTopHelpers=g,this.fp("leftTopHelpers",D,g)},J.getLeftTopHelpers=function(){return this._leftTopHelpers},J.setLeftTopHelpersAlign=function(R){var a=this._leftTopHelpersAlign;this._leftTopHelpersAlign=R,this.fp("leftTopHelpersAlign",a,R)},J.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},J.setRightTopHelpers=function(M){var i=this._rightTopHelpers;this._rightTopHelpers=M,this.fp("rightTopHelpers",i,M)},J.getRightTopHelpers=function(){return this._rightTopHelpers},J.setRightTopHelpersAlign=function(e){var C=this._rightTopHelpersAlign;this._rightTopHelpersAlign=e,this.fp("rightTopHelpersAlign",C,e)},J.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},J.setLeftBottomHelpers=function(q){var $=this._leftBottomHelpers;this._leftBottomHelpers=q,this.fp("leftBottomHelpers",$,q)},J.getLeftBottomHelpers=function(){return this._leftBottomHelpers},J.setLeftBottomHelpersAlign=function(q){var I=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=q,this.fp("leftBottomHelpersAlign",I,q)},J.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},J.setRightBottomHelpers=function(s){var t=this._rightBottomHelpers;this._rightBottomHelpers=s,this.fp("rightBottomHelpers",t,s)},J.getRightBottomHelpers=function(){return this._rightBottomHelpers},J.setRightBottomHelpersAlign=function($){var C=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=$,this.fp("rightBottomHelpersAlign",C,$)},J.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},J.setEdgeHelpers=function(d){var P=this._edgeHelpers;this._edgeHelpers=d,this.fp("edgeHelpers",P,d)},J.getEdgeHelpers=function(){return this._edgeHelpers},J.isHelperEditable=function(E,p){return E instanceof r&&("host"===p||"edge"===p||"elevation"===p||"tall"===p)?!1:E instanceof l&&("source"===p||"target"===p)?!1:"pointElevation"===p?this._helperEditableFunc?this._helperEditableFunc(E,p):!1:this._helperEditableFunc?this._helperEditableFunc(E,p):!0},J.getEditHelperSize=function(){return this._editHelperSize||(O?28:16)},J.setEditHelperSize=function(p){var d=this._editHelperSize;this._editHelperSize=p,this.fp("editHelperSize",d,p)},J.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},J.setEditRectBorderColor=function(s){var z=this.$28l;this.$28l=s,this.fp("editRectBorderColor",z,s)},J.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},J.setNodeBorderColor=function(I){var s=this.$29l;this.$29l=I,this.fp("nodeBorderColor",s,I)},J.getEditRectBorderStyle=function(){return this.$30l||"dashed"},J.setEditRectBorderStyle=function(s){var $=this.$30l;this.$30l=s,this.fp("editRectBorderStyle",$,s)},J.getControlPointBackground=function(){return this.$31l||"#ff0"},J.setControlPointBackground=function(y){var G=this.$31l;this.$31l=y,this.fp("controlPointBackground",G,y)},J.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},J.setControlPointBorderColor=function(V){var o=this.$32l;this.$32l=V,this.fp("controlPointBorderColor",o,V)},J.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},J.setJoinPointBackground=function(X){var E=this.$33l;this.$33l=X,this.fp("joinPointBackground",E,X)},J.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},J.setJoinPointBorderColor=function(h){var x=this.$34l;this.$34l=h,this.fp("joinPointBorderColor",x,h)},J.getDirectionLineColor=function(){return this.$35l||"#888"},J.setDirectionLineColor=function(f){var n=this.$35l;this.$35l=f,this.fp("directionLineColor",n,f)},J.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},J.setSegmentHoverColor=function(g){var k=this.$36l;this.$36l=g,this.fp("segmentHoverColor",k,g)},J.getSegmentHoverWidth=function(){return this.$22l||(O?16:8)},J.setSegmentHoverWidth=function(h){var w=this.$22l;this.$22l=h,this.fp("segmentHoverWidth",w,h)},J.getSnapPointBorderColor=function(){return this.$38l||"#f00"},J.setSnapPointBorderColor=function(A){var C=this.$38l;this.$38l=A,this.fp("snapPointBorderColor",C,A)},J.getEditRectPadding=function(){return this.$39l!=s?this.$39l:6},J.setEditRectPadding=function(A){var C=this.$39l;this.$39l=A,this.fp("editRectPading",C,A)},J.isRectEditable=function(V){var _=this,h=_._editInteractor;return h instanceof U.XEditInteractor?_._rectEditableFunc?_._rectEditableFunc(V):!0:ls.call(_,V)},J.isPointEditable=function(P){var p=this,g=p._editInteractor;return g instanceof U.XEditInteractor?p._pointEditableFunc?p._pointEditableFunc(P):!0:uj.call(p,P)},J.validateImpl=function(){var C=this,l=C.$14l,t=C._editInteractor;if(l){var _=C.getWidth(),e=C.getHeight();(_!==l.clientWidth||e!==l.clientHeight)&&(t&&(t._68I=1),x.setCanvas(l,_,e),C._32I=1)}lf.call(this)},J.isEditable=function(y){var R=rb.call(this,y),E=this._editInteractor;if(E instanceof U.XEditInteractor&&y instanceof r){if(!y.s("2d.editable"))return!1;var T=this.getEditableFunc();R=T?T(y):!0}return R},J._42=function(Z,A){var z=this,b=z._editInteractor;wq.call(z,Z,A),b instanceof U.XEditInteractor&&b._68I&&b._42()},J.isSnapPoint=function(){return!0};var db=function(r){arguments.length>0&&this.$58l(r)},ts=db.prototype;ts.$58l=function(g){this.$62l=g,this.points=new Array},ts.$56l=function(_){this.points.push(_)},ts.$57l=function(Y){this.points=this.points.concat(Y)};var Dl=function(y,$){arguments.length>0&&this.$58l(y,$)},Am=Dl.prototype;Am.$58l=function(y,n){this.x=y,this.y=n},Am.add=function(Z){return new Dl(this.x+Z.x,this.y+Z.y)},Am.addEquals=function(u){return this.x+=u.x,this.y+=u.y,this},Am.$55l=function($){return new Dl(this.x*$,this.y*$)},Am.eq=function(B){return this.x==B.x&&this.y==B.y},Am.lt=function(L){return this.x<L.x&&this.y<L.y},Am.lte=function(t){return this.x<=t.x&&this.y<=t.y},Am.gt=function(y){return this.x>y.x&&this.y>y.y},Am.gte=function(W){return this.x>=W.x&&this.y>=W.y},Am.lerp=function(F,j){return new Dl(this.x+(F.x-this.x)*j,this.y+(F.y-this.y)*j)},Am.distanceFrom=function(d){var C=this.x-d.x,E=this.y-d.y;return R(C*C+E*E)},Am.min=function(p){return new Dl(S(this.x,p.x),S(this.y,p.y))},Am.max=function(U){return new Dl(d(this.x,U.x),d(this.y,U.y))},Am.toString=function(){return this.x+","+this.y};var Uk=function(){this.$58l(arguments)},Wi=Uk.prototype;Uk.TO=1e-6,Uk.AC=6,Wi.$58l=function(V){this.co=new Array;for(var b=V.length-1;b>=0;b--)this.co.push(V[b])},Wi.$55l=function(h){for(var y=new Uk,v=0;v<=this.$50l()+h.$50l();v++)y.co.push(0);for(var v=0;v<=this.$50l();v++)for(var r=0;r<=h.$50l();r++)y.co[v+r]+=this.co[v]*h.co[r];return y},Wi.$59l=function(){for(var x=this.$50l();x>=0&&Z(this.co[x])<=Uk.TO;x--)this.co.pop()},Wi.$50l=function(){return this.co.length-1},Wi.$51l=function(){var t;switch(this.$59l(),this.$50l()){case 0:t=new Array;break;case 1:t=this.$52l();break;case 2:t=this.$53l();break;case 3:t=this.$54l();break;case 4:t=this.$63l();break;default:t=new Array}return t},Wi.$52l=function(){var S=new Array,Q=this.co[1];return 0!=Q&&S.push(-this.co[0]/Q),S},Wi.$53l=function(){var g=new Array;if(2==this.$50l()){var P=this.co[2],M=this.co[1]/P,F=this.co[0]/P,W=M*M-4*F;if(W>0){var B=R(W);g.push(.5*(-M+B)),g.push(.5*(-M-B))}else 0==W&&g.push(.5*-M)}return g},Wi.$63l=function(){var y=new Array;if(4==this.$50l()){var D=this.co[4],H=this.co[3]/D,r=this.co[2]/D,C=this.co[1]/D,o=this.co[0]/D,X=new Uk(1,-r,H*C-4*o,-H*H*o+4*r*o-C*C).$54l(),i=X[0],n=H*H/4-r+i;if(Z(n)<=Uk.TO&&(n=0),n>0){var c=R(n),p=3*H*H/4-c*c-2*r,$=(4*H*r-8*C-H*H*H)/(4*c),I=p+$,S=p-$;if(Z(I)<=Uk.TO&&(I=0),Z(S)<=Uk.TO&&(S=0),I>=0){var v=R(I);y.push(-H/4+(c+v)/2),y.push(-H/4+(c-v)/2)}if(S>=0){var v=R(S);y.push(-H/4+(v-c)/2),y.push(-H/4-(v+c)/2)}}else if(0>n);else{var $=i*i-4*o;if($>=-Uk.TO){if(0>$&&($=0),$=2*R($),p=3*H*H/4-2*r,p+$>=Uk.TO){var L=R(p+$);y.push(-H/4+L/2),y.push(-H/4-L/2)}if(p-$>=Uk.TO){var L=R(p-$);y.push(-H/4+L/2),y.push(-H/4-L/2)}}}}return y},Wi.$54l=function(){var t=new Array;if(3==this.$50l()){var D=this.co[3],f=this.co[2]/D,n=this.co[1]/D,P=this.co[0]/D,x=(3*n-f*f)/3,S=(2*f*f*f-9*n*f+27*P)/27,r=f/3,O=S*S/4+x*x*x/27,$=S/2;if(Z(O)<=Uk.TO&&(O=0),O>0){var p,G,T=R(O);p=-$+T,G=p>=0?k(p,1/3):-k(-p,1/3),p=-$-T,p>=0?G+=k(p,1/3):G-=k(-p,1/3),t.push(G-r)}else if(0>O){var M=R(-x/3),A=C(R(-O),-$)/3,b=q(A),L=m(A),g=R(3);t.push(2*M*b-r),t.push(-M*(b+g*L)-r),t.push(-M*(b-g*L)-r)}else{var p;p=$>=0?-k($,1/3):k(-$,1/3),t.push(2*p-r),t.push(-p-r)}}return t};var Oe=function(b,M){arguments.length>0&&this.$58l(b,M)},pf=Oe.prototype;pf.$58l=function(L,K){this.x=L,this.y=K},pf.length=function(){return R(this.x*this.x+this.y*this.y)},pf.$60l=function(R){return this.x*R.x+this.y*R.y};var wd=function(y,l,X,a){var q,h=(a.x-X.x)*(y.y-X.y)-(a.y-X.y)*(y.x-X.x),R=(l.x-y.x)*(y.y-X.y)-(l.y-y.y)*(y.x-X.x),Q=(a.y-X.y)*(l.x-y.x)-(a.x-X.x)*(l.y-y.y);if(0!=Q){var J=h/Q,W=R/Q;J>=0&&1>=J&&W>=0&&1>=W?(q=new db(p),q.points.push(new Dl(y.x+J*(l.x-y.x),y.y+J*(l.y-y.y)))):q=new db(z)}else q=0==h||0==R?new db("C"):new db("P");return q},Ah=function(v,N,y,j,b){var L,K,f,l,x,F,P,T=j.min(b),J=j.max(b),d=new db(z);L=N.$55l(-2),f=v.add(L.add(y)),L=v.$55l(-2),K=N.$55l(2),l=L.add(K),x=new Dl(v.x,v.y),P=new Oe(j.y-b.y,b.x-j.x),F=j.x*b.y-b.x*j.y;for(var o=new Uk(P.$60l(f),P.$60l(l),P.$60l(x)+F).$51l(),B=0;B<o.length;B++){var M=o[B];if(M>=0&&1>=M){var Y=v.lerp(N,M),G=N.lerp(y,M),X=Y.lerp(G,M);j.x==b.x?T.y<=X.y&&X.y<=J.y&&(d.$62l=p,d.$56l(X)):j.y==b.y?T.x<=X.x&&X.x<=J.x&&(d.$62l=p,d.$56l(X)):X.gte(T)&&X.lte(J)&&(d.$62l=p,d.$56l(X))}}return d},Pp=function(L,B,X,Y,h){var m=Y.min(h),c=Y.max(h),T=new Dl(c.x,m.y),C=new Dl(m.x,c.y),b=Ah(L,B,X,m,T),F=Ah(L,B,X,T,c),j=Ah(L,B,X,c,C),J=Ah(L,B,X,C,m),G=new db(z);return G.$57l(b.points),G.$57l(F.points),G.$57l(j.points),G.$57l(J.points),G.points.length>0&&(G.$62l=p),G},gg=function(c,R,l,D,q,V){var U,h,S,w,r,y,F,H,j,s,Z=q.min(V),e=q.max(V),Y=new db(z);U=c.$55l(-1),h=R.$55l(3),S=l.$55l(-3),w=U.add(h.add(S.add(D))),r=new Oe(w.x,w.y),U=c.$55l(3),h=R.$55l(-6),S=l.$55l(3),w=U.add(h.add(S)),y=new Oe(w.x,w.y),U=c.$55l(-3),h=R.$55l(3),S=U.add(h),F=new Oe(S.x,S.y),H=new Oe(c.x,c.y),s=new Oe(q.y-V.y,V.x-q.x),j=q.x*V.y-V.x*q.y;for(var t=new Uk(s.$60l(r),s.$60l(y),s.$60l(F),s.$60l(H)+j).$51l(),g=0;g<t.length;g++){var i=t[g];if(i>=0&&1>=i){var m=c.lerp(R,i),M=R.lerp(l,i),C=l.lerp(D,i),o=m.lerp(M,i),u=M.lerp(C,i),B=o.lerp(u,i);q.x==V.x?Z.y<=B.y&&B.y<=e.y&&(Y.$62l=p,Y.$56l(B)):q.y==V.y?Z.x<=B.x&&B.x<=e.x&&(Y.$62l=p,Y.$56l(B)):B.gte(Z)&&B.lte(e)&&(Y.$62l=p,Y.$56l(B))}}return Y},Ar=function(S,l,I,Y,w,B){var A=w.min(B),g=w.max(B),u=new Dl(g.x,A.y),G=new Dl(A.x,g.y),v=gg(S,l,I,Y,A,u),V=gg(S,l,I,Y,u,g),e=gg(S,l,I,Y,g,G),j=gg(S,l,I,Y,G,A),H=new db(z);return H.$57l(v.points),H.$57l(V.points),H.$57l(e.points),H.$57l(j.points),H.points.length>0&&(H.$62l=p),H},io=function(H,Z,t,o){var R=t.min(o),N=t.max(o),k=new Dl(N.x,R.y),M=new Dl(R.x,N.y),u=wd(R,k,H,Z),X=wd(k,N,H,Z),i=wd(N,M,H,Z),T=wd(M,R,H,Z),m=new db(z);return m.$57l(u.points),m.$57l(X.points),m.$57l(i.points),m.$57l(T.points),m.points.length>0&&(m.$62l=p),m},Hg=U.XEditInteractor=function(q){var f=this,o=f._view=document.createElement("canvas");o.className="editCanvas",o.style.position="absolute",Hg.superClass.constructor.call(f,q)};G.def(Hg,U.Interactor,{ms_edit:1,setUp:function(){var E=this,M=E.gv,$=M.getView(),F=E._view;Hg.superClass.setUp.call(E),M.setEditInteractor(E),M.$14l=F,M._79O?$.insertBefore(F,M._79O):$.appendChild(F);var I=E.$49l=E.$11l.bind(E);M.dm().md(I),M.sm().ms(I),M.mp(I)},tearDown:function(){var v=this,H=v.gv,l=H.getView(),O=v.$49l;Hg.superClass.tearDown.call(v),H.setEditInteractor(s),H.$14l=s,l.removeChild(v._view),H.dm().umd(O),H.sm().ums(O),H.ump(O)},clear:function(){var f=this,N=f.gv;delete f._hoverSegmentIndex,delete f._edge,delete f._shape,delete N._editing,delete f.$10l,delete f.$13l,delete f.$9l,delete f._removePointIndex,delete f._lp,f.$12l="",delete f.$40l,delete f.$67l,delete f.$72l,delete f.$73l,delete f.$75l,delete f.$1l,delete f.$3l,delete f.$2l,delete f.$92l,delete f.$93l,delete f.$94l,f.clearDragging()},handle_keydown:function(V){this.$48l!==V.shiftKey&&(this.$48l=V.shiftKey,this.handle_mousemove(V,L,!0))},handle_keyup:function(B){this.$48l!==B.shiftKey&&(this.$48l=B.shiftKey,this.handle_mousemove(B,L,!0))},handle_touchstart:function(N){this.handle_mousemove(N),this.handle_mousedown(N)},handle_mousedown:function(N){V(N);var _=this,w=_.$13l,M=_.gv,n=M.dm(),j=M.sm(),b=M.getZoom(),S=M.lp(N),p=G.isDoubleClick(N),e=G.isLeftButton(N),d=_.$7l,O=_._shape,R=_._hoverSegmentIndex,Y=_._edge,E=_.$87l,h=_.$88l,Q=function(){_._68I||E===_.$87l&&h===_.$88l||_.$43l()};if(7!==_.$67l&&(delete _.$87l,delete _.$88l),e&&(O||Y)&&R>=0&&p&&(O&&j.contains(O)||Y&&j.contains(Y))){var F=Lp.call(_,O||Y,R,S);return _.addShapePoint(O||Y,R,F),g(function(){_.handle_mousemove(N)},40),void 0}if(e&&(O||Y)&&_._removePointIndex>=0&&p)return _.removeShapePoint(),_.$5l=1,g(function(){_.handle_mousemove(N)},40),void 0;if(!e||!M._editing)return Q(),void 0;if(O&&w>=0){var J=O.getPoints().get(w),y=O.p(),f=nh(y,J.x-y.x,J.y-y.y,-d+O.getRotation());c=nh(y,S.x-y.x,S.y-y.y,-d),_.$24l={x:c.x-f.x,y:c.y-f.y},_.startDragging(N),n.beginTransaction(),_.fi({kind:"beginEditPoint",event:N,data:O,index:w}),_.$88l=w,_.$87l=O}else if(_.$10l){var D=M.sm().getSelection(),$=_.$6l,v=_.$1l={},T=_.$3l={},A=_.$16l[I[_.$10l]],i={x:$.x,y:$.y},x={x:$.x+$.width/2,y:$.y+$.height/2};_.$24l={x:S.x-A.x/b,y:S.y-A.y/b},_.$2l=W(_.$8l),_.$4l=W($),D.each(function(A){if(A instanceof l){var X=A.p(),w=A.getWidth(),m=A.getHeight(),s=nh(x,X.x-x.x,X.y-x.y,-d);v[A.getId()]={x:X.x-w/2,y:X.y-m/2,width:w,height:m},T[A.getId()]={x:(s.x-i.x)/$.width,y:(s.y-i.y)/$.height}}}),_.startDragging(N),n.beginTransaction(),_.fi({kind:"beginEditRect",event:N,direction:_.$10l})}else if(Y&&w>=0){var K=hs(M.getDataUI(Y),Y.s("edge.points")),J=K.get(w);_.$24l={x:S.x-J.x,y:S.y-J.y},_.startDragging(N),n.beginTransaction(),_.fi({kind:"beginEditPoint",event:N,data:Y,index:w}),_.$88l=w,_.$87l=Y}else if(_.$40l){var $=_.$6l,x={x:$.x+$.width/2,y:$.y+$.height/2},C=W(_.$23l);C.x/=b,C.y/=b;var o=nh(x,C.x-x.x,C.y-x.y,-d),c=nh(x,S.x-x.x,S.y-x.y,-d);_.$24l={x:c.x-o.x,y:c.y-o.y},_.startDragging(N),n.beginTransaction(),_.fi({kind:"beginEditRotation",event:N,data:_._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(_.$67l)>=0){var B=_.$67l;(7===B||8===B||9===B)&&n.beginTransaction(),_.startDragging(N)}else if(_.$71l&&p&&_.$79l(_.$71l,S)){var t=j.toSelection();n.beginTransaction(),t.each(function(T){n.remove(T)}),n.endTransaction()}Q()},$11l:function(){var D=this,i=D.gv;i._editing&&(D.$13l==s||D._shape==s&&D._edge==s)&&(D.$73l==s||1!==D.$67l&&5!==D.$67l&&6!==D.$67l)||(D.$5l=1),D._68I=1},$46l:function(j){var A=this,V=A.gv,t=V.lp(j),M=[];return jq(V,function(T){var G=V.getDataUI(T);if(G){var Y=G._79o();P(Y,t)&&M.push(T)}}),M},$47l:function(F){var O=this,N=O.$13l,w=O.gv.dm();O.$10l?(O.fi({kind:"endEditRect",event:F,direction:O.$10l}),w.endTransaction()):O._shape&&N>=0?(O.fi({kind:"endEditPoint",event:F,data:O._shape,index:N}),w.endTransaction()):O._edge&&N>=0?(O.fi({kind:"endEditPoint",event:F,data:O._edge,index:N}),w.endTransaction()):O.$23l&&O.$40l&&(O.fi({kind:"endEditRotation",event:F}),w.endTransaction())},handleWindowTouchEnd:function(q){this.handleWindowMouseUp(q)},handleWindowMouseUp:function(d){var X=this,o=X.gv,$=o.dm(),Z=X._shape,Q=X._edge,S=X.$13l,w=X.$40l,W=X.$9l,A=X.$10l,z=X.$67l;if((Z||Q)&&S>=0&&W>=0){var t,x;if(Z){var F=Z.p(),b=Z.getRotation();t=Z.getPoints(),x=t.get(W),td(Z,F,b,S,x,!1)}else if(t=hs(o.getDataUI(Q),Q.s("edge.points"),!0),x=t.get(W),0===S){var J=t.get(0);Q.s("edge.source.offset.x",x.x-J.x),Q.s("edge.source.offset.y",x.y-J.y)}else if(S===t.size()-1){var _=t.get(t.size()-1);Q.s("edge.target.offset.x",x.x-_.x),Q.s("edge.target.offset.y",x.y-_.y)}else"points"===Q.s("edge.type")&&(t.set(S,x),Q.s("edge.points",Wh(t)))}X.$47l(d);var U=X.$73l;1===z?($.beginTransaction(),U?o.sm().each(function(P){if(P.setHost&&o.isHelperEditable(P,"host")){P.setHost(U);
var T=X.$75l,q=X.$74l;T&&(P.s("attach.row.index",T.rowIndex),P.s("attach.column.index",T.columnIndex)),q&&(P.s("attach.index",q.attachIndex),P.s("attach.offset",q.attachOffset),P.s("attach.offset.relative",!1),P.s("attach.offset.opposite",!1))}}):o.sm().each(function(H){H.setHost&&o.isHelperEditable(H,"host")&&(H.setHost(s),H.s("attach.row.index",L),H.s("attach.column.index",L),H.s("attach.index",L),H.s("attach.offset",L),H.s("attach.offset.relative",!1),H.s("attach.offset.opposite",!1))}),$.endTransaction()):2===z?($.beginTransaction(),U?o.sm().each(function(E){E.setParent&&o.isHelperEditable(E,"parent")&&E.setParent(U)}):o.sm().each(function(f){f.setParent&&o.isHelperEditable(f,"parent")&&f.setParent(s)}),$.endTransaction()):3===z?U&&($.beginTransaction(),o.sm().each(function(u){if(o.isHelperEditable(u,"edge")&&u instanceof l&&U instanceof l){var Z=new n.Edge;$.add(Z),Z.setSource(u),Z.setTarget(U),X.onEdgeCreated&&X.onEdgeCreated(d,Z)}}),$.endTransaction()):5===z||6===z?U&&($.beginTransaction(),o.sm().each(function(f){f instanceof r&&U instanceof l&&(5===z&&o.isHelperEditable(f,"source")?f.setSource(U):6===z&&o.isHelperEditable(f,"source")&&f.setTarget(U))}),$.endTransaction()):(7===z||8===z||9===z)&&$.endTransaction(),(A||w)&&X.$43l(!0),O?(X.clear(),delete X.$64l,X._68I||X.$43l()):(X.handle_mousemove(d,!0),z&&!X._68I&&X.$43l())},handleWindowTouchMove:function(r){this.handleWindowMouseMove(r)},handleWindowMouseMove:function(x){this._78I(x)},handle_mousemove:function(A,X,N){if(!this._pause){if(!N){var T=O?Rq(A):A;this.$61l={clientX:T.clientX,clientY:T.clientY}}if(X===!0||!E()){var Y=this,W=Y.gv,U=!1,j=s;Y.clear(),W.sm().size()>0&&(j=W.lp(N?Y.$61l:A),U=Y._79I(A,j)),U&&(W._editing=1),Y.$12l!==Y.$65l&&(Y.$65l=Y.$12l,Y.setCursor(Y.$12l)),Y.$40l!==Y.$64l&&(Y.$64l=Y.$40l,Y._68I||Y.$43l()),Y._hoverSegmentIndex!==Y.$66l&&(Y.$66l=Y._hoverSegmentIndex,Y._68I||Y.$43l())}}},_78I:function(Q){this.autoScroll(Q);var u=this,e=u.gv,i=e.lp(Q),h=e.getZoom(),m=u.$13l;if((u._shape||u._edge)&&m>=0){var y,c,z,q=u._shape,I=u._edge,L=u.$24l,D=e.getPointSnapSpacing(),P=function(I,q){return D==s||isNaN(D)?{x:I,y:q}:{x:T(I/D)*D,y:T(q/D)*D}};if(q){y=q.getPoints();var k=q.p(),J=q.getRotation(),V=0;c=nh(k,i.x-k.x,i.y-k.y,-J),td(q,k,J,m,i,!0,L,P),u.fi({kind:"betweenEditPoint",event:Q,data:q,index:m})}else if(I){y=hs(e.getDataUI(I),I.s("edge.points"),!0),i.x-=L.x,i.y-=L.y,c=i;var j,O,U=I.s("edge.offset"),p=y.size(),N=p>2;if(0===m){var B=y.get(0);U&&(B=he(B,y.get(1),-U,N),i=he(i,y.get(1),-U,N)),j=i.x-B.x,O=i.y-B.y,z=P(j,O),I.s("edge.source.offset.x",z.x),I.s("edge.source.offset.y",z.y)}else if(m===p-1){var A=y.get(p-1);U&&(A=he(A,y.get(p-2),-U,N),i=he(i,y.get(p-2),-U,N)),j=i.x-A.x,O=i.y-A.y,z=P(j,O),I.s("edge.target.offset.x",z.x),I.s("edge.target.offset.y",z.y)}else"points"===I.s("edge.type")&&(z=P(i.x,i.y),z.e=y.get(m).e,y.set(m,z),I.s("edge.points",Wh(y)));u.fi({kind:"betweenEditPoint",event:Q,data:I,index:m})}if(delete u.$9l,e.isSnapPoint(q)||e.isSnapPoint(I))for(V=0;V<y.size();V++)if(V!==m){var x=y.get(V);if(X(x,c)<e.getEditPointSize()/h){u.$9l=V;break}}}else if(u.$10l){var L=u.$24l;i.x-=L.x,i.y-=L.y;var v=e.sm().getSelection(),n=u.$1l,d=u.$7l,a=u.$10l,f=u.$4l,o=u.$2l,W=e.getEditRectPadding()/h,_=2*W,S=e.getSnapSpacing(),H=S!=s&&!isNaN(S),E=sg(o,i,a,d,2*W,e.getResizeMode(),H,!0),F=u.$6l;if(H){var t=E.width-_,$=E.height-_,b=T(t/S)*S,Mk=T($/S)*S,Dg=b-t,Zc=Mk-$;("west"===a||"northwest"===a||"southwest"===a)&&(Dg=-Dg),("north"===a||"northwest"===a||"northeast"===a)&&(Zc=-Zc),E=sg(o,i,a,d,2*W,e.getResizeMode(),H,!1,Dg,Zc)}u.$8l=E,F.x=E.x+W,F.y=E.y+W,F.width=E.width-_,F.height=E.height-_;var xg=E.x+E.width/2,al=E.y+E.height/2,bq=F.x,dn=F.y,vh=F.width/f.width,nj=F.height/f.height;v.each(function(K){if(K instanceof l&&e.isEditable(K)&&e.isRectEditable(K)){var U=n[K.getId()],i=u.$3l[K.getId()],C={x:U.x+U.width/2,y:U.y+U.height/2},y=0,j=0,b=a,E=180*Z(d-K.getRotation())/M;"northeast"===a?E>=315||45>E?(y=U.width*vh+U.x,j=U.height*(1-nj)+U.y,b="northeast"):E>=45&&135>E?(y=U.width*(1-nj)+U.x,j=U.height*(1-vh)+U.y,b="northwest"):E>=135&&225>E?(y=U.width*(1-vh)+U.x,j=U.height*nj+U.y,b="southwest"):(y=U.width*nj+U.x,j=U.height*vh+U.y,b="southeast"):"north"===a?E>=315||45>E?(j=U.height*(1-nj)+U.y,b="north"):E>=45&&135>E?(y=U.width*(1-nj)+U.x,b="west"):E>=135&&225>E?(j=U.height*nj+U.y,b="south"):(y=U.width*nj+U.x,b="east"):"northwest"===a?E>=315||45>E?(y=U.width*(1-vh)+U.x,j=U.height*(1-nj)+U.y,b="northwest"):E>=45&&135>E?(y=U.width*(1-nj)+U.x,j=U.height*vh+U.y,b="southwest"):E>=135&&225>E?(y=U.width*vh+U.x,j=U.height*nj+U.y,b="southeast"):(y=U.width*nj+U.x,j=U.height*(1-vh)+U.y,b="northeast"):"west"===a?E>=315||45>E?(y=U.width*(1-vh)+U.x,b="west"):E>=45&&135>E?(j=U.height*vh+U.y,b="south"):E>=135&&225>E?(y=U.width*vh+U.x,b="east"):(j=U.height*(1-vh)+U.y,b="north"):"southwest"===a?E>=315||45>E?(y=U.width*(1-vh)+U.x,j=U.height*nj+U.y,b="southwest"):E>=45&&135>E?(y=U.width*nj+U.x,j=U.height*vh+U.y,b="southeast"):E>=135&&225>E?(y=U.width*vh+U.x,j=U.height*(1-nj)+U.y,b="northeast"):(y=U.width*(1-nj)+U.x,j=U.height*(1-vh)+U.y,b="northwest"):"east"===a?E>=315||45>E?(y=U.width*vh+U.x,b="east"):E>=45&&135>E?(j=U.height*(1-vh)+U.y,b="north"):E>=135&&225>E?(y=U.width*(1-vh)+U.x,b="west"):(j=U.height*vh+U.y,b="south"):"south"===a?E>=315||45>E?(j=U.height*nj+U.y,b="south"):E>=45&&135>E?(y=U.width*nj+U.x,b="east"):E>=135&&225>E?(j=U.height*(1-nj)+U.y,b="north"):(y=U.width*(1-nj)+U.x,b="west"):"southeast"===a&&(E>=315||45>E?(y=U.width*vh+U.x,j=U.height*nj+U.y,b="southeast"):E>=45&&135>E?(y=U.width*nj+U.x,j=U.height*(1-vh)+U.y,b="northeast"):E>=135&&225>E?(y=U.width*(1-vh)+U.x,j=U.height*(1-nj)+U.y,b="northwest"):(y=U.width*(1-nj)+U.x,j=U.height*vh+U.y,b="southwest"));var J=nh(C,y-C.x,j-C.y,K.getRotation());Uq(K,U,b,{x:J.x,y:J.y});var c=bq+F.width*i.x,k=dn+F.height*i.y,z={x:c,y:k};z=nh({x:xg,y:al},z.x-xg,z.y-al,d),K.p(z.x,z.y)}}),u.fi({kind:"betweenEditRect",event:Q,direction:a})}else if(u.$23l&&u.$40l){var fg=u.$8l,Oc=fg.width,Vb=fg.height,k={x:fg.x+Oc/2,y:fg.y+Vb/2},L=u.$24l,dk=u.$23l,Qp=dk.x/h-k.x,Bs=dk.y/h-k.y,th=R(Qp*Qp+Bs*Bs),uo=Math.asin(L.x/th),ei=e.sm().getSelection(),Sl=w+C(i.y-k.y,i.x-k.x)-uo,Fm=e.getSnapAngle(),Sl=T(Sl/Fm)*Fm;0>Sl&&(Sl+=Y);var zp=Sl-u.$7l,zb=[k.x,0,k.y];ei.each(function(l){if(e.isEditable(l)&&e.isRotationEditable(l)&&e.isVisible(l)){var n=gk(l.p3(),zb),q=Kf();hn(q,-zp),l.setRotation(l.getRotation()+zp),jh(n,q),l.p3(zb[0]+n[0],zb[1]+n[1],zb[2]+n[2])}}),u.$7l=Sl,u.fi({kind:"betweenEditRotation",event:Q})}else if([1,2,3,5,6].indexOf(u.$67l)>=0)u.$72l=Q,u.$78l||(u.$78l=1,g(function(){G.isDragging()&&u.$43l(),delete u.$78l},12));else if(7===u.$67l){if(u.$87l instanceof K){var q=u.$87l,Vk=u.$88l,_o=G.clone(q.getPoints().get(Vk)),ao=i.y-_o.y;_o.e||(_o.e=0),u.$92l||(u.$92l=_o.e),_o.e=u.$92l-ao,q.setPoint(Vk,_o)}else if(u.$87l instanceof r){var I=u.$87l,Vk=u.$88l,y=hs(e.getDataUI(I),I.s("edge.points")),_o=y.get(Vk),ao=i.y-_o.y;_o.e||(_o.e=0),u.$92l||(u.$92l=_o.e),_o.e=u.$92l-ao,y.set(Vk,_o),I.s("edge.points",Wh(y))}}else if(8===u.$67l){var ei=e.sm().getSelection(),ec=u.$93l;ec||(ec=u.$93l={}),ei.each(function(p){if(p.p3){var v=p.p3(),G=ec[p.getId()];G==s&&(G=ec[p.getId()]=v[1]),p.p3([v[0],G-(i.y-u.$90l.y/h),v[2]])}})}else if(9===u.$67l){var ei=e.sm().getSelection(),Qj=u.$94l;Qj||(Qj=u.$94l={}),ei.each(function(H){if(H.s3){var w=H.s3(),S=Qj[H.getId()];S==s&&(S=Qj[H.getId()]=w[1]);var O=S-(i.y-u.$91l.y/h);0>O&&(O=.01),H.s3([w[0],O,w[2]])}})}},$79l:function(s,$){var _=this,S=_.gv,h=S.getZoom(),H=S.getEditHelperSize(),D=s.x/h,N=s.y/h,K=H/h,x=K/2;return P({x:D-x,y:N-x,width:K,height:K},$)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(j,b){for(var d=this,C=d.gv,Y=C.getZoom(),f=C.getEditPointSize(),N=f/Y,v=N/2,c=d.$46l(j),k=0;k<c.length;k++){var S,g,A=c[k],$=C.getDataUI(A);if($&&$._55O){var X=$._55O;if(X._43O&&A instanceof r){if(S=A.s("edge.points"),S=hs($,S),g=A.s("edge.segments"),g&&g.size()||(g=Ag(S)),d.$42l(A,b,S._as,g,"edge"))return!0;if("points"===A.s("edge.type")&&d.$41l(A,b,S._as,g,"edge"))return}if(X._43O&&A instanceof K&&X.$15l&&X.$15l.length===A.getPoints().size()){if(S=X.$15l,g=A.getSegments(),g&&g.size()||(g=Ag(S)),d.$42l(A,b,S,g,"shape"))return!0;if(d.$41l(A,b,S,g,"shape"))return}}}if(d.$16l){var S,h=d.$16l,q=h[3].x-h[7].x,T=h[3].y-h[7].y,m=R(q*q+T*T),Z=h[1].x-h[5].x,u=h[1].y-h[5].y,l=R(Z*Z+u*u),G={x:b.x*Y,y:b.y*Y};if(d._80I(G,0,h[0],"northwest",m,l)||d._80I(G,1,h[1],"north",m,l)||d._80I(G,2,h[2],"northeast",m,l)||d._80I(G,7,h[7],"west",m,l)||d._80I(G,3,h[3],"east",m,l)||d._80I(G,6,h[6],"southwest",m,l)||d._80I(G,5,h[5],"south",m,l)||d._80I(G,4,h[4],"southeast",m,l))return!0}if(d.$23l){var J=d.$23l,I=J.x/Y,H=J.y/Y;if(P({x:I-v,y:H-v,width:N,height:N},b))return d.$40l=1,d.$12l=d.getHelperCursor("rotation")||"crosshair",!0}return d.$68l&&d.$79l(d.$68l,b)?(d.$67l=1,d.$12l=d.getHelperCursor("host")||"crosshair",!0):d.$69l&&d.$79l(d.$69l,b)?(d.$67l=2,d.$12l=d.getHelperCursor("parent")||"crosshair",!0):d.$70l&&d.$79l(d.$70l,b)?(d.$67l=3,d.$12l=d.getHelperCursor("edge")||"crosshair",!0):d.$71l&&d.$79l(d.$71l,b)?(d.$67l=4,d.$12l=d.getHelperCursor("remove")||"crosshair",!0):d.$82l&&d.$79l(d.$82l,b)?(d.$67l=5,d.$12l=d.getHelperCursor("source")||"crosshair",!0):d.$83l&&d.$79l(d.$83l,b)?(d.$67l=6,d.$12l=d.getHelperCursor("target")||"crosshair",!0):d._pointElevationHelperPoint&&d.$79l(d._pointElevationHelperPoint,b)?(d.$67l=7,d.$12l=d.getHelperCursor("pointElevation")||"crosshair",!0):d.$90l&&d.$79l(d.$90l,b)?(d.$67l=8,d.$12l=d.getHelperCursor("elevation")||"crosshair",!0):d.$91l&&d.$79l(d.$91l,b)?(d.$67l=9,d.$12l=d.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(F,S,R,T,r,X){var G=this,w=G.gv,p=w.getEditPointSize(),m=p/2,W=w.sm(),n=w.isDirectionEditable;if(n&&1===W.size()){var t=W.ld();if(n=n.bind(w),t instanceof l){if(!n(t,T))return!1;if("east"===T){if(n(t,"northeast")&&n(t,"southeast")&&2*p>=X)return!1}else if("west"===T){if(n(t,"northwest")&&n(t,"southwest")&&2*p>=X)return!1}else if("north"===T){if(n(t,"northwest")&&n(t,"northeast")&&2*p>=r)return!1}else if("south"===T&&n(t,"southwest")&&n(t,"southeast")&&2*p>=r)return!1}}else{if(2*p>=r&&("north"===T||"south"===T))return!1;if(2*p>=X&&("east"===T||"west"===T))return!1}if(P({x:R.x-m,y:R.y-m,width:p,height:p},F)){if(G.$10l!==T){var o=180*G.$7l/M,U="";o>=337.5||22.5>o?U="north":o>=22.5&&67.5>o?U="northeast":o>=67.5&&112.5>o?U="east":o>=112.5&&157.5>o?U="southeast":o>=157.5&&202.5>o?U="south":o>=202.5&&247.5>o?U="southwest":o>=247.5&&292.5>o?U="west":o>=292.5&&337.5>o&&(U="northwest");var v=Cd.indexOf(U),U=Cd[S-(1-v)+8];switch(U){case"northwest":G.$12l="nwse-resize";break;case"northeast":G.$12l="nesw-resize";break;case"southwest":G.$12l="nesw-resize";break;case"southeast":G.$12l="nwse-resize";break;case"north":G.$12l="ns-resize";break;case"east":G.$12l="ew-resize";break;case"south":G.$12l="ns-resize";break;case"west":G.$12l="ew-resize"}G.$10l=T}return!0}return!1},$42l:function(z,S,R,h,Z){var G,_=this,f=_.gv,D=f.getEditPointSize(),t=D/f.getZoom(),T=-1,W={x:S.x,y:S.y,width:0,height:0},F=function(S){"shape"===Z?_._shape=z:_._edge=z,_._removePointIndex=S},a=function(x){"shape"===Z?_._shape=z:_._edge=z,_.$13l=x,_.$12l="crosshair"};for(i(W,t/2),T=R.length-1,G=h.size()-1;G>=0;G--){var w=h.get(G);if(1===w||2===w)T-=1;else if(3===w){var J=R[T-1];if(P(W,J))return a(T-1),!0;T-=2}else if(4===w){var j=R[T-1],q=R[T-2];if(P(W,j))return a(T-1),!0;if(P(W,q))return a(T-2),!0;T-=3}}for(T=R.length-1,G=h.size()-1;G>=0;G--){var w=h.get(G),I=R[T];if(P(W,I))return F(T),a(T),!0;1===w||2===w?T-=1:3===w?T-=2:4===w&&(T-=3)}return!1},$41l:function(S,r,e,v,a){var l=this,A=l.gv,m=-1,T=0,u={x:r.x,y:r.y,width:0,height:0},g=function(o,X){l._hoverSegmentIndex=X,l._lp=r,"shape"===a?l._shape=S:l._edge=S};for(i(u,A.getSegmentHoverWidth()/2/A.getZoom()),S instanceof K&&S.isClosePath()&&v.indexOf(5)<0&&(v=new f(v._as),v.add(5));T<v.size();T++){var D=v.get(T);if(1===D){var x=e[m],s=e[m+1];if(x){var j=io(new Dl(x.x,x.y),new Dl(s.x,s.y),new Dl(u.x,u.y),new Dl(u.x+u.width,u.y+u.height));if(j.$62l===p&&j.points.length>0)return g(j,T),!0}m+=1}else if(2===D){var x=e[m],s=e[m+1],j=io(new Dl(x.x,x.y),new Dl(s.x,s.y),new Dl(u.x,u.y),new Dl(u.x+u.width,u.y+u.height));if(j.$62l===p&&j.points.length>0)return g(j,T),!0;m+=1}else if(3===D){var x=e[m],k=e[m+1],o=e[m+2],j=Pp(new Dl(x.x,x.y),new Dl(k.x,k.y),new Dl(o.x,o.y),new Dl(u.x,u.y),new Dl(u.x+u.width,u.y+u.height));if(j.$62l===p)return g(j,T),!0;m+=2}else if(4===D){var x=e[m],Y=e[m+1],P=e[m+2],o=e[m+3],j=Ar(new Dl(x.x,x.y),new Dl(Y.x,Y.y),new Dl(P.x,P.y),new Dl(o.x,o.y),new Dl(u.x,u.y),new Dl(u.x+u.width,u.y+u.height));if(j.$62l===p)return g(j,T),!0;m+=3}else if(5===D){var x=e[m],s=e[0];if(x){var j=io(new Dl(x.x,x.y),new Dl(s.x,s.y),new Dl(u.x,u.y),new Dl(u.x+u.width,u.y+u.height));if(j.$62l===p&&j.points.length>0)return g(j,T),!0}}}return!1},addShapePoint:function(Y,N,g){var R=this,i=R.gv,l=i.dm();if(l.beginTransaction(),0===arguments.length&&(Y=R._shape||R._edge,N=R._hoverSegmentIndex,g=R._lp),Y instanceof K||Y instanceof r){var H=Oo(Y,i.getDataUI(Y),N);if(!isNaN(N)&&g&&!isNaN(H)){var W=g;if(Y instanceof K){var n=Y.p(),D=Y.getRotation(),O=Y.toSegments();O&&O.size()||(O=Ag(Y.getPoints())),Y.isClosePath()&&O.indexOf(5)<0&&(O=new f(O._as),O.add(5));var b=O.get(N),B="addPoint",X="removePointAt";if(2===b||1===b){var G={x:W.x,y:W.y};O.add(b,N),G=nh(n,G.x-n.x,G.y-n.y,-D),Y[B](G,H+1)}else if(3===b){var j=Y.getPoints(),x=j.get(H),A=j.get(H+2),G={x:W.x,y:W.y};G=nh(n,G.x-n.x,G.y-n.y,-D);var k=sj(x,G),C=sj(G,A);O.removeAt(N),O.add(3,N),O.add(3,N),Y.setPoint(H+1,G),Y[B](C,H+2),Y[B](k,H+1)}else if(4===b){var j=Y.getPoints(),x=j.get(H),A=j.get(H+3),G={x:W.x,y:W.y};G=nh(n,G.x-n.x,G.y-n.y,-D);var k=Pf(x,G),C=al(x,G),u=Pf(G,A),h=al(G,A);O.removeAt(N),O.add(4,N),O.add(4,N),Y[X](H+1),Y[X](H+1),Y[B](G,H+1),Y[B](h,H+2),Y[B](u,H+2),Y[B](C,H+1),Y[B](k,H+1)}else if(5===b){var G={x:W.x,y:W.y};O.add(2,N),G=nh(n,G.x-n.x,G.y-n.y,-D),Y[B](G,H+1)}Y.isClosePath()&&O.remove(5),Y.setSegments(O);var $=Y.getWidth(),w=Y.getHeight(),Z=Y.p().x-$/2,v=Y.p().y-w/2;Z-=n.x,v-=n.y;var Q=fn(Y,{x:Z,y:v,width:$,height:w},D,n);Y.p(Q.x,Q.y)}else if(Y instanceof r){if("points"!==Y.s("edge.type"))return l.endTransaction(),void 0;var j=Y.s("edge.points");O=Y.s("edge.segments"),j=hs(i.getDataUI(Y),j),O&&O.size()||(O=Ag(j)),O=new f(O._as.slice(0)),j=new f(j._as.slice(0));var b=O.get(N);if(2===b||1===b){var G={x:W.x,y:W.y};O.add(b,N),j.add(G,H+1)}else if(3===b){var x=j.get(H),A=j.get(H+2),G={x:W.x,y:W.y},k=sj(x,G),C=sj(G,A);O.removeAt(N),O.add(3,N),O.add(3,N),j.set(H+1,G),j.add(C,H+2),j.add(k,H+1)}else if(4===b){var x=j.get(H),A=j.get(H+3),G={x:W.x,y:W.y},k=Pf(x,G),C=al(x,G),u=Pf(G,A),h=al(G,A);O.removeAt(N),O.add(4,N),O.add(4,N),j.removeAt(H+1),j.removeAt(H+1),j.add(G,H+1),j.add(h,H+2),j.add(u,H+2),j.add(C,H+1),j.add(k,H+1)}Y.s("edge.points",Wh(j)),Y.s("edge.segments",O)}}}l.endTransaction()},removeShapePoint:function(B,u){var d=this,l="removeAt",S=d.gv,e=S.dm();if(e.beginTransaction(),0===arguments.length&&(B=d._shape||d._edge,u=d._removePointIndex),u>=0&&(B instanceof K||B instanceof r)){var c=vg(B,d.gv.getDataUI(B),u),w=u;if(B instanceof K){var W=B.p(),n=B.toSegments();n&&n.size()||(n=Ag(B.getPoints()));var h=n.get(c),j="removePointAt";if(1===h&&0===w)if(B.getPoints().size()>1){var t=n.get(c+1);n[l](c+1),3===t?B[j](w+1):4===t&&(B[j](w+2),B[j](w+1)),B[j](w)}else B.dm().remove(B);else 2===h||1===h?(n[l](c),B[j](w)):3===h?(n[l](c),B[j](w),B[j](w-1)):4===h&&(n[l](c),B[j](w),B[j](w-1),B[j](w-2));B.setSegments(n);var N=B.getWidth(),q=B.getHeight(),P=B.p().x-N/2,b=B.p().y-q/2;P-=W.x,b-=W.y;var G=fn(B,{x:P,y:b,width:N,height:q},B.getRotation(),W);B.p(G.x,G.y)}else if(B instanceof r){if("points"!==B.s("edge.type"))return e.endTransaction(),void 0;var A=B.s("edge.points");if(n=B.s("edge.segments"),A&&(A=hs(d.gv.getDataUI(B),A),n&&n.size()||(n=Ag(A))),0===u||u===A.size()-1)return e.endTransaction(),void 0;n=new f(n._as.slice(0)),A=new f(A._as.slice(0));var h=n.get(c);2===h||1===h?(n[l](c),A[l](w)):3===h?(n[l](c),A[l](w),A[l](w-1)):4===h&&(n[l](c),A[l](w),A[l](w-1),A[l](w-2)),B.s("edge.segments",n),B.s("edge.points",Wh(A))}}e.endTransaction()},changeShapeSegment:function(t,u,I){var d=this,z=d.gv,e=z.dm();if(e.beginTransaction(),1!==arguments.length||isNaN(t)||(I=t,t=d._shape||d._edge,u=d._hoverSegmentIndex),t instanceof K||t instanceof r){var p=Oo(t,d.gv.getDataUI(t),u);if(!isNaN(u)&&!isNaN(p))if(t instanceof K){var F=t.p(),P=t.toSegments();P&&P.size()||(P=Ag(t.getPoints()));var j=P.get(u),W=t.toPoints();if(1===I||2===I)1===j||2===j?P.set(u,I):3===j?(P.set(u,I),W.removeAt(p+1)):4===j&&(P.set(u,I),W.removeAt(p+1),W.removeAt(p+1));else if(3===I){var Z=function(){var I=W.get(p),s=W.get(p+1),$=sj(I,s);P.set(u,3),W.add($,p+1)};2===j||1===j?Z():4===j&&(W.removeAt(p+1),W.removeAt(p+1),Z())}else if(4===I){var g=function(){var g=W.get(p),q=W.get(p+1),B=Pf(g,q),V=al(g,q);P.set(u,4),W.add(B,p+1),W.add(V,p+2)};2===j||1===j?g():3===j&&(W.removeAt(p+1),g())}t.setSegments(P),t.setPoints(W);var E=t.getWidth(),A=t.getHeight(),J=t.p().x-E/2,a=t.p().y-A/2;J-=F.x,a-=F.y;var C=new fn(t,{x:J,y:a,width:E,height:A},t.getRotation(),F);t.p(C.x,C.y)}else if(t instanceof r){if("points"!==t.s("edge.type"))return e.endTransaction(),void 0;var W=t.s("edge.points");P=t.s("edge.segments"),W&&(W=hs(d.gv.getDataUI(t),W),P&&P.size()||(P=Ag(W))),P=new f(P._as.slice(0)),W=new f(W._as.slice(0));var j=P.get(u);if(1===I||2===I)1===j||2===j?P.set(u,I):3===j?(P.set(u,I),W.removeAt(p+1)):4===j&&(P.set(u,I),W.removeAt(p+1),W.removeAt(p+1));else if(3===I){var Z=function(){var L=W.get(p),U=W.get(p+1),E=sj(L,U);P.set(u,3),W.add(E,p+1)};2===j||1===j?Z():4===j&&(W.removeAt(p+1),W.removeAt(p+1),Z())}else if(4===I){var g=function(){var N=W.get(p),J=W.get(p+1),$=Pf(N,J),q=al(N,J);P.set(u,4),W.add($,p+1),W.add(q,p+2)};2===j||1===j?g():3===j&&(W.removeAt(p+1),g())}t.s("edge.points",Wh(W)),t.s("edge.segments",P)}}e.endTransaction()},getDefaultSegments:function(O){var n=this.gv,y=n.getDataUI(O);if(O instanceof r){var N=O.s("edge.points");return N=hs(y,N),Ag(N)}if(O instanceof K){var N=O.getPoints(),q=O.getSegments();return q&&q.size()>0?q:Ag(N)}},$43l:function(S){var j=this;S&&(j.$5l=1),j._68I=1,j._42()},_42:function(){var o=this;if(o._68I){delete o._68I;var X=o.gv,V=o.$5l,S=X.getZoom(),Z=X.getEditPointSize(),d=Z/2,E=new f,J=o._view,H=o._edge,B=o._shape,b=J.getContext("2d"),$=X.tx(),c=X.ty(),a=s,U=X.getEditPointBackground(),p=X.getControlPointBackground(),I=X.getControlPointBorderColor(),g=X.getEditPointBorderColor(),z=X.getEditRectBorderColor(),_=X.getDirectionLineColor(),C=X.getSegmentHoverColor(),F=X.getSnapPointBorderColor(),u=X.getJoinPointBackground(),w=X.getJoinPointBorderColor(),m=X.getSegmentHoverWidth(),M=[5,5],t=X.getEditRectBorderStyle();pq(X,function(L){X.isSelected(L)&&X.isVisible(L)&&E.add(L)}),b.clearRect(0,0,y(J.width),y(J.height)),b.save(),x.translateAndScale(b,$,c,1);var O=s,L={x:0,y:0,width:0,height:0},q=0,T=0,P=0,A=0,Q=0,k=0,Gc=0,Md=0,Fe=0,pb=0,Po=[];if(V?(delete o.$6l,delete o.$8l,delete o.$7l,delete o.$16l,delete o.$23l):(O=o.$6l,a=o.$7l),delete o.$68l,delete o.$69l,delete o.$71l,delete o.$70l,delete o.$82l,delete o.$83l,delete o._pointElevationHelperPoint,delete o.$90l,delete o.$91l,delete o.$75l,delete o.$74l,E.each(function(W){var u=X.getDataUI(W);if(u){var E=u._55O;if(X.isEditable(W))E._56O&&W instanceof l&&T++,Po.push(W),E._42O&&W instanceof l&&q++,X.isHelperEditable(W,"host")&&A++,X.isHelperEditable(W,"parent")&&P++,X.isHelperEditable(W,"remove")&&Q++,X.isHelperEditable(W,"edge")&&k++,X.isHelperEditable(W,"source")&&Gc++,X.isHelperEditable(W,"target")&&Md++,X.isHelperEditable(W,"elevation")&&Fe++,X.isHelperEditable(W,"tall")&&pb++;else if(W instanceof v&&W.isExpanded()){var Y=!0,o=X.getEditableFunc();o&&(Y=o(W)),Y&&(X.isHelperEditable(W,"host")&&A++,X.isHelperEditable(W,"parent")&&P++,X.isHelperEditable(W,"remove")&&Q++,X.isHelperEditable(W,"edge")&&k++,X.isHelperEditable(W,"source")&&Gc++,X.isHelperEditable(W,"target")&&Md++,X.isHelperEditable(W,"elevation")&&Fe++,X.isHelperEditable(W,"tall")&&pb++,Po.push(W))}}}),b.beginPath(),b.lineWidth=1,b.strokeStyle=X.getNodeBorderColor(),Po.forEach(function(c){var D=X.getDataUI(c),p=D._55O;if(V)if(a==s&&(a=c instanceof r?0:c instanceof v&&c.isExpanded()?0:c.getRotation(),o.$7l=a),O==s){var d,I,C;if(c instanceof v&&c.isExpanded()||c instanceof r){var G=X.getDataUIBounds(c);I=G.width,C=G.height,d={x:G.x+I/2,y:G.y+C/2}}else d=c.p(),I=c.getWidth(),C=c.getHeight();O={x:d.x,y:d.y,width:0,height:0},L.x=d.x-I/2,L.y=d.y-C/2,L.width=I,L.height=C,O=j(O,L)}else{var d,I,C,E,M=O.x+O.width/2,n=O.y+O.height/2,A={x:M,y:n};if(c instanceof v&&c.isExpanded()||c instanceof r){E=0;var G=X.getDataUIBounds(c);I=G.width,C=G.height,d={x:G.x+I/2,y:G.y+C/2}}else d=c.p(),I=c.getWidth(),C=c.getHeight(),E=c.getRotation();var N={x:d.x-I/2,y:d.y-C/2,width:I,height:C},B={x:N.x,y:N.y},K={x:N.x+N.width,y:N.y},J={x:N.x,y:N.y+N.height},i={x:N.x+N.width,y:N.y+N.height},B=nh(d,B.x-d.x,B.y-d.y,E),J=nh(d,J.x-d.x,J.y-d.y,E),i=nh(d,i.x-d.x,i.y-d.y,E),K=nh(d,K.x-d.x,K.y-d.y,E),u=-a,Z=nh(A,B.x-A.x,B.y-A.y,u),Q=nh(A,K.x-A.x,K.y-A.y,u),k=nh(A,J.x-A.x,J.y-A.y,u),x=nh(A,i.x-A.x,i.y-A.y,u),F=e([Z,Q,k,x]);O=j(O,F),O.x-=M,O.y-=n;var T=fn(s,O,a,A);O.x=T.x-O.width/2,O.y=T.y-O.height/2}if(q>1&&X.isEditable(c)&&X.isRectEditable(c)&&c instanceof l){var t=c.getRect(),U=p.$45l,H=wk(U[0],S),W=wk(U[2],S),_=wk(U[4],S),g=wk(U[6],S);c.getRotation()?(b.moveTo(H.x,H.y),b.lineTo(W.x,W.y),b.lineTo(_.x,_.y),b.lineTo(g.x,g.y),b.lineTo(H.x,H.y)):b.rect(t.x*S,t.y*S,t.width*S,t.height*S)}}),b.stroke(),O){o.$6l=W(O),i(O,X.getEditRectPadding()/S);var Qm={x:O.x+O.width/2,y:O.y+O.height/2},Ze=zc(Qm,O.width,O.height,a),jd=Ze[0],Yb=Ze[1],ic=Ze[2],wf=Ze[3],Re=Ze[4],Ke=Ze[5],Db=Ze[6],rk=Ze[7];if(jd=wk(Ze[0],S),Yb=wk(Ze[1],S),ic=wk(Ze[2],S),wf=wk(Ze[3],S),Re=wk(Ze[4],S),Ke=wk(Ze[5],S),Db=wk(Ze[6],S),rk=wk(Ze[7],S),o.$8l=O,q>0&&(o.$16l=[jd,Re,Yb,Ke,wf,Db,ic,rk],b.beginPath(),b.lineWidth=1,b.strokeStyle=z,"dashed"===t&&b.setLineDash&&b.setLineDash(M),b.moveTo(jd.x,jd.y),b.lineTo(Yb.x,Yb.y),b.lineTo(wf.x,wf.y),b.lineTo(ic.x,ic.y),b.lineTo(jd.x,jd.y),b.stroke(),"dashed"===t&&b.setLineDash&&b.setLineDash([])),b.beginPath(),b.lineWidth=1,b.fillStyle=U,b.strokeStyle=g,q>0){var Od=Ke.x-rk.x,qn=Ke.y-rk.y,Cl=R(Od*Od+qn*qn),sq=Re.x-Db.x,ah=Re.y-Db.y,zo=R(sq*sq+ah*ah),Cq=2*Z;if(X.isDirectionEditable&&1===Po.length){var Vh=Po[0],vq=X.getDataUI(Vh),Wj=vq._55O,dg=X.isDirectionEditable.bind(X);if(Wj._42O){var Gr,de,kb,Yc;dg(Vh,"northwest")&&(Gr=!0,b.rect(jd.x-d,jd.y-d,Z,Z)),dg(Vh,"northeast")&&(de=!0,b.rect(Yb.x-d,Yb.y-d,Z,Z)),dg(Vh,"southwest")&&(kb=!0,b.rect(ic.x-d,ic.y-d,Z,Z)),dg(Vh,"southeast")&&(Yc=!0,b.rect(wf.x-d,wf.y-d,Z,Z)),dg(Vh,"north")&&(Gr&&de?Cl>Cq&&b.rect(Re.x-d,Re.y-d,Z,Z):b.rect(Re.x-d,Re.y-d,Z,Z)),dg(Vh,"south")&&(Yc&&kb?Cl>Cq&&b.rect(Db.x-d,Db.y-d,Z,Z):b.rect(Db.x-d,Db.y-d,Z,Z)),dg(Vh,"west")&&(kb&&Gr?zo>Cq&&b.rect(rk.x-d,rk.y-d,Z,Z):b.rect(rk.x-d,rk.y-d,Z,Z)),dg(Vh,"east")&&(Yc&&de?zo>Cq&&b.rect(Ke.x-d,Ke.y-d,Z,Z):b.rect(Ke.x-d,Ke.y-d,Z,Z))}}else Cl>Cq&&(b.rect(Re.x-d,Re.y-d,Z,Z),b.rect(Db.x-d,Db.y-d,Z,Z)),zo>Cq&&(b.rect(Ke.x-d,Ke.y-d,Z,Z),b.rect(rk.x-d,rk.y-d,Z,Z)),b.rect(jd.x-d,jd.y-d,Z,Z),b.rect(Yb.x-d,Yb.y-d,Z,Z),b.rect(ic.x-d,ic.y-d,Z,Z),b.rect(wf.x-d,wf.y-d,Z,Z)}if(T>0){var _b=o.$23l=nh(Re,0,2*-Z,a);b.moveTo(_b.x+d,_b.y),b.arc(_b.x,_b.y,d,0,Y,!1)}b.fill(),b.stroke(),o.$40l&&o.$44l(b,O,a);var Sd,Hl,Uo=X.getLeftTopHelpers(),on=X.getRightTopHelpers(),Qc=X.getLeftBottomHelpers(),Ah=X.getRightBottomHelpers(),Nm=X.getEdgeHelpers(),cr=X.getEditHelperSize(),$i=cr/2,ps=function(y,G,v,m){"leftTop"===G?(Sd=O.x*S-cr-d-("h"===m?v*(cr+d):0)-1,Hl=O.y*S-cr-d-("v"===m?v*(cr+d):0)-1):"rightTop"===G?(Sd=(O.x+O.width)*S+d+("h"===m?v*(cr+d):0)+1,Hl=O.y*S-cr-d-("v"===m?v*(cr+d):0)-1):"leftBottom"===G?(Sd=O.x*S-cr-d-("h"===m?v*(cr+d):0)-1,Hl=(O.y+O.height)*S+d+("v"===m?v*(cr+d):0)+1):"rightBottom"===G&&(Sd=(O.x+O.width)*S+d+("h"===m?v*(cr+d):0)+1,Hl=(O.y+O.height)*S+d+("v"===m?v*(cr+d):0)+1);var h=Sd+$i,j=Hl+$i,e=(O.x+O.width/2)*S,x=(O.y+O.height/2)*S,I=nh({x:e,y:x},h-e,j-x,a);if("host"===y){if(A>0)return o.$77l(b,a,I),!0}else if("edge"===y){if(k>0)return o.$80l(b,a,I),!0}else if("remove"===y){if(Q>0)return Po&&1===Po.length&&Po[0]instanceof r?o.$81l(b,a,{x:e+cr/2+5,y:x}):o.$81l(b,a,I),!0}else if("parent"===y){if(P>0)return Po&&1===Po.length&&Po[0]instanceof r?o.$76l(b,a,{x:e-cr/2-5,y:x}):o.$76l(b,a,I),!0}else if("elevation"===y){if(Fe>0)return o.$85l(b,a,I),!0}else if("tall"===y){if(pb>0)return o.$86l(b,a,I),!0}else if("source"===y||"target"===y){var R=Po[0],t=X.getDataUI(R),n=Sj(t,!0),s=n[0],L=n[1];if(Gc&&"source"===y)return o.$84l(b,O,s,!0,R.isLooped(),G,v,m),!0;if(Md&&"target"===y)return o.$84l(b,O,L,!1,R.isLooped(),G,v,m),!0}};if(Uo&&Uo.length>0){var Lk=0;Uo.forEach(function(B){ps(B,"leftTop",Lk,X.getLeftTopHelpersAlign()||"h")&&Lk++})}if(on&&on.length>0){var Lk=0;on.forEach(function(Z){ps(Z,"rightTop",Lk,X.getRightTopHelpersAlign()||"h")&&Lk++})}if(Qc&&Qc.length>0){var Lk=0;Qc.forEach(function(b){ps(b,"leftBottom",Lk,X.getLeftBottomHelpersAlign()||"h")&&Lk++})}if(Ah&&Ah.length>0){var Lk=0;Ah.forEach(function(I){ps(I,"rightBottom",Lk,X.getRightBottomHelpersAlign()||"h")&&Lk++})}if(Nm&&Nm.length>0&&((Gc||Md)&&Po&&1===Po.length&&Po[0]instanceof r?!0:!1)){var Lk=0;Nm.forEach(function(_){ps(_,"edge",Lk,"h")&&Lk++})}if(o.$72l){var Ck,Wo=o.$67l,mr=o.$68l,yd=o.$69l,Vi=(o.$71l,o.$70l),Kk=o.$82l,ns=o.$83l;if(1===Wo?Ck=mr:2===Wo?Ck=yd:3===Wo?Ck=Vi:5===Wo?Ck=Kk:6===Wo&&(Ck=ns),Ck){var aj=X.lp(o.$72l),If=X.getDataAt(o.$72l);if(If&&If instanceof l){var Pf,ee,Bc;if(o.$73l=If,1===Wo)if(If instanceof n.Grid)Pf=o.$75l=yn(If,aj);else if(If instanceof n.Shape){Bc=o.$74l=bc(If,aj);var Vf=If.getPoints();if(Bc){var bi=Bc.attachIndex,dh=Oo(If,X.getDataUI(If),bi)+1,jl=dh+1>=Vf.size()?0:dh+1,Hf=Vf.get(dh),Jk=Vf.get(jl),Ne=If.p(),nk=If.getRotation();Hf=nh(Ne,Hf.x-Ne.x,Hf.y-Ne.y,nk),Jk=nh(Ne,Jk.x-Ne.x,Jk.y-Ne.y,nk),b.beginPath(),b.strokeStyle=C,b.lineWidth=m,b.moveTo(Hf.x*S,Hf.y*S),b.lineTo(Jk.x*S,Jk.y*S),b.stroke()}}Pf?ee=Pf.rect:(ee=G.clone(X.getDataUIBounds(If)),G.grow(ee,2)),b.beginPath(),b.rect(ee.x*S,ee.y*S,ee.width*S,ee.height*S),b.strokeStyle=1===Wo||4===Wo||6===Wo?N:h,b.lineWidth=2,b.setLineDash&&b.setLineDash([8,8]),b.stroke()}else delete o.$73l;aj.x=aj.x*S,aj.y=aj.y*S;var Dq=Uc(Ck.x,Ck.y,aj.x,aj.y),fd=nh(Ck,aj.x-Ck.x,aj.y-Ck.y,-Dq),Jb=fd.x-Ck.x;b.save(),b.translate(Ck.x,Ck.y),b.rotate(Dq),D.width=Jb,D.height=40;var hl=h;(1===Wo||4===Wo||6===Wo)&&(hl=N),D.comps[0].gradientColor=hl,G.drawImage(b,D,0,-20,Jb,40),b.restore()}}}if(E.each(function(R){var Z=X.getDataUI(R);if(Z){var O,T,P=Z._55O,G=Z._78o;if(P&&P._43O&&R instanceof K?(O=P.$15l,T=R.getSegments(),T&&T.size()||(T=Ag(O)),R.isClosePath()&&T.indexOf(5)<0&&(T=new f(T._as),T.add(5))):P&&G&&P._43O&&(O=R.s("edge.points"),T=R.s("edge.segments"),O=hs(Z,O),T&&T.size()||(T=Ag(O)),O&&(O=O._as)),O&&T){var N=0,r=T.size(),D=o._hoverSegmentIndex;O=O.slice(0);for(var k=0;k<O.length;k++)O[k]=wk(O[k],S);b.beginPath(),b.strokeStyle=_,b.lineWidth=1,N=0;for(var k=0;r>k;k++){var h=T.get(k);if(1===h||2===h)N++;else if(3===h){var A=O[N-1],e=O[N],W=O[N+1];b.moveTo(A.x,A.y),b.lineTo(e.x,e.y),b.lineTo(W.x,W.y),N+=2}else if(4===h){var A=O[N-1],n=O[N],V=O[N+1],W=O[N+2];b.moveTo(A.x,A.y),b.lineTo(n.x,n.y),b.moveTo(V.x,V.y),b.lineTo(W.x,W.y),N+=3}}if(b.stroke(),B===R||H===R&&"points"===H.s("edge.type")){b.beginPath(),N=0,b.strokeStyle=C,b.lineWidth=m;for(var k=0;r>k;k++){var h=T.get(k);if(1===h||2===h){if(D===k){var A=O[N-1],W=O[N];b.moveTo(A.x,A.y),b.lineTo(W.x,W.y);break}N++}else if(3===h){if(D===k){var A=O[N-1],e=O[N],W=O[N+1];b.moveTo(A.x,A.y),b.quadraticCurveTo(e.x,e.y,W.x,W.y);break}N+=2}else if(4===h){if(D===k){var A=O[N-1],n=O[N],V=O[N+1],W=O[N+2];b.moveTo(A.x,A.y),b.bezierCurveTo(n.x,n.y,V.x,V.y,W.x,W.y);break}N+=3}else if(5===h&&D===k){var A=O[N-1],W=O[0];b.moveTo(A.x,A.y),b.lineTo(W.x,W.y);break}}b.stroke()}b.beginPath(),N=0,b.strokeStyle=w,b.lineWidth=1,b.fillStyle=u;for(var k=0;r>k;k++){var h=T.get(k);if(1===h||2===h){var W=O[N];b.moveTo(W.x+d,W.y),b.arc(W.x,W.y,d,0,Y,!0),N++}else if(3===h){var W=O[N+1];b.moveTo(W.x+d,W.y),b.arc(W.x,W.y,d,0,Y,!0),N+=2}else if(4===h){var W=O[N+2];b.moveTo(W.x+d,W.y),b.arc(W.x,W.y,d,0,Y,!0),N+=3}}b.fill(),b.stroke(),b.beginPath(),N=0,b.strokeStyle=I,b.lineWidth=1,b.fillStyle=p;for(var k=0;r>k;k++){var h=T.get(k);if(1===h||2===h)N++;else if(3===h){var e=O[N];b.moveTo(e.x+d,e.y),b.arc(e.x,e.y,d,0,Y,!0),N+=2}else if(4===h){var n=O[N],V=O[N+1];b.moveTo(n.x+d,n.y),b.arc(n.x,n.y,d,0,Y,!0),b.moveTo(V.x+d,V.y),b.arc(V.x,V.y,d,0,Y,!0),N+=3}}if(b.fill(),b.stroke(),b.beginPath(),N=0,b.strokeStyle=F,b.lineWidth=2,(B===R||H===R)&&o.$9l!=s){var W=O[o.$9l];b.moveTo(W.x+d,W.y),b.arc(W.x,W.y,d,0,Y,!0),b.stroke()}}}}),o.$87l&&X.sm().contains(o.$87l)){var js,ep=o.$87l,Uj=o.$88l,cr=X.getEditHelperSize(),$i=cr/2;if(X.isHelperEditable(ep,"pointElevation"))if(ep instanceof K){var pn=ep.getPosition();js=G.clone(ep.getPoints().get(Uj)),js=nh({x:pn.x,y:pn.y},js.x-pn.x,js.y-pn.y,ep.getRotation()),js.x*=S,js.y*=S,b.translate(js.x,js.y),G.drawImage(b,G.getImage("xeditinteractor_elevationIcon"),$i,-$i,cr,cr),b.translate(-js.x,-js.y),o._pointElevationHelperPoint={x:js.x+cr,y:js.y}}else if(ep instanceof r){var Ll=hs(X.getDataUI(ep),ep.s("edge.points")),js=G.clone(Ll.get(Uj));js.x*=S,js.y*=S,b.translate(js.x,js.y),G.drawImage(b,G.getImage("xeditinteractor_elevationIcon"),$i,-$i,cr,cr),b.translate(-js.x,-js.y),o._pointElevationHelperPoint={x:js.x+cr,y:js.y}}}b.restore(),o.$5l=0}},$89l:function(H,F,v,C){H.save();var _=this,u=_.gv,K=u.getEditHelperSize(),b=K/2;H.beginPath(),H.translate(v.x,v.y),H.rotate(F),G.drawImage(H,C,-b,-b,K,K),H.restore()},$85l:function($,x,H){var D=this;D.$90l=H,D.$89l($,x,H,G.getImage("xeditinteractor_elevationIcon"))},$86l:function(Q,E,J){var g=this;g.$91l=J,g.$89l(Q,E,J,G.getImage("xeditinteractor_tallIcon"))},$77l:function($,j,L){var B=this;B.$68l=L,B.$89l($,j,L,G.getImage("xeditinteractor_hostIcon"))},$80l:function(h,C,i){var j=this;j.$70l=i,j.$89l(h,C,i,G.getImage("xeditinteractor_edgeIcon"))},$81l:function(n,I,k){var f=this;f.$71l=k,f.$89l(n,I,k,G.getImage("xeditinteractor_removeIcon"))},$76l:function(E,r,x){var h=this;h.$69l=x,h.$89l(E,r,x,G.getImage("xeditinteractor_parentIcon"))},$84l:function(L,f,c,T,U){var Q,t=this,u=t.gv,z=u.getZoom(),J=u.getEditHelperSize(),e=J/2;c.x*=z,c.y*=z,U&&(T?c.x-=e+5:c.x+=e+5),c.y-=J-2,T?(t.$82l=c,Q=G.getImage("xeditinteractor_sourceIcon")):(t.$83l=c,Q=G.getImage("xeditinteractor_targetIcon")),L.beginPath(),L.translate(c.x,c.y),G.drawImage(L,Q,-e,-e,J,J),L.translate(-c.x,-c.y)},$44l:function(h,A,r){h.save();var G=this.gv.getZoom(),K=R(k(A.width,2)+k(A.height,2))/2*G+10,u=K,X=u+8,P=u+18,_=r,l=A.x+A.width/2,d=A.y+A.height/2;h.translate(l*G,d*G),h.beginPath(),h.strokeStyle="rgb(150, 150, 150)";for(var g=0,z=0,y=0,Z=0,p=0,J=0;360>J;J++)g=J*M/180,0===J%5&&(z=q(g)*u,y=m(g)*u,Z=q(g)*X,p=m(g)*X,h.moveTo(z,y),h.lineTo(Z,p)),0===J%45&&(z=q(g)*u,y=m(g)*u,Z=q(g)*P,p=m(g)*P,h.moveTo(z,y),h.lineTo(Z,p));h.stroke(),h.beginPath(),h.rotate(-w),h.beginPath(),h.fillStyle="rgba(255, 0, 0, 0.1)",h.strokeStyle="rgb(157, 157, 157)",h.moveTo(0,0),h.arc(0,0,P,0,r,!1),h.fill(),h.beginPath(),h.moveTo(0+P,0),h.arc(0,0,P,0,r,!1),h.stroke(),h.rotate(w),h.font="bold 12px Verdana, Arial";var D=20*m(_),c=20*q(_),i=T(180*_/M)+"°";h.textAlign="center",h.textBaseline="middle",h.beginPath();var s=h.measureText("365.°").width;h.fillStyle="white",h.rect(D-s/2,-c-10,s,20),h.fill(),h.beginPath(),h.fillStyle="rgb(79,79,79)",h.fillText(i,D,-c),h.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);