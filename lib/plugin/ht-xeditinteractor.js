!function(R,j,b){"use strict";var $="ht",c=R[$],v=c.Default,V=c.graph,y=v.getInternal(),N=y.ui(),I=N.NodeUI.prototype,q=N.ShapeUI.prototype,h=V.GraphView,f=h.prototype,O=N.EdgeUI.prototype,Q=c.Node,k=c.Shape,o=c.Edge,E=c.Group,M=v.isTouchable,L=v.preventDefault,i=R.setTimeout,u=v.grow,T=v.isDragging,a=v.getDistance,n=null,G=c.List,s="undefined"!=typeof Float32Array?Float32Array:Array,B=Math,F=B.PI,Y="Crossing",J="No Crossing",x=F/2,m=2*F,w=B.atan2,l=B.sqrt,g=B.pow,A=B.sin,Z=B.cos,D=B.min,U=B.max,r=B.abs,S=B.ceil,W=B.round,X=v.unionPoint,P=v.unionRect,H=v.containsPoint,C=v.clone,d="rgb(52, 152, 219)",z="red",_={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},p={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var l=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],c=0;c<l.length;c++){var s=l[c];s=0===c%2?s/400*p.width:s/100*p.height,l[c]=s}return p.width>120&&(l[4]=p.width-26,l[6]=p.width-40,l[10]=p.width-40,l[12]=p.width-26,l[18]=33),l}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},e={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:d,rotation:.61},{type:"circle",rect:[200,120,70,70],background:d,rotation:.61},{type:"circle",rect:[200,220,70,70],background:d,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:d},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:d}]},K={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:z,rotation:.61}]},t={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:d},{type:"circle",rect:[0,210,90,90],background:d},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:d}]},Vr={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:z},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:z}]},xk={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:d}]},ls={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:z}]},Fi={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},So={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},hq=function(C){var q=C.touches[0];return q?q:C.changedTouches[0]},yp=function(e,z,x,S){return w(S-z,x-e)},be=function(r,g){return{x:r.x*g,y:r.y*g}},Jq=function(a,q){a.each(function(l){return a.isSelected(l)?q(l):void 0})},Ee=function(R,h){R.reverseEach(function(A){return R.isSelected(A)?h(A):void 0})},_n=function(f,C,L){var q,l,F,Q,r,_=this,R=C,v=_.gv;if(f instanceof k){F=f.getSegments();var A=v.getDataUI(f);r=A._55O.$15l,F&&F.size()||(F=Ah(r)),f.isClosePath()&&F.indexOf(5)<0&&(F=new G(F._as),F.add(5)),q=xg(f,A,R),l=r[q]}else{var z=v.getDataUI(f);r=lq(z,f.s("edge.points")),F=f.s("edge.segments"),F&&F.size()||(F=Ah(r)),r=r._as,q=xg(f,z,R),l=r[q]}if(F&&(Q=F.get(R)),2===Q||1===Q||5===Q){var $=r[q+1];5===Q&&($=r[0]);var X=Cg(l,L,$);return X}return L},Kg=function(n,Y,d,S){var e=Y/2,c=d/2,H=tr(n,-e,-c,S),W=tr(n,e,-c,S),G=tr(n,-e,c,S),t=tr(n,e,c,S),P=tr(n,0,-c,S),p=tr(n,e,0,S),Q=tr(n,0,c,S),F=tr(n,-e,0,S);return[H,W,G,t,P,p,Q,F]},Cg=function(L,h,k){var B={x:h.x-L.x,y:h.y-L.y},x={x:k.x-L.x,y:k.y-L.y},Z=l(g(k.x-L.x,2)+g(k.y-L.y,2)),o={x:x.x/Z,y:x.y/Z},y=B.x*o.x+B.y*o.y,e={x:o.x*y,y:o.y*y};return{x:L.x+e.x,y:L.y+e.y}},tr=function(w,G,d,t){var r=Z(t)*G-A(t)*d,W=A(t)*G+Z(t)*d;return w?{x:w.x+r,y:w.y+W}:{x:r,y:W}},Bf=function(v,q){return q>2*v?v:q/2},rq=function(O,X,G,n){var j=a(O,X);return G=n?D(G,j):Bf(G,j),j?G/=j:G=0,{x:O.x+(X.x-O.x)*G,y:O.y+(X.y-O.y)*G}},Nl=function(l,A){var X,T,c=l.gv,Z=l._data,w=Z._40I,x=Z._41I,e=Z.s("edge.offset"),t=Z.s("edge.source.position"),V=Z.s("edge.target.position"),E=Z.s("edge.source.offset.x"),Y=Z.s("edge.source.offset.y"),Q=Z.s("edge.target.offset.x"),o=Z.s("edge.target.offset.y"),b=Z.s("edge.source.anchor.x"),P=Z.s("edge.source.anchor.y"),L=Z.s("edge.target.anchor.x"),W=Z.s("edge.target.anchor.y");if(A?(X=y.getEdgeAgentPosition(c,w,t,E,Y,b,P),T=y.getEdgeAgentPosition(c,x,V,Q,o,L,W)):(X=y.getEdgeAgentPosition(c,w,t,0,0,b,P),T=y.getEdgeAgentPosition(c,x,V,0,0,L,W)),"points"===Z.s("edge.type")&&e&&!Z.s("edge.center")&&X){var D=Z.s("edge.points")||new G,B=D.size(),f=rq(X,B?D.get(0):T,e,B),M=rq(T,B?D.get(B-1):X,e,B);X=f,T=M}return[X,T]},lq=function(M,q,c){var s=M._78o,i=M._data,I=i.s("edge.type"),H=[s.sourcePoint,s.targetPoint];return"points"===I?c&&(H=Nl(M)):H=s.center?I?c?Nl(M):Nl(M,!0):c?Nl(M):[s.c1,s.c2]:c?Nl(M):Nl(M,!0),q=new G(q?q._as:n),q.add(H[0],0),q.add(H[1]),q},Vd=function(C){return C=new G(C._as),C.removeAt(0),C.removeAt(C.size()-1),C},Ah=function(l){l._as||(l=new G(l));var V=new G;V.add(1);for(var g=1;g<l.size();g++)V.add(2);return V},ln=function(H,F){return{x:(H.x+F.x)/2,y:(H.y+F.y)/2}},Bs=function(u,T){return{x:u.x+1*(T.x-u.x)/4,y:u.y+1*(T.y-u.y)/4}},Rd=function(e,E){return{x:e.x+3*(E.x-e.x)/4,y:e.y+3*(E.y-e.y)/4}},re=function(a,S,U,G){var t=S.x+S.width/2,Y=S.y+S.height/2,i=l(t*t+Y*Y),I=w(Y,t)+U;return{x:G.x+i*Z(I),y:G.y+i*A(I)}},sk=f.validateImpl,dr=f.isRectEditable,dk=f.isPointEditable,uo=f._42,Be=q._79o,Rg=O._79o,kd=q._48O,Ic=q._47O,yn=I._48O,Zg=I._80o,Gj=q._80o,Cl=I.getSelectWidth,vb=I._47O,xh=O._47O,Yo=f.isEditable,Cj=["northwest","north","northeast","east","southeast","south","southwest","west"],Dg=function(f,v,c,p,s,b,h,H,d,P){var e=f.x,x=f.y,W=f.width,w=f.height,m={x:e+W/2,y:x+w/2};p=p||0,v=tr(m,v.x-m.x,v.y-m.y,-p),h&&!H&&(v.x+=d,v.y+=P);var u=.01;if("northwest"===c?(v.x+s>e+W-u&&(v.x=e+W-s-u),v.y+s>x+w-u&&(v.y=x+w-s-u),f=X(v,{x:e+W,y:x+w})):"north"===c?(v.y+s>x+w-u&&(v.y=x+w-s-u),f=X({x:e,y:v.y},{x:e+W,y:x+w})):"northeast"===c?(v.x<e+s+u&&(v.x=e+s+u),v.y+s>x+w-u&&(v.y=x+w-s-u),f=X({x:e,y:v.y},{x:v.x,y:x+w})):"west"===c?(v.x+s>e+W-u&&(v.x=e+W-s-u),f=X({x:v.x,y:x},{x:e+W,y:x+w})):"east"===c?(v.x<e+s+u&&(v.x=e+s+u),f=X({x:e,y:x},{x:v.x,y:x+w})):"southwest"===c?(v.x+s>e+W-u&&(v.x=e+W-s-u),v.y<x+s+u&&(v.y=x+s+u),f=X({x:v.x,y:x},{x:e+W,y:v.y})):"south"===c?(v.y<x+s+u&&(v.y=x+s+u),f=X({x:e,y:x},{x:e+W,y:v.y})):"southeast"===c&&(v.x<e+s+u&&(v.x=e+s+u),v.y<x+s+u&&(v.y=x+s+u),f=X({x:e,y:x},v)),"keepRatio"===b&&(!h&&H||h&&!H)&&("northeast"===c||"southeast"===c||"northwest"===c||"southwest"===c)){var $=f.width,J=f.height,V=$/W,Y=J/w,S=D(V,Y);f.width=W*S,f.height=w*S,"northeast"===c?f.y=x+(w-f.height):"northwest"===c?(f.y=x+(w-f.height),f.x=e+(W-f.width)):"southwest"===c&&(f.x=e+(W-f.width))}f.x-=m.x,f.y-=m.y;var i=re(n,f,p,m);return f.x=i.x-f.width/2,f.y=i.y-f.height/2,f},cr=function(M,T,j,w){var K=M.getRotation(),R=T,t=R.x,V=R.y,c=R.width,W=R.height,_={x:t+R.width/2,y:V+R.height/2};w=tr(_,w.x-_.x,w.y-_.y,-K),"northwest"===j?R=X(w,{x:t+c,y:V+W}):"north"===j?R=X({x:t,y:w.y},{x:t+c,y:V+W}):"northeast"===j?R=X({x:t,y:w.y},{x:w.x,y:V+W}):"west"===j?R=X({x:w.x,y:V},{x:t+c,y:V+W}):"east"===j?R=X({x:t,y:V},{x:w.x,y:V+W}):"southwest"===j?R=X({x:w.x,y:V},{x:t+c,y:w.y}):"south"===j?R=X({x:t,y:V},{x:t+c,y:w.y}):"southeast"===j&&(R=X({x:t,y:V},w)),M.setRect(R),R.x-=_.x,R.y-=_.y;var e=re(M,R,K,_);M.p(e.x,e.y)},cj=function(m,N,E,V,g,Y,X,F){var M=n;Y?(M=tr(n,g.x-N.x,g.y-N.y,-E),M.x-=X.x,M.y-=X.y):M=tr(n,g.x-N.x,g.y-N.y,0);var S={x:N.x+M.x,y:N.y+M.y};F&&(S=F(S.x,S.y)),S.e=m.getPoints().get(V).e,m.setPoint(V,S);var t=m.getWidth(),D=m.getHeight(),z=m.p().x-t/2,r=m.p().y-D/2;z-=N.x,r-=N.y;var P=re(m,{x:z,y:r,width:t,height:D},E,N);m.p(P.x,P.y)},xg=function(W,j,y){var S,e;if(W instanceof k?(S=W.getPoints(),e=W.getSegments()):W instanceof o&&"points"===W.s("edge.type")&&(S=W.s("edge.points"),e=W.s("edge.segments"),S=lq(j,S)),e&&e.size()||(e=Ah(S)),W instanceof k&&W.isClosePath()&&e.indexOf(5)<0&&(e=new G(e._as),e.add(5)),e)for(var h=-1,O=0;O<e.size();O++){if(O===y)return h;var n=e.get(O);1===n?h+=1:2===n?h+=1:3===n?h+=2:4===n&&(h+=3)}},kb=function(H,q,B){var z,n;if(H instanceof k?(z=H.getPoints(),n=H.getSegments()):H instanceof o&&"points"===H.s("edge.type")&&(z=H.s("edge.points"),n=H.s("edge.segments"),z=lq(q,z)),n&&n.size()||(n=Ah(z)),n)for(var X=-1,j=0;j<n.size();j++){var g=n.get(j);if(1===g?X+=1:2===g?X+=1:3===g?X+=2:4===g&&(X+=3),X===B)return j}},Sb=function(m,F){var c=[m[0]-F[0],m[1]-F[1],m[2]-F[2]];return c},_o=function(){var E=new s(16);return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E},fi=function(J,H){var E=J[0],F=J[1],Z=J[2];return J[0]=H[0]*E+H[4]*F+H[8]*Z+H[12],J[1]=H[1]*E+H[5]*F+H[9]*Z+H[13],J[2]=H[2]*E+H[6]*F+H[10]*Z+H[14],J},_h=function(U,r){if(r){var _=A(r),R=Z(r),M=U[0],B=U[1],K=U[2],X=U[3],t=U[8],s=U[9],N=U[10],J=U[11];U[0]=M*R-t*_,U[1]=B*R-s*_,U[2]=K*R-N*_,U[3]=X*R-J*_,U[8]=M*_+t*R,U[9]=B*_+s*R,U[10]=K*_+N*R,U[11]=X*_+J*R}},Dl=function(x,V){for(var A=x.s("grid.row.count"),X=x.s("grid.column.count"),y=0;A>y;y++)for(var e=0;X>e;e++){var p=x.getCellRect(y,e);if(H(p,V))return{rowIndex:y,columnIndex:e,rect:p,grid:x}}return null},Vg=function(H,$,S,R,N,E){var Y={},g=S-H,Z=R-$,I=B.sqrt(g*g+Z*Z),y=g/I,l=Z/I,V=(-H+N)*y+(-$+E)*l;return 0>=V?(Y.x=H,Y.y=$):V>=I?(Y.x=S,Y.y=R):(Y.x=H+V*y,Y.y=$+V*l),g=N-Y.x,Z=E-Y.y,Y.z=B.sqrt(g*g+Z*Z),Y},Td=function(U,w){var r,Z,t,f,O,Y,e,x,m=U.getPoints(),I=U.getSegments(),z=U.p(),g=U.getRotation();if(!I||!(I.indexOf(3)>0||I.indexOf(4)>0)){for(x=0;x<=m.size()-1;x++)if(x===m.size()-1?(O=m.get(0),f=m.get(x)):(f=m.get(x),O=m.get(x+1)),f=tr(z,f.x-z.x,f.y-z.y,g),O=tr(z,O.x-z.x,O.y-z.y,g),Y=Vg(f.x,f.y,O.x,O.y,w.x,w.y),e=Y.z,e<(U.s("shape.border.width")||10)){Z=f,t=O,r=x;break}if(r!=n){var F=Vg(Z.x,Z.y,t.x,t.y,w.x,w.y),b=a(Z,F);return{attachIndex:r,attachOffset:b}}}},Rp=function(f){for(var C=f._data,z=C.p(),l=C.getRotation(),j=C.getPoints(),u=n,h=[],L=0;L<j.size();L++)u=j.get(L),h.push(tr(z,u.x-z.x,u.y-z.y,l));f._55O.$15l=h};v.setImage("xeditinteractor_parentIcon",e),v.setImage("xeditinteractor_hostIcon",K),v.setImage("xeditinteractor_edgeIcon",t),v.setImage("xeditinteractor_removeIcon",Vr),v.setImage("xeditinteractor_sourceIcon",xk),v.setImage("xeditinteractor_targetIcon",ls),v.setImage("xeditinteractor_elevationIcon",Fi),v.setImage("xeditinteractor_tallIcon",So),f._editPointSize=M?24:9,f._edgeHelpers=["parent","remove","source","target"],f._leftTopHelpers=["parent"],f._rightTopHelpers=["host"],f._leftBottomHelpers=["edge"],f._rightBottomHelpers=["remove"],Cj=Cj.concat(Cj).concat(Cj),O._79o=function(){var R=this,K=R.gv,x=K.getZoom(),L=K._editInteractor,W=Rg.call(R);if(!W)return null;var l=Nl(R,!0),I=l[0],b=l[1],T={x:W.x,y:W.y,width:W.width,height:W.height},D=X(I,b);if(L instanceof V.XEditInteractor){T=P(T,D);var U=R._55O,d=K.getEditPointSize()/x+2,r=0;U&&U._43O&&(r+=d/2,u(T,r))}return T},O._47O=function(F){var I=this,r=I.gv,D=r._editInteractor;D instanceof V.XEditInteractor||xh.call(I,F)},O.rectIntersects=function(y){var t=this,c=t._data,T=t.gv,A=T.getZoom(),f=t._55O,v=T._editInteractor;if(v instanceof V.XEditInteractor&&T.isEditable(c)&&f&&f._43O&&"points"===c.s("edge.type")){var j=c.s("edge.points"),B=c.s("edge.segments");j=lq(t,j),B&&B.size()||(B=Ah(j)),j=j._as;var g=!1,P=M?5:1,U=y.x+P,J=y.y+P,R={x:U,y:J};if(v._edge===c&&v._hoverSegmentIndex>=0){var q=T._editInteractor._hoverSegmentIndex,s=B.get(q),G=xg(c,t,q),F=n;if(G!=n&&G>=0){var r=j[G],H=T.getSegmentHoverWidth()/A;if(2===s||1===s){var K=j[G+1];F=pj(new Sp(r.x,r.y),new Sp(K.x,K.y),new Sp(R.x-H,R.y-H),new Sp(R.x+2*H,R.y+2*H)),F.$62l===Y&&(g=!0)}else if(3===s){var W=j[G+1],K=j[G+2];F=pc(new Sp(r.x,r.y),new Sp(W.x,W.y),new Sp(K.x,K.y),new Sp(R.x-H,R.y-H),new Sp(R.x+2*H,R.y+2*H)),F.$62l===Y&&(g=!0)}else if(4===s){var p=j[G+1],a=j[G+2];K=j[G+3],F=id(new Sp(r.x,r.y),new Sp(p.x,p.y),new Sp(a.x,a.y),new Sp(K.x,K.y),new Sp(R.x-H,R.y-H),new Sp(R.x+2*H,R.y+2*H)),F.$62l===Y&&(g=!0)}}}if(g)return!0}return n},q._47O=function(t){var T=this,R=T.gv,k=R._editInteractor;k instanceof V.XEditInteractor||Ic.call(T,t)},q.rectIntersects=function(k){var h=this,y=h._data,b=h.gv,F=b.getZoom(),Z=h._55O,B=b._editInteractor;if(B instanceof V.XEditInteractor&&b.isEditable(y)&&Z&&Z._43O){var U=Z.$15l,L=!1,t=M?5:1,O=k.x+t,S=k.y+t,c={x:O,y:S};if(U&&U.length===y.getPoints().size()||(Rp(h),U=Z.$15l),B._shape===y&&B._hoverSegmentIndex>=0){var $=y.getSegments();$&&$.size()||($=Ah(U));var D=b._editInteractor._hoverSegmentIndex,l=$.get(D),d=xg(y,h,D),w=n;if(d!=n&&d>=0){var J=U[d],f=b.getSegmentHoverWidth()/F;if(2===l||1===l){var z=U[d+1];w=pj(new Sp(J.x,J.y),new Sp(z.x,z.y),new Sp(c.x-f,c.y-f),new Sp(c.x+2*f,c.y+2*f)),w.$62l===Y&&(L=!0)}else if(3===l){var s=U[d+1],z=U[d+2];w=pc(new Sp(J.x,J.y),new Sp(s.x,s.y),new Sp(z.x,z.y),new Sp(c.x-f,c.y-f),new Sp(c.x+2*f,c.y+2*f)),w.$62l===Y&&(L=!0)}else if(4===l){var u=U[d+1],v=U[d+2];z=U[d+3],w=id(new Sp(J.x,J.y),new Sp(u.x,u.y),new Sp(v.x,v.y),new Sp(z.x,z.y),new Sp(c.x-f,c.y-f),new Sp(c.x+2*f,c.y+2*f)),w.$62l===Y&&(L=!0)}}}if(L)return!0}return n},q._48O=function(){var P=this,g=P.gv,R=g._editInteractor;R instanceof V.XEditInteractor?(I._48O.call(P),P._55O._43O&&Rp(P)):kd.call(P)},q._79o=function(){var E=this,y=E.gv,O=y.getZoom(),P=y._editInteractor,M=Be.call(E);if(M){var f={x:M.x,y:M.y,width:M.width,height:M.height};if(P instanceof V.XEditInteractor){var Y=E._55O,A=y.getEditPointSize()/O+2,B=0;Y&&Y._43O&&(B+=A/2,u(f,B))}return f}},I._47O=function(Y){var G=this,U=G.gv,o=U._editInteractor;if(o instanceof V.XEditInteractor);else{var J=G._55O;J&&J._98o&&vb.call(G,Y)}},I.getSelectWidth=function(){var e=this,P=e.gv,K=P._editInteractor,x=e._data;return P.isEditable(x)&&K instanceof V.XEditInteractor?0:Cl.call(e)},I._80o=function(w){var s=this,Z=s.gv._editInteractor;if(Zg.call(s,w),Z&&Z._debug){w.save(),w.beginPath(),w.lineWidth=1,w.strokeStyle="green";var n=s._79o();n&&(w.rect(n.x,n.y,n.width,n.height),w.stroke()),w.restore()}},q._80o=function(d){var V=this,g=V.gv._editInteractor;if(Gj.call(V,d),g&&g._debug){d.save(),d.beginPath(),d.lineWidth=1,d.strokeStyle="green";var W=V._79o();d.rect(W.x,W.y,W.width,W.height),d.stroke(),d.restore()}},I._48O=function(){var E=this,p=E.gv,X=E._data,U=p._editInteractor,N=E._55O,x=X.p(),S=X.getRotation();if(U instanceof V.XEditInteractor){if(N._42O){var O=Kg(x,X.getWidth(),X.getHeight(),S),R=O[0],b=O[1],H=O[2],$=O[3],F=O[4],k=O[5],A=O[6],f=O[7];N.$45l=[R,F,b,k,$,A,H,f]}}else yn.call(E)},f.getResizeMode=function(){return this.$25l||"normal"},f.setResizeMode=function(Q){var O=this.$25l;this.$25l=Q,this.fp("resizeMode",O,Q)},f.getSnapAngle=function(){return this.$26l||Math.PI/36},f.setSnapAngle=function(K){var o=this.$26l;this.$26l=K,this.fp("snapAngle",o,K)},f.getSnapSpacing=function(){return this.$27l},f.setSnapSpacing=function(c){var D=this.$27l;this.$27l=c,this.fp("snapSpacing",D,c)},f.getPointSnapSpacing=function(){return this._pointSnapSpacing},f.setPointSnapSpacing=function(x){var m=this._pointSnapSpacing;this._pointSnapSpacing=x,this.fp("pointSnapSpacing",m,x)},f.setHelperEditableFunc=function(h){var L=this._helperEditableFunc;this._helperEditableFunc=h,this.fp("helperEditableFunc",L,h)},f.getHelperEditableFunc=function(){return this._helperEditableFunc},f.setLeftTopHelpers=function(W){var J=this._leftTopHelpers;this._leftTopHelpers=W,this.fp("leftTopHelpers",J,W)},f.getLeftTopHelpers=function(){return this._leftTopHelpers},f.setLeftTopHelpersAlign=function(W){var F=this._leftTopHelpersAlign;this._leftTopHelpersAlign=W,this.fp("leftTopHelpersAlign",F,W)},f.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},f.setRightTopHelpers=function(r){var v=this._rightTopHelpers;this._rightTopHelpers=r,this.fp("rightTopHelpers",v,r)},f.getRightTopHelpers=function(){return this._rightTopHelpers},f.setRightTopHelpersAlign=function(Q){var a=this._rightTopHelpersAlign;this._rightTopHelpersAlign=Q,this.fp("rightTopHelpersAlign",a,Q)},f.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},f.setLeftBottomHelpers=function(i){var k=this._leftBottomHelpers;this._leftBottomHelpers=i,this.fp("leftBottomHelpers",k,i)},f.getLeftBottomHelpers=function(){return this._leftBottomHelpers},f.setLeftBottomHelpersAlign=function(H){var I=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=H,this.fp("leftBottomHelpersAlign",I,H)},f.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},f.setRightBottomHelpers=function(d){var K=this._rightBottomHelpers;this._rightBottomHelpers=d,this.fp("rightBottomHelpers",K,d)},f.getRightBottomHelpers=function(){return this._rightBottomHelpers},f.setRightBottomHelpersAlign=function(b){var W=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=b,this.fp("rightBottomHelpersAlign",W,b)},f.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},f.setEdgeHelpers=function(h){var v=this._edgeHelpers;this._edgeHelpers=h,this.fp("edgeHelpers",v,h)},f.getEdgeHelpers=function(){return this._edgeHelpers},f.isHelperEditable=function(R,w){return R instanceof o&&("host"===w||"edge"===w||"elevation"===w||"tall"===w)?!1:R instanceof Q&&("source"===w||"target"===w)?!1:"pointElevation"===w?this._helperEditableFunc?this._helperEditableFunc(R,w):!1:this._helperEditableFunc?this._helperEditableFunc(R,w):!0},f.getEditHelperSize=function(){return this._editHelperSize||(M?28:16)},f.setEditHelperSize=function(D){var C=this._editHelperSize;this._editHelperSize=D,this.fp("editHelperSize",C,D)},f.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},f.setEditRectBorderColor=function(B){var b=this.$28l;this.$28l=B,this.fp("editRectBorderColor",b,B)},f.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},f.setNodeBorderColor=function(K){var G=this.$29l;this.$29l=K,this.fp("nodeBorderColor",G,K)},f.getEditRectBorderStyle=function(){return this.$30l||"dashed"},f.setEditRectBorderStyle=function(Y){var O=this.$30l;this.$30l=Y,this.fp("editRectBorderStyle",O,Y)},f.getControlPointBackground=function(){return this.$31l||"#ff0"},f.setControlPointBackground=function(p){var j=this.$31l;this.$31l=p,this.fp("controlPointBackground",j,p)},f.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},f.setControlPointBorderColor=function(I){var t=this.$32l;this.$32l=I,this.fp("controlPointBorderColor",t,I)},f.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},f.setJoinPointBackground=function(A){var O=this.$33l;this.$33l=A,this.fp("joinPointBackground",O,A)},f.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},f.setJoinPointBorderColor=function(n){var L=this.$34l;this.$34l=n,this.fp("joinPointBorderColor",L,n)},f.getDirectionLineColor=function(){return this.$35l||"#888"},f.setDirectionLineColor=function(T){var D=this.$35l;this.$35l=T,this.fp("directionLineColor",D,T)},f.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},f.setSegmentHoverColor=function(m){var W=this.$36l;this.$36l=m,this.fp("segmentHoverColor",W,m)},f.getSegmentHoverWidth=function(){return this.$22l||(M?16:8)},f.setSegmentHoverWidth=function(j){var w=this.$22l;this.$22l=j,this.fp("segmentHoverWidth",w,j)},f.getSnapPointBorderColor=function(){return this.$38l||"#f00"},f.setSnapPointBorderColor=function(R){var Q=this.$38l;this.$38l=R,this.fp("snapPointBorderColor",Q,R)},f.getEditRectPadding=function(){return this.$39l!=n?this.$39l:6},f.setEditRectPadding=function(Z){var y=this.$39l;this.$39l=Z,this.fp("editRectPading",y,Z)},f.isRectEditable=function(w){var n=this,g=n._editInteractor;return g instanceof V.XEditInteractor?n._rectEditableFunc?n._rectEditableFunc(w):!0:dr.call(n,w)},f.isPointEditable=function(p){var H=this,u=H._editInteractor;return u instanceof V.XEditInteractor?H._pointEditableFunc?H._pointEditableFunc(p):!0:dk.call(H,p)},f.validateImpl=function(){var E=this,u=E.$14l,f=E._editInteractor;if(u){var B=E.getWidth(),n=E.getHeight();(B!==u.clientWidth||n!==u.clientHeight)&&(f&&(f._68I=1),y.setCanvas(u,B,n),E._32I=1)}sk.call(this)},f.isEditable=function(y){var e=Yo.call(this,y),T=this._editInteractor;if(T instanceof V.XEditInteractor&&y instanceof o){if(!y.s("2d.editable"))return!1;var H=this.getEditableFunc();e=H?H(y):!0}return e},f._42=function(X,J){var E=this,o=E._editInteractor;uo.call(E,X,J),o instanceof V.XEditInteractor&&o._68I&&o._42()},f.isSnapPoint=function(){return!0};var xo=function(o){arguments.length>0&&this.$58l(o)},wf=xo.prototype;wf.$58l=function(z){this.$62l=z,this.points=new Array},wf.$56l=function(e){this.points.push(e)},wf.$57l=function(n){this.points=this.points.concat(n)};var Sp=function(V,m){arguments.length>0&&this.$58l(V,m)},oo=Sp.prototype;oo.$58l=function(Z,S){this.x=Z,this.y=S},oo.add=function(p){return new Sp(this.x+p.x,this.y+p.y)},oo.addEquals=function(Q){return this.x+=Q.x,this.y+=Q.y,this},oo.$55l=function(z){return new Sp(this.x*z,this.y*z)},oo.eq=function(z){return this.x==z.x&&this.y==z.y},oo.lt=function(c){return this.x<c.x&&this.y<c.y},oo.lte=function(r){return this.x<=r.x&&this.y<=r.y},oo.gt=function(x){return this.x>x.x&&this.y>x.y},oo.gte=function(j){return this.x>=j.x&&this.y>=j.y},oo.lerp=function(S,i){return new Sp(this.x+(S.x-this.x)*i,this.y+(S.y-this.y)*i)},oo.distanceFrom=function(m){var u=this.x-m.x,Z=this.y-m.y;return l(u*u+Z*Z)},oo.min=function(l){return new Sp(D(this.x,l.x),D(this.y,l.y))},oo.max=function(e){return new Sp(U(this.x,e.x),U(this.y,e.y))},oo.toString=function(){return this.x+","+this.y};var Gf=function(){this.$58l(arguments)},yc=Gf.prototype;Gf.TO=1e-6,Gf.AC=6,yc.$58l=function(p){this.co=new Array;for(var S=p.length-1;S>=0;S--)this.co.push(p[S])},yc.$55l=function(z){for(var B=new Gf,C=0;C<=this.$50l()+z.$50l();C++)B.co.push(0);for(var C=0;C<=this.$50l();C++)for(var p=0;p<=z.$50l();p++)B.co[C+p]+=this.co[C]*z.co[p];return B},yc.$59l=function(){for(var I=this.$50l();I>=0&&r(this.co[I])<=Gf.TO;I--)this.co.pop()},yc.$50l=function(){return this.co.length-1},yc.$51l=function(){var m;switch(this.$59l(),this.$50l()){case 0:m=new Array;break;case 1:m=this.$52l();break;case 2:m=this.$53l();break;case 3:m=this.$54l();break;case 4:m=this.$63l();break;default:m=new Array}return m},yc.$52l=function(){var u=new Array,U=this.co[1];return 0!=U&&u.push(-this.co[0]/U),u},yc.$53l=function(){var k=new Array;if(2==this.$50l()){var E=this.co[2],T=this.co[1]/E,B=this.co[0]/E,m=T*T-4*B;if(m>0){var O=l(m);k.push(.5*(-T+O)),k.push(.5*(-T-O))}else 0==m&&k.push(.5*-T)}return k},yc.$63l=function(){var G=new Array;if(4==this.$50l()){var S=this.co[4],Q=this.co[3]/S,y=this.co[2]/S,Y=this.co[1]/S,P=this.co[0]/S,k=new Gf(1,-y,Q*Y-4*P,-Q*Q*P+4*y*P-Y*Y).$54l(),p=k[0],N=Q*Q/4-y+p;if(r(N)<=Gf.TO&&(N=0),N>0){var m=l(N),x=3*Q*Q/4-m*m-2*y,H=(4*Q*y-8*Y-Q*Q*Q)/(4*m),w=x+H,o=x-H;if(r(w)<=Gf.TO&&(w=0),r(o)<=Gf.TO&&(o=0),w>=0){var U=l(w);G.push(-Q/4+(m+U)/2),G.push(-Q/4+(m-U)/2)}if(o>=0){var U=l(o);G.push(-Q/4+(U-m)/2),G.push(-Q/4-(U+m)/2)}}else if(0>N);else{var H=p*p-4*P;if(H>=-Gf.TO){if(0>H&&(H=0),H=2*l(H),x=3*Q*Q/4-2*y,x+H>=Gf.TO){var _=l(x+H);G.push(-Q/4+_/2),G.push(-Q/4-_/2)}if(x-H>=Gf.TO){var _=l(x-H);G.push(-Q/4+_/2),G.push(-Q/4-_/2)}}}}return G},yc.$54l=function(){var o=new Array;if(3==this.$50l()){var s=this.co[3],J=this.co[2]/s,h=this.co[1]/s,V=this.co[0]/s,M=(3*h-J*J)/3,j=(2*J*J*J-9*h*J+27*V)/27,_=J/3,$=j*j/4+M*M*M/27,C=j/2;if(r($)<=Gf.TO&&($=0),$>0){var f,K,e=l($);f=-C+e,K=f>=0?g(f,1/3):-g(-f,1/3),f=-C-e,f>=0?K+=g(f,1/3):K-=g(-f,1/3),o.push(K-_)}else if(0>$){var y=l(-M/3),L=w(l(-$),-C)/3,H=Z(L),p=A(L),D=l(3);o.push(2*y*H-_),o.push(-y*(H+D*p)-_),o.push(-y*(H-D*p)-_)}else{var f;f=C>=0?-g(C,1/3):g(-C,1/3),o.push(2*f-_),o.push(-f-_)}}return o};var Ak=function(Z,V){arguments.length>0&&this.$58l(Z,V)},Pp=Ak.prototype;Pp.$58l=function(F,Z){this.x=F,this.y=Z},Pp.length=function(){return l(this.x*this.x+this.y*this.y)},Pp.$60l=function(r){return this.x*r.x+this.y*r.y};var Qh=function(R,Q,A,j){var O,u=(j.x-A.x)*(R.y-A.y)-(j.y-A.y)*(R.x-A.x),z=(Q.x-R.x)*(R.y-A.y)-(Q.y-R.y)*(R.x-A.x),G=(j.y-A.y)*(Q.x-R.x)-(j.x-A.x)*(Q.y-R.y);if(0!=G){var L=u/G,D=z/G;L>=0&&1>=L&&D>=0&&1>=D?(O=new xo(Y),O.points.push(new Sp(R.x+L*(Q.x-R.x),R.y+L*(Q.y-R.y)))):O=new xo(J)}else O=0==u||0==z?new xo("C"):new xo("P");return O},gs=function(U,m,d,q,I){var D,u,C,W,O,P,L,M=q.min(I),r=q.max(I),X=new xo(J);D=m.$55l(-2),C=U.add(D.add(d)),D=U.$55l(-2),u=m.$55l(2),W=D.add(u),O=new Sp(U.x,U.y),L=new Ak(q.y-I.y,I.x-q.x),P=q.x*I.y-I.x*q.y;for(var f=new Gf(L.$60l(C),L.$60l(W),L.$60l(O)+P).$51l(),v=0;v<f.length;v++){var e=f[v];if(e>=0&&1>=e){var E=U.lerp(m,e),K=m.lerp(d,e),Q=E.lerp(K,e);q.x==I.x?M.y<=Q.y&&Q.y<=r.y&&(X.$62l=Y,X.$56l(Q)):q.y==I.y?M.x<=Q.x&&Q.x<=r.x&&(X.$62l=Y,X.$56l(Q)):Q.gte(M)&&Q.lte(r)&&(X.$62l=Y,X.$56l(Q))}}return X},pc=function(p,k,j,c,U){var R=c.min(U),a=c.max(U),X=new Sp(a.x,R.y),N=new Sp(R.x,a.y),r=gs(p,k,j,R,X),e=gs(p,k,j,X,a),i=gs(p,k,j,a,N),y=gs(p,k,j,N,R),n=new xo(J);return n.$57l(r.points),n.$57l(e.points),n.$57l(i.points),n.$57l(y.points),n.points.length>0&&(n.$62l=Y),n},Xb=function(y,D,v,p,T,M){var x,d,m,Z,Q,B,U,r,g,E,t=T.min(M),o=T.max(M),N=new xo(J);x=y.$55l(-1),d=D.$55l(3),m=v.$55l(-3),Z=x.add(d.add(m.add(p))),Q=new Ak(Z.x,Z.y),x=y.$55l(3),d=D.$55l(-6),m=v.$55l(3),Z=x.add(d.add(m)),B=new Ak(Z.x,Z.y),x=y.$55l(-3),d=D.$55l(3),m=x.add(d),U=new Ak(m.x,m.y),r=new Ak(y.x,y.y),E=new Ak(T.y-M.y,M.x-T.x),g=T.x*M.y-M.x*T.y;for(var i=new Gf(E.$60l(Q),E.$60l(B),E.$60l(U),E.$60l(r)+g).$51l(),F=0;F<i.length;F++){var n=i[F];if(n>=0&&1>=n){var f=y.lerp(D,n),L=D.lerp(v,n),k=v.lerp(p,n),w=f.lerp(L,n),c=L.lerp(k,n),h=w.lerp(c,n);T.x==M.x?t.y<=h.y&&h.y<=o.y&&(N.$62l=Y,N.$56l(h)):T.y==M.y?t.x<=h.x&&h.x<=o.x&&(N.$62l=Y,N.$56l(h)):h.gte(t)&&h.lte(o)&&(N.$62l=Y,N.$56l(h))}}return N},id=function(G,r,k,N,b,d){var g=b.min(d),E=b.max(d),R=new Sp(E.x,g.y),e=new Sp(g.x,E.y),m=Xb(G,r,k,N,g,R),y=Xb(G,r,k,N,R,E),$=Xb(G,r,k,N,E,e),M=Xb(G,r,k,N,e,g),s=new xo(J);return s.$57l(m.points),s.$57l(y.points),s.$57l($.points),s.$57l(M.points),s.points.length>0&&(s.$62l=Y),s},pj=function(G,D,b,O){var Q=b.min(O),C=b.max(O),d=new Sp(C.x,Q.y),q=new Sp(Q.x,C.y),Z=Qh(Q,d,G,D),n=Qh(d,C,G,D),P=Qh(C,q,G,D),z=Qh(q,Q,G,D),r=new xo(J);return r.$57l(Z.points),r.$57l(n.points),r.$57l(P.points),r.$57l(z.points),r.points.length>0&&(r.$62l=Y),r},Uf=V.XEditInteractor=function(D){var r=this,k=r._view=document.createElement("canvas");k.className="editCanvas",k.style.position="absolute",Uf.superClass.constructor.call(r,D)};v.def(Uf,V.Interactor,{ms_edit:1,setUp:function(){var B=this,R=B.gv,K=R.getView(),S=B._view;Uf.superClass.setUp.call(B),R.setEditInteractor(B),R.$14l=S,R._79O?K.insertBefore(S,R._79O):K.appendChild(S);var D=B.$49l=B.$11l.bind(B);R.dm().md(D),R.sm().ms(D),R.mp(D)},tearDown:function(){var U=this,y=U.gv,F=y.getView(),b=U.$49l;Uf.superClass.tearDown.call(U),y.setEditInteractor(n),y.$14l=n,F.removeChild(U._view),y.dm().umd(b),y.sm().ums(b),y.ump(b)},clear:function(){var I=this,b=I.gv;delete I._hoverSegmentIndex,delete I._edge,delete I._shape,delete b._editing,delete I.$10l,delete I.$13l,delete I.$9l,delete I._removePointIndex,delete I._lp,I.$12l="",delete I.$40l,delete I.$67l,delete I.$72l,delete I.$73l,delete I.$75l,delete I.$1l,delete I.$3l,delete I.$2l,delete I.$92l,delete I.$93l,delete I.$94l,I.clearDragging()},handle_keydown:function(w){this.$48l!==w.shiftKey&&(this.$48l=w.shiftKey,this.handle_mousemove(w,b,!0))},handle_keyup:function(x){this.$48l!==x.shiftKey&&(this.$48l=x.shiftKey,this.handle_mousemove(x,b,!0))},handle_touchstart:function(h){this.handle_mousemove(h),this.handle_mousedown(h)},handle_mousedown:function(z){L(z);var T=this,t=T.$13l,W=T.gv,D=W.dm(),h=W.sm(),O=W.getZoom(),M=W.lp(z),n=v.isDoubleClick(z),g=v.isLeftButton(z),K=T.$7l,u=T._shape,I=T._hoverSegmentIndex,j=T._edge,V=T.$87l,w=T.$88l,R=function(){T._68I||V===T.$87l&&w===T.$88l||T.$43l()};if(7!==T.$67l&&(delete T.$87l,delete T.$88l),g&&(u||j)&&I>=0&&n&&(u&&h.contains(u)||j&&h.contains(j))){var S=_n.call(T,u||j,I,M);return T.addShapePoint(u||j,I,S),i(function(){T.handle_mousemove(z)},40),void 0}if(g&&(u||j)&&T._removePointIndex>=0&&n)return T.removeShapePoint(),T.$5l=1,i(function(){T.handle_mousemove(z)},40),void 0;if(!g||!W._editing)return R(),void 0;if(u&&t>=0){var r=u.getPoints().get(t),Y=u.p(),P=tr(Y,r.x-Y.x,r.y-Y.y,-K+u.getRotation());e=tr(Y,M.x-Y.x,M.y-Y.y,-K),T.$24l={x:e.x-P.x,y:e.y-P.y},T.startDragging(z),D.beginTransaction(),T.fi({kind:"beginEditPoint",event:z,data:u,index:t}),T.$88l=t,T.$87l=u}else if(T.$10l){var $=W.sm().getSelection(),l=T.$6l,p=T.$1l={},F=T.$3l={},q=T.$16l[_[T.$10l]],d={x:l.x,y:l.y},s={x:l.x+l.width/2,y:l.y+l.height/2};T.$24l={x:M.x-q.x/O,y:M.y-q.y/O},T.$2l=C(T.$8l),T.$4l=C(l),$.each(function(u){if(u instanceof Q){var x=u.p(),g=u.getWidth(),B=u.getHeight(),o=tr(s,x.x-s.x,x.y-s.y,-K);p[u.getId()]={x:x.x-g/2,y:x.y-B/2,width:g,height:B},F[u.getId()]={x:(o.x-d.x)/l.width,y:(o.y-d.y)/l.height}}}),T.startDragging(z),D.beginTransaction(),T.fi({kind:"beginEditRect",event:z,direction:T.$10l})}else if(j&&t>=0){var E=lq(W.getDataUI(j),j.s("edge.points")),r=E.get(t);T.$24l={x:M.x-r.x,y:M.y-r.y},T.startDragging(z),D.beginTransaction(),T.fi({kind:"beginEditPoint",event:z,data:j,index:t}),T.$88l=t,T.$87l=j}else if(T.$40l){var l=T.$6l,s={x:l.x+l.width/2,y:l.y+l.height/2},x=C(T.$23l);x.x/=O,x.y/=O;var o=tr(s,x.x-s.x,x.y-s.y,-K),e=tr(s,M.x-s.x,M.y-s.y,-K);T.$24l={x:e.x-o.x,y:e.y-o.y},T.startDragging(z),D.beginTransaction(),T.fi({kind:"beginEditRotation",event:z,data:T._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(T.$67l)>=0){var b=T.$67l;(7===b||8===b||9===b)&&D.beginTransaction(),T.startDragging(z)}else if(T.$71l&&n&&T.$79l(T.$71l,M)){var G=h.toSelection();D.beginTransaction(),G.each(function(n){D.remove(n)}),D.endTransaction()}R()},$11l:function(){var M=this,J=M.gv;J._editing&&(M.$13l==n||M._shape==n&&M._edge==n)&&(M.$73l==n||1!==M.$67l&&5!==M.$67l&&6!==M.$67l)||(M.$5l=1),M._68I=1},$46l:function(P){var q=this,g=q.gv,$=g.lp(P),C=[];return Ee(g,function(L){var t=g.getDataUI(L);if(t){var q=t._79o();H(q,$)&&C.push(L)}}),C},$47l:function(H){var n=this,N=n.$13l,Y=n.gv.dm();n.$10l?(n.fi({kind:"endEditRect",event:H,direction:n.$10l}),Y.endTransaction()):n._shape&&N>=0?(n.fi({kind:"endEditPoint",event:H,data:n._shape,index:N}),Y.endTransaction()):n._edge&&N>=0?(n.fi({kind:"endEditPoint",event:H,data:n._edge,index:N}),Y.endTransaction()):n.$23l&&n.$40l&&(n.fi({kind:"endEditRotation",event:H}),Y.endTransaction())},handleWindowTouchEnd:function(P){this.handleWindowMouseUp(P)},handleWindowMouseUp:function(C){var r=this,H=r.gv,F=H.dm(),p=r._shape,w=r._edge,P=r.$13l,X=r.$40l,L=r.$9l,$=r.$10l,A=r.$67l;if((p||w)&&P>=0&&L>=0){var E,Y;if(p){var T=p.p(),z=p.getRotation();E=p.getPoints(),Y=E.get(L),cj(p,T,z,P,Y,!1)}else if(E=lq(H.getDataUI(w),w.s("edge.points"),!0),Y=E.get(L),0===P){var S=E.get(0);w.s("edge.source.offset.x",Y.x-S.x),w.s("edge.source.offset.y",Y.y-S.y)}else if(P===E.size()-1){var i=E.get(E.size()-1);w.s("edge.target.offset.x",Y.x-i.x),w.s("edge.target.offset.y",Y.y-i.y)}else"points"===w.s("edge.type")&&(E.set(P,Y),w.s("edge.points",Vd(E)))}r.$47l(C);var R=r.$73l;1===A?(F.beginTransaction(),R?H.sm().each(function(b){if(b.setHost&&H.isHelperEditable(b,"host")){b.setHost(R);
var Z=r.$75l,I=r.$74l;Z&&(b.s("attach.row.index",Z.rowIndex),b.s("attach.column.index",Z.columnIndex)),I&&(b.s("attach.index",I.attachIndex),b.s("attach.offset",I.attachOffset),b.s("attach.offset.relative",!1),b.s("attach.offset.opposite",!1))}}):H.sm().each(function(f){f.setHost&&H.isHelperEditable(f,"host")&&(f.setHost(n),f.s("attach.row.index",b),f.s("attach.column.index",b),f.s("attach.index",b),f.s("attach.offset",b),f.s("attach.offset.relative",!1),f.s("attach.offset.opposite",!1))}),F.endTransaction()):2===A?(F.beginTransaction(),R?H.sm().each(function(J){J.setParent&&H.isHelperEditable(J,"parent")&&J.setParent(R)}):H.sm().each(function(e){e.setParent&&H.isHelperEditable(e,"parent")&&e.setParent(n)}),F.endTransaction()):3===A?R&&(F.beginTransaction(),H.sm().each(function(A){if(H.isHelperEditable(A,"edge")&&A instanceof Q&&R instanceof Q){var s=new c.Edge;F.add(s),s.setSource(A),s.setTarget(R),r.onEdgeCreated&&r.onEdgeCreated(C,s)}}),F.endTransaction()):5===A||6===A?R&&(F.beginTransaction(),H.sm().each(function(I){I instanceof o&&R instanceof Q&&(5===A&&H.isHelperEditable(I,"source")?I.setSource(R):6===A&&H.isHelperEditable(I,"source")&&I.setTarget(R))}),F.endTransaction()):(7===A||8===A||9===A)&&F.endTransaction(),($||X)&&r.$43l(!0),M?(r.clear(),delete r.$64l,r._68I||r.$43l()):(r.handle_mousemove(C,!0),A&&!r._68I&&r.$43l())},handleWindowTouchMove:function(u){this.handleWindowMouseMove(u)},handleWindowMouseMove:function(l){this._78I(l)},handle_mousemove:function(W,d,w){if(!this._pause){if(!w){var D=M?hq(W):W;this.$61l={clientX:D.clientX,clientY:D.clientY}}if(d===!0||!T()){var r=this,L=r.gv,G=!1,V=n;r.clear(),L.sm().size()>0&&(V=L.lp(w?r.$61l:W),G=r._79I(W,V)),G&&(L._editing=1),r.$12l!==r.$65l&&(r.$65l=r.$12l,r.setCursor(r.$12l)),r.$40l!==r.$64l&&(r.$64l=r.$40l,r._68I||r.$43l()),r._hoverSegmentIndex!==r.$66l&&(r.$66l=r._hoverSegmentIndex,r._68I||r.$43l())}}},_78I:function(q){this.autoScroll(q);var p=this,e=p.gv,b=e.lp(q),U=e.getZoom(),j=p.$13l;if((p._shape||p._edge)&&j>=0){var V,B,C,S=p._shape,h=p._edge,P=p.$24l,u=e.getPointSnapSpacing(),R=function(S,A){return u==n||isNaN(u)?{x:S,y:A}:{x:W(S/u)*u,y:W(A/u)*u}};if(S){V=S.getPoints();var s=S.p(),_=S.getRotation(),A=0;B=tr(s,b.x-s.x,b.y-s.y,-_),cj(S,s,_,j,b,!0,P,R),p.fi({kind:"betweenEditPoint",event:q,data:S,index:j})}else if(h){V=lq(e.getDataUI(h),h.s("edge.points"),!0),b.x-=P.x,b.y-=P.y,B=b;var f,$,t=h.s("edge.offset"),N=V.size(),g=N>2;if(0===j){var M=V.get(0);t&&(M=rq(M,V.get(1),-t,g),b=rq(b,V.get(1),-t,g)),f=b.x-M.x,$=b.y-M.y,C=R(f,$),h.s("edge.source.offset.x",C.x),h.s("edge.source.offset.y",C.y)}else if(j===N-1){var d=V.get(N-1);t&&(d=rq(d,V.get(N-2),-t,g),b=rq(b,V.get(N-2),-t,g)),f=b.x-d.x,$=b.y-d.y,C=R(f,$),h.s("edge.target.offset.x",C.x),h.s("edge.target.offset.y",C.y)}else"points"===h.s("edge.type")&&(C=R(b.x,b.y),C.e=V.get(j).e,V.set(j,C),h.s("edge.points",Vd(V)));p.fi({kind:"betweenEditPoint",event:q,data:h,index:j})}if(delete p.$9l,e.isSnapPoint(S)||e.isSnapPoint(h))for(A=0;A<V.size();A++)if(A!==j){var T=V.get(A);if(a(T,B)<e.getEditPointSize()/U){p.$9l=A;break}}}else if(p.$10l){var P=p.$24l;b.x-=P.x,b.y-=P.y;var D=e.sm().getSelection(),J=p.$1l,Y=p.$7l,X=p.$10l,O=p.$4l,G=p.$2l,K=e.getEditRectPadding()/U,z=2*K,Z=e.getSnapSpacing(),E=Z!=n&&!isNaN(Z),L=Dg(G,b,X,Y,2*K,e.getResizeMode(),E,!0),H=p.$6l;if(E){var I=L.width-z,y=L.height-z,c=W(I/Z)*Z,Mo=W(y/Z)*Z,Sn=c-I,Uq=Mo-y;("west"===X||"northwest"===X||"southwest"===X)&&(Sn=-Sn),("north"===X||"northwest"===X||"northeast"===X)&&(Uq=-Uq),L=Dg(G,b,X,Y,2*K,e.getResizeMode(),E,!1,Sn,Uq)}p.$8l=L,H.x=L.x+K,H.y=L.y+K,H.width=L.width-z,H.height=L.height-z;var Hp=L.x+L.width/2,wo=L.y+L.height/2,Bk=H.x,Mm=H.y,vd=H.width/O.width,Zr=H.height/O.height;D.each(function(h){if(h instanceof Q&&e.isEditable(h)&&e.isRectEditable(h)){var N=J[h.getId()],E=p.$3l[h.getId()],L={x:N.x+N.width/2,y:N.y+N.height/2},k=0,B=0,f=X,d=180*r(Y-h.getRotation())/F;"northeast"===X?d>=315||45>d?(k=N.width*vd+N.x,B=N.height*(1-Zr)+N.y,f="northeast"):d>=45&&135>d?(k=N.width*(1-Zr)+N.x,B=N.height*(1-vd)+N.y,f="northwest"):d>=135&&225>d?(k=N.width*(1-vd)+N.x,B=N.height*Zr+N.y,f="southwest"):(k=N.width*Zr+N.x,B=N.height*vd+N.y,f="southeast"):"north"===X?d>=315||45>d?(B=N.height*(1-Zr)+N.y,f="north"):d>=45&&135>d?(k=N.width*(1-Zr)+N.x,f="west"):d>=135&&225>d?(B=N.height*Zr+N.y,f="south"):(k=N.width*Zr+N.x,f="east"):"northwest"===X?d>=315||45>d?(k=N.width*(1-vd)+N.x,B=N.height*(1-Zr)+N.y,f="northwest"):d>=45&&135>d?(k=N.width*(1-Zr)+N.x,B=N.height*vd+N.y,f="southwest"):d>=135&&225>d?(k=N.width*vd+N.x,B=N.height*Zr+N.y,f="southeast"):(k=N.width*Zr+N.x,B=N.height*(1-vd)+N.y,f="northeast"):"west"===X?d>=315||45>d?(k=N.width*(1-vd)+N.x,f="west"):d>=45&&135>d?(B=N.height*vd+N.y,f="south"):d>=135&&225>d?(k=N.width*vd+N.x,f="east"):(B=N.height*(1-vd)+N.y,f="north"):"southwest"===X?d>=315||45>d?(k=N.width*(1-vd)+N.x,B=N.height*Zr+N.y,f="southwest"):d>=45&&135>d?(k=N.width*Zr+N.x,B=N.height*vd+N.y,f="southeast"):d>=135&&225>d?(k=N.width*vd+N.x,B=N.height*(1-Zr)+N.y,f="northeast"):(k=N.width*(1-Zr)+N.x,B=N.height*(1-vd)+N.y,f="northwest"):"east"===X?d>=315||45>d?(k=N.width*vd+N.x,f="east"):d>=45&&135>d?(B=N.height*(1-vd)+N.y,f="north"):d>=135&&225>d?(k=N.width*(1-vd)+N.x,f="west"):(B=N.height*vd+N.y,f="south"):"south"===X?d>=315||45>d?(B=N.height*Zr+N.y,f="south"):d>=45&&135>d?(k=N.width*Zr+N.x,f="east"):d>=135&&225>d?(B=N.height*(1-Zr)+N.y,f="north"):(k=N.width*(1-Zr)+N.x,f="west"):"southeast"===X&&(d>=315||45>d?(k=N.width*vd+N.x,B=N.height*Zr+N.y,f="southeast"):d>=45&&135>d?(k=N.width*Zr+N.x,B=N.height*(1-vd)+N.y,f="northeast"):d>=135&&225>d?(k=N.width*(1-vd)+N.x,B=N.height*(1-Zr)+N.y,f="northwest"):(k=N.width*(1-Zr)+N.x,B=N.height*vd+N.y,f="southwest"));var O=tr(L,k-L.x,B-L.y,h.getRotation());cr(h,N,f,{x:O.x,y:O.y});var c=Bk+H.width*E.x,z=Mm+H.height*E.y,l={x:c,y:z};l=tr({x:Hp,y:wo},l.x-Hp,l.y-wo,Y),h.p(l.x,l.y)}}),p.fi({kind:"betweenEditRect",event:q,direction:X})}else if(p.$23l&&p.$40l){var rl=p.$8l,Zh=rl.width,rd=rl.height,s={x:rl.x+Zh/2,y:rl.y+rd/2},P=p.$24l,ur=p.$23l,ve=ur.x/U-s.x,Bj=ur.y/U-s.y,sf=l(ve*ve+Bj*Bj),Lg=Math.asin(P.x/sf),Lk=e.sm().getSelection(),Jo=x+w(b.y-s.y,b.x-s.x)-Lg,Dc=e.getSnapAngle(),Jo=W(Jo/Dc)*Dc;0>Jo&&(Jo+=m);var Sq=Jo-p.$7l,Yq=[s.x,0,s.y];Lk.each(function(K){if(e.isEditable(K)&&e.isRotationEditable(K)&&e.isVisible(K)){var $=Sb(K.p3(),Yq),l=_o();_h(l,-Sq),K.setRotation(K.getRotation()+Sq),fi($,l),K.p3(Yq[0]+$[0],Yq[1]+$[1],Yq[2]+$[2])}}),p.$7l=Jo,p.fi({kind:"betweenEditRotation",event:q})}else if([1,2,3,5,6].indexOf(p.$67l)>=0)p.$72l=q,p.$78l||(p.$78l=1,i(function(){v.isDragging()&&p.$43l(),delete p.$78l},12));else if(7===p.$67l){if(p.$87l instanceof k){var S=p.$87l,jn=p.$88l,jg=v.clone(S.getPoints().get(jn)),sg=b.y-jg.y;jg.e||(jg.e=0),p.$92l||(p.$92l=jg.e),jg.e=p.$92l-sg,S.setPoint(jn,jg)}else if(p.$87l instanceof o){var h=p.$87l,jn=p.$88l,V=lq(e.getDataUI(h),h.s("edge.points")),jg=V.get(jn),sg=b.y-jg.y;jg.e||(jg.e=0),p.$92l||(p.$92l=jg.e),jg.e=p.$92l-sg,V.set(jn,jg),h.s("edge.points",Vd(V))}}else if(8===p.$67l){var Lk=e.sm().getSelection(),Sm=p.$93l;Sm||(Sm=p.$93l={}),Lk.each(function(Q){if(Q.p3){var T=Q.p3(),w=Sm[Q.getId()];w==n&&(w=Sm[Q.getId()]=T[1]),Q.p3([T[0],w-(b.y-p.$90l.y/U),T[2]])}})}else if(9===p.$67l){var Lk=e.sm().getSelection(),ul=p.$94l;ul||(ul=p.$94l={}),Lk.each(function(z){if(z.s3){var g=z.s3(),h=ul[z.getId()];h==n&&(h=ul[z.getId()]=g[1]);var L=h-(b.y-p.$91l.y/U);0>L&&(L=.01),z.s3([g[0],L,g[2]])}})}},$79l:function(V,i){var u=this,G=u.gv,e=G.getZoom(),U=G.getEditHelperSize(),n=V.x/e,R=V.y/e,C=U/e,T=C/2;return H({x:n-T,y:R-T,width:C,height:C},i)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(X,n){for(var f=this,u=f.gv,q=u.getZoom(),Q=u.getEditPointSize(),P=Q/q,D=P/2,K=f.$46l(X),T=0;T<K.length;T++){var h,c,x=K[T],Y=u.getDataUI(x);if(Y&&Y._55O){var U=Y._55O;if(U._43O&&x instanceof o){if(h=x.s("edge.points"),h=lq(Y,h),c=x.s("edge.segments"),c&&c.size()||(c=Ah(h)),f.$42l(x,n,h._as,c,"edge"))return!0;if("points"===x.s("edge.type")&&f.$41l(x,n,h._as,c,"edge"))return}if(U._43O&&x instanceof k&&U.$15l&&U.$15l.length===x.getPoints().size()){if(h=U.$15l,c=x.getSegments(),c&&c.size()||(c=Ah(h)),f.$42l(x,n,h,c,"shape"))return!0;if(f.$41l(x,n,h,c,"shape"))return}}}if(f.$16l){var h,R=f.$16l,z=R[3].x-R[7].x,s=R[3].y-R[7].y,W=l(z*z+s*s),I=R[1].x-R[5].x,$=R[1].y-R[5].y,E=l(I*I+$*$),a={x:n.x*q,y:n.y*q};if(f._80I(a,0,R[0],"northwest",W,E)||f._80I(a,1,R[1],"north",W,E)||f._80I(a,2,R[2],"northeast",W,E)||f._80I(a,7,R[7],"west",W,E)||f._80I(a,3,R[3],"east",W,E)||f._80I(a,6,R[6],"southwest",W,E)||f._80I(a,5,R[5],"south",W,E)||f._80I(a,4,R[4],"southeast",W,E))return!0}if(f.$23l){var S=f.$23l,J=S.x/q,j=S.y/q;if(H({x:J-D,y:j-D,width:P,height:P},n))return f.$40l=1,f.$12l=f.getHelperCursor("rotation")||"crosshair",!0}return f.$68l&&f.$79l(f.$68l,n)?(f.$67l=1,f.$12l=f.getHelperCursor("host")||"crosshair",!0):f.$69l&&f.$79l(f.$69l,n)?(f.$67l=2,f.$12l=f.getHelperCursor("parent")||"crosshair",!0):f.$70l&&f.$79l(f.$70l,n)?(f.$67l=3,f.$12l=f.getHelperCursor("edge")||"crosshair",!0):f.$71l&&f.$79l(f.$71l,n)?(f.$67l=4,f.$12l=f.getHelperCursor("remove")||"crosshair",!0):f.$82l&&f.$79l(f.$82l,n)?(f.$67l=5,f.$12l=f.getHelperCursor("source")||"crosshair",!0):f.$83l&&f.$79l(f.$83l,n)?(f.$67l=6,f.$12l=f.getHelperCursor("target")||"crosshair",!0):f._pointElevationHelperPoint&&f.$79l(f._pointElevationHelperPoint,n)?(f.$67l=7,f.$12l=f.getHelperCursor("pointElevation")||"crosshair",!0):f.$90l&&f.$79l(f.$90l,n)?(f.$67l=8,f.$12l=f.getHelperCursor("elevation")||"crosshair",!0):f.$91l&&f.$79l(f.$91l,n)?(f.$67l=9,f.$12l=f.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(y,p,m,V,u,K){var $=this,c=$.gv,D=c.getEditPointSize(),W=D/2,h=c.sm(),G=c.isDirectionEditable;if(G&&1===h.size()){var X=h.ld();if(G=G.bind(c),X instanceof Q){if(!G(X,V))return!1;if("east"===V){if(G(X,"northeast")&&G(X,"southeast")&&2*D>=K)return!1}else if("west"===V){if(G(X,"northwest")&&G(X,"southwest")&&2*D>=K)return!1}else if("north"===V){if(G(X,"northwest")&&G(X,"northeast")&&2*D>=u)return!1}else if("south"===V&&G(X,"southwest")&&G(X,"southeast")&&2*D>=u)return!1}}else{if(2*D>=u&&("north"===V||"south"===V))return!1;if(2*D>=K&&("east"===V||"west"===V))return!1}if(H({x:m.x-W,y:m.y-W,width:D,height:D},y)){if($.$10l!==V){var C=180*$.$7l/F,k="";C>=337.5||22.5>C?k="north":C>=22.5&&67.5>C?k="northeast":C>=67.5&&112.5>C?k="east":C>=112.5&&157.5>C?k="southeast":C>=157.5&&202.5>C?k="south":C>=202.5&&247.5>C?k="southwest":C>=247.5&&292.5>C?k="west":C>=292.5&&337.5>C&&(k="northwest");var Z=Cj.indexOf(k),k=Cj[p-(1-Z)+8];switch(k){case"northwest":$.$12l="nwse-resize";break;case"northeast":$.$12l="nesw-resize";break;case"southwest":$.$12l="nesw-resize";break;case"southeast":$.$12l="nwse-resize";break;case"north":$.$12l="ns-resize";break;case"east":$.$12l="ew-resize";break;case"south":$.$12l="ns-resize";break;case"west":$.$12l="ew-resize"}$.$10l=V}return!0}return!1},$42l:function(m,X,K,$,Z){var k,n=this,T=n.gv,o=T.getEditPointSize(),A=o/T.getZoom(),R=-1,B={x:X.x,y:X.y,width:0,height:0},M=function(L){"shape"===Z?n._shape=m:n._edge=m,n._removePointIndex=L},O=function(t){"shape"===Z?n._shape=m:n._edge=m,n.$13l=t,n.$12l="crosshair"};for(u(B,A/2),R=K.length-1,k=$.size()-1;k>=0;k--){var l=$.get(k);if(1===l||2===l)R-=1;else if(3===l){var x=K[R-1];if(H(B,x))return O(R-1),!0;R-=2}else if(4===l){var Q=K[R-1],q=K[R-2];if(H(B,Q))return O(R-1),!0;if(H(B,q))return O(R-2),!0;R-=3}}for(R=K.length-1,k=$.size()-1;k>=0;k--){var l=$.get(k),p=K[R];if(H(B,p))return M(R),O(R),!0;1===l||2===l?R-=1:3===l?R-=2:4===l&&(R-=3)}return!1},$41l:function(b,x,T,V,y){var c=this,j=c.gv,F=-1,W=0,L={x:x.x,y:x.y,width:0,height:0},w=function(S,C){c._hoverSegmentIndex=C,c._lp=x,"shape"===y?c._shape=b:c._edge=b};for(u(L,j.getSegmentHoverWidth()/2/j.getZoom()),b instanceof k&&b.isClosePath()&&V.indexOf(5)<0&&(V=new G(V._as),V.add(5));W<V.size();W++){var $=V.get(W);if(1===$){var m=T[F],f=T[F+1];if(m){var C=pj(new Sp(m.x,m.y),new Sp(f.x,f.y),new Sp(L.x,L.y),new Sp(L.x+L.width,L.y+L.height));if(C.$62l===Y&&C.points.length>0)return w(C,W),!0}F+=1}else if(2===$){var m=T[F],f=T[F+1],C=pj(new Sp(m.x,m.y),new Sp(f.x,f.y),new Sp(L.x,L.y),new Sp(L.x+L.width,L.y+L.height));if(C.$62l===Y&&C.points.length>0)return w(C,W),!0;F+=1}else if(3===$){var m=T[F],I=T[F+1],h=T[F+2],C=pc(new Sp(m.x,m.y),new Sp(I.x,I.y),new Sp(h.x,h.y),new Sp(L.x,L.y),new Sp(L.x+L.width,L.y+L.height));if(C.$62l===Y)return w(C,W),!0;F+=2}else if(4===$){var m=T[F],H=T[F+1],X=T[F+2],h=T[F+3],C=id(new Sp(m.x,m.y),new Sp(H.x,H.y),new Sp(X.x,X.y),new Sp(h.x,h.y),new Sp(L.x,L.y),new Sp(L.x+L.width,L.y+L.height));if(C.$62l===Y)return w(C,W),!0;F+=3}else if(5===$){var m=T[F],f=T[0];if(m){var C=pj(new Sp(m.x,m.y),new Sp(f.x,f.y),new Sp(L.x,L.y),new Sp(L.x+L.width,L.y+L.height));if(C.$62l===Y&&C.points.length>0)return w(C,W),!0}}}return!1},addShapePoint:function(e,t,D){var d=this,A=d.gv,E=A.dm();if(E.beginTransaction(),0===arguments.length&&(e=d._shape||d._edge,t=d._hoverSegmentIndex,D=d._lp),e instanceof k||e instanceof o){var Q=xg(e,A.getDataUI(e),t);if(!isNaN(t)&&D&&!isNaN(Q)){var M=D;if(e instanceof k){var p=e.p(),j=e.getRotation(),Y=e.toSegments();Y&&Y.size()||(Y=Ah(e.getPoints())),e.isClosePath()&&Y.indexOf(5)<0&&(Y=new G(Y._as),Y.add(5));var b=Y.get(t),v="addPoint",H="removePointAt";if(2===b||1===b){var L={x:M.x,y:M.y};Y.add(b,t),L=tr(p,L.x-p.x,L.y-p.y,-j),e[v](L,Q+1)}else if(3===b){var h=e.getPoints(),C=h.get(Q),O=h.get(Q+2),L={x:M.x,y:M.y};L=tr(p,L.x-p.x,L.y-p.y,-j);var _=ln(C,L),x=ln(L,O);Y.removeAt(t),Y.add(3,t),Y.add(3,t),e.setPoint(Q+1,L),e[v](x,Q+2),e[v](_,Q+1)}else if(4===b){var h=e.getPoints(),C=h.get(Q),O=h.get(Q+3),L={x:M.x,y:M.y};L=tr(p,L.x-p.x,L.y-p.y,-j);var _=Bs(C,L),x=Rd(C,L),y=Bs(L,O),Z=Rd(L,O);Y.removeAt(t),Y.add(4,t),Y.add(4,t),e[H](Q+1),e[H](Q+1),e[v](L,Q+1),e[v](Z,Q+2),e[v](y,Q+2),e[v](x,Q+1),e[v](_,Q+1)}else if(5===b){var L={x:M.x,y:M.y};Y.add(2,t),L=tr(p,L.x-p.x,L.y-p.y,-j),e[v](L,Q+1)}e.isClosePath()&&Y.remove(5),e.setSegments(Y);var U=e.getWidth(),g=e.getHeight(),m=e.p().x-U/2,R=e.p().y-g/2;m-=p.x,R-=p.y;var l=re(e,{x:m,y:R,width:U,height:g},j,p);e.p(l.x,l.y)}else if(e instanceof o){if("points"!==e.s("edge.type"))return E.endTransaction(),void 0;var h=e.s("edge.points");Y=e.s("edge.segments"),h=lq(A.getDataUI(e),h),Y&&Y.size()||(Y=Ah(h)),Y=new G(Y._as.slice(0)),h=new G(h._as.slice(0));var b=Y.get(t);if(2===b||1===b){var L={x:M.x,y:M.y};Y.add(b,t),h.add(L,Q+1)}else if(3===b){var C=h.get(Q),O=h.get(Q+2),L={x:M.x,y:M.y},_=ln(C,L),x=ln(L,O);Y.removeAt(t),Y.add(3,t),Y.add(3,t),h.set(Q+1,L),h.add(x,Q+2),h.add(_,Q+1)}else if(4===b){var C=h.get(Q),O=h.get(Q+3),L={x:M.x,y:M.y},_=Bs(C,L),x=Rd(C,L),y=Bs(L,O),Z=Rd(L,O);Y.removeAt(t),Y.add(4,t),Y.add(4,t),h.removeAt(Q+1),h.removeAt(Q+1),h.add(L,Q+1),h.add(Z,Q+2),h.add(y,Q+2),h.add(x,Q+1),h.add(_,Q+1)}e.s("edge.points",Vd(h)),e.s("edge.segments",Y)}}}E.endTransaction()},removeShapePoint:function(d,h){var I=this,m="removeAt",u=I.gv,t=u.dm();if(t.beginTransaction(),0===arguments.length&&(d=I._shape||I._edge,h=I._removePointIndex),h>=0&&(d instanceof k||d instanceof o)){var $=kb(d,I.gv.getDataUI(d),h),s=h;if(d instanceof k){var f=d.p(),v=d.toSegments();v&&v.size()||(v=Ah(d.getPoints()));var i=v.get($),l="removePointAt";if(1===i&&0===s)if(d.getPoints().size()>1){var S=v.get($+1);v[m]($+1),3===S?d[l](s+1):4===S&&(d[l](s+2),d[l](s+1)),d[l](s)}else d.dm().remove(d);else 2===i||1===i?(v[m]($),d[l](s)):3===i?(v[m]($),d[l](s),d[l](s-1)):4===i&&(v[m]($),d[l](s),d[l](s-1),d[l](s-2));d.setSegments(v);var N=d.getWidth(),c=d.getHeight(),w=d.p().x-N/2,z=d.p().y-c/2;w-=f.x,z-=f.y;var C=re(d,{x:w,y:z,width:N,height:c},d.getRotation(),f);d.p(C.x,C.y)}else if(d instanceof o){if("points"!==d.s("edge.type"))return t.endTransaction(),void 0;var r=d.s("edge.points");if(v=d.s("edge.segments"),r&&(r=lq(I.gv.getDataUI(d),r),v&&v.size()||(v=Ah(r))),0===h||h===r.size()-1)return t.endTransaction(),void 0;v=new G(v._as.slice(0)),r=new G(r._as.slice(0));var i=v.get($);2===i||1===i?(v[m]($),r[m](s)):3===i?(v[m]($),r[m](s),r[m](s-1)):4===i&&(v[m]($),r[m](s),r[m](s-1),r[m](s-2)),d.s("edge.segments",v),d.s("edge.points",Vd(r))}}t.endTransaction()},changeShapeSegment:function(n,S,m){var B=this,c=B.gv,u=c.dm();if(u.beginTransaction(),1!==arguments.length||isNaN(n)||(m=n,n=B._shape||B._edge,S=B._hoverSegmentIndex),n instanceof k||n instanceof o){var X=xg(n,B.gv.getDataUI(n),S);if(!isNaN(S)&&!isNaN(X))if(n instanceof k){var d=n.p(),M=n.toSegments();M&&M.size()||(M=Ah(n.getPoints()));var r=M.get(S),_=n.toPoints();if(1===m||2===m)1===r||2===r?M.set(S,m):3===r?(M.set(S,m),_.removeAt(X+1)):4===r&&(M.set(S,m),_.removeAt(X+1),_.removeAt(X+1));else if(3===m){var A=function(){var R=_.get(X),i=_.get(X+1),t=ln(R,i);M.set(S,3),_.add(t,X+1)};2===r||1===r?A():4===r&&(_.removeAt(X+1),_.removeAt(X+1),A())}else if(4===m){var w=function(){var o=_.get(X),k=_.get(X+1),i=Bs(o,k),I=Rd(o,k);M.set(S,4),_.add(i,X+1),_.add(I,X+2)};2===r||1===r?w():3===r&&(_.removeAt(X+1),w())}n.setSegments(M),n.setPoints(_);var e=n.getWidth(),x=n.getHeight(),P=n.p().x-e/2,i=n.p().y-x/2;P-=d.x,i-=d.y;var l=new re(n,{x:P,y:i,width:e,height:x},n.getRotation(),d);n.p(l.x,l.y)}else if(n instanceof o){if("points"!==n.s("edge.type"))return u.endTransaction(),void 0;var _=n.s("edge.points");M=n.s("edge.segments"),_&&(_=lq(B.gv.getDataUI(n),_),M&&M.size()||(M=Ah(_))),M=new G(M._as.slice(0)),_=new G(_._as.slice(0));var r=M.get(S);if(1===m||2===m)1===r||2===r?M.set(S,m):3===r?(M.set(S,m),_.removeAt(X+1)):4===r&&(M.set(S,m),_.removeAt(X+1),_.removeAt(X+1));else if(3===m){var A=function(){var L=_.get(X),Y=_.get(X+1),y=ln(L,Y);M.set(S,3),_.add(y,X+1)};2===r||1===r?A():4===r&&(_.removeAt(X+1),_.removeAt(X+1),A())}else if(4===m){var w=function(){var n=_.get(X),I=_.get(X+1),l=Bs(n,I),E=Rd(n,I);M.set(S,4),_.add(l,X+1),_.add(E,X+2)};2===r||1===r?w():3===r&&(_.removeAt(X+1),w())}n.s("edge.points",Vd(_)),n.s("edge.segments",M)}}u.endTransaction()},getDefaultSegments:function(c){var Y=this.gv,p=Y.getDataUI(c);if(c instanceof o){var j=c.s("edge.points");return j=lq(p,j),Ah(j)}if(c instanceof k){var j=c.getPoints(),$=c.getSegments();return $&&$.size()>0?$:Ah(j)}},$43l:function(U){var m=this;U&&(m.$5l=1),m._68I=1,m._42()},_42:function(){var b=this;if(b._68I){delete b._68I;var s=b.gv,j=b.$5l,Y=s.getZoom(),i=s.getEditPointSize(),t=i/2,r=new G,h=b._view,R=b._edge,L=b._shape,U=h.getContext("2d"),N=s.tx(),e=s.ty(),O=n,w=s.getEditPointBackground(),K=s.getControlPointBackground(),Z=s.getControlPointBorderColor(),T=s.getEditPointBorderColor(),H=s.getEditRectBorderColor(),B=s.getDirectionLineColor(),V=s.getSegmentHoverColor(),g=s.getSnapPointBorderColor(),A=s.getJoinPointBackground(),M=s.getJoinPointBorderColor(),$=s.getSegmentHoverWidth(),x=[5,5],F=s.getEditRectBorderStyle();Jq(s,function(E){s.isSelected(E)&&s.isVisible(E)&&r.add(E)}),U.clearRect(0,0,S(h.width),S(h.height)),U.save(),y.translateAndScale(U,N,e,1);var W=n,D={x:0,y:0,width:0,height:0},a=0,J=0,_=0,q=0,I=0,f=0,qm=0,Ji=0,zq=0,jl=0,Fn=[];if(j?(delete b.$6l,delete b.$8l,delete b.$7l,delete b.$16l,delete b.$23l):(W=b.$6l,O=b.$7l),delete b.$68l,delete b.$69l,delete b.$71l,delete b.$70l,delete b.$82l,delete b.$83l,delete b._pointElevationHelperPoint,delete b.$90l,delete b.$91l,delete b.$75l,delete b.$74l,r.each(function(w){var x=s.getDataUI(w);if(x){var e=x._55O;if(s.isEditable(w))e._56O&&w instanceof Q&&J++,Fn.push(w),e._42O&&w instanceof Q&&a++,s.isHelperEditable(w,"host")&&q++,s.isHelperEditable(w,"parent")&&_++,s.isHelperEditable(w,"remove")&&I++,s.isHelperEditable(w,"edge")&&f++,s.isHelperEditable(w,"source")&&qm++,s.isHelperEditable(w,"target")&&Ji++,s.isHelperEditable(w,"elevation")&&zq++,s.isHelperEditable(w,"tall")&&jl++;else if(w instanceof E&&w.isExpanded()){var X=!0,b=s.getEditableFunc();b&&(X=b(w)),X&&(s.isHelperEditable(w,"host")&&q++,s.isHelperEditable(w,"parent")&&_++,s.isHelperEditable(w,"remove")&&I++,s.isHelperEditable(w,"edge")&&f++,s.isHelperEditable(w,"source")&&qm++,s.isHelperEditable(w,"target")&&Ji++,s.isHelperEditable(w,"elevation")&&zq++,s.isHelperEditable(w,"tall")&&jl++,Fn.push(w))}}}),U.beginPath(),U.lineWidth=1,U.strokeStyle=s.getNodeBorderColor(),Fn.forEach(function(r){var M=s.getDataUI(r),R=M._55O;if(j)if(O==n&&(O=r instanceof o?0:r instanceof E&&r.isExpanded()?0:r.getRotation(),b.$7l=O),W==n){var c,H,p;if(r instanceof E&&r.isExpanded()||r instanceof o){var q=s.getDataUIBounds(r);H=q.width,p=q.height,c={x:q.x+H/2,y:q.y+p/2}}else c=r.p(),H=r.getWidth(),p=r.getHeight();W={x:c.x,y:c.y,width:0,height:0},D.x=c.x-H/2,D.y=c.y-p/2,D.width=H,D.height=p,W=P(W,D)}else{var c,H,p,N,e=W.x+W.width/2,y=W.y+W.height/2,T={x:e,y:y};if(r instanceof E&&r.isExpanded()||r instanceof o){N=0;var q=s.getDataUIBounds(r);H=q.width,p=q.height,c={x:q.x+H/2,y:q.y+p/2}}else c=r.p(),H=r.getWidth(),p=r.getHeight(),N=r.getRotation();var K={x:c.x-H/2,y:c.y-p/2,width:H,height:p},G={x:K.x,y:K.y},d={x:K.x+K.width,y:K.y},L={x:K.x,y:K.y+K.height},f={x:K.x+K.width,y:K.y+K.height},G=tr(c,G.x-c.x,G.y-c.y,N),L=tr(c,L.x-c.x,L.y-c.y,N),f=tr(c,f.x-c.x,f.y-c.y,N),d=tr(c,d.x-c.x,d.y-c.y,N),A=-O,J=tr(T,G.x-T.x,G.y-T.y,A),v=tr(T,d.x-T.x,d.y-T.y,A),t=tr(T,L.x-T.x,L.y-T.y,A),B=tr(T,f.x-T.x,f.y-T.y,A),Z=X([J,v,t,B]);W=P(W,Z),W.x-=e,W.y-=y;var i=re(n,W,O,T);W.x=i.x-W.width/2,W.y=i.y-W.height/2}if(a>1&&s.isEditable(r)&&s.isRectEditable(r)&&r instanceof Q){var F=r.getRect(),z=R.$45l,C=be(z[0],Y),w=be(z[2],Y),g=be(z[4],Y),k=be(z[6],Y);r.getRotation()?(U.moveTo(C.x,C.y),U.lineTo(w.x,w.y),U.lineTo(g.x,g.y),U.lineTo(k.x,k.y),U.lineTo(C.x,C.y)):U.rect(F.x*Y,F.y*Y,F.width*Y,F.height*Y)}}),U.stroke(),W){b.$6l=C(W),u(W,s.getEditRectPadding()/Y);var Me={x:W.x+W.width/2,y:W.y+W.height/2},eo=Kg(Me,W.width,W.height,O),Gm=eo[0],Kp=eo[1],md=eo[2],ai=eo[3],os=eo[4],kh=eo[5],rm=eo[6],Sm=eo[7];if(Gm=be(eo[0],Y),Kp=be(eo[1],Y),md=be(eo[2],Y),ai=be(eo[3],Y),os=be(eo[4],Y),kh=be(eo[5],Y),rm=be(eo[6],Y),Sm=be(eo[7],Y),b.$8l=W,a>0&&(b.$16l=[Gm,os,Kp,kh,ai,rm,md,Sm],U.beginPath(),U.lineWidth=1,U.strokeStyle=H,"dashed"===F&&U.setLineDash&&U.setLineDash(x),U.moveTo(Gm.x,Gm.y),U.lineTo(Kp.x,Kp.y),U.lineTo(ai.x,ai.y),U.lineTo(md.x,md.y),U.lineTo(Gm.x,Gm.y),U.stroke(),"dashed"===F&&U.setLineDash&&U.setLineDash([])),U.beginPath(),U.lineWidth=1,U.fillStyle=w,U.strokeStyle=T,a>0){var lh=kh.x-Sm.x,Br=kh.y-Sm.y,Mh=l(lh*lh+Br*Br),Df=os.x-rm.x,op=os.y-rm.y,ek=l(Df*Df+op*op),me=2*i;if(s.isDirectionEditable&&1===Fn.length){var cf=Fn[0],tm=s.getDataUI(cf),wc=tm._55O,Ao=s.isDirectionEditable.bind(s);if(wc._42O){var zn,Vn,kb,ae;Ao(cf,"northwest")&&(zn=!0,U.rect(Gm.x-t,Gm.y-t,i,i)),Ao(cf,"northeast")&&(Vn=!0,U.rect(Kp.x-t,Kp.y-t,i,i)),Ao(cf,"southwest")&&(kb=!0,U.rect(md.x-t,md.y-t,i,i)),Ao(cf,"southeast")&&(ae=!0,U.rect(ai.x-t,ai.y-t,i,i)),Ao(cf,"north")&&(zn&&Vn?Mh>me&&U.rect(os.x-t,os.y-t,i,i):U.rect(os.x-t,os.y-t,i,i)),Ao(cf,"south")&&(ae&&kb?Mh>me&&U.rect(rm.x-t,rm.y-t,i,i):U.rect(rm.x-t,rm.y-t,i,i)),Ao(cf,"west")&&(kb&&zn?ek>me&&U.rect(Sm.x-t,Sm.y-t,i,i):U.rect(Sm.x-t,Sm.y-t,i,i)),Ao(cf,"east")&&(ae&&Vn?ek>me&&U.rect(kh.x-t,kh.y-t,i,i):U.rect(kh.x-t,kh.y-t,i,i))}}else Mh>me&&(U.rect(os.x-t,os.y-t,i,i),U.rect(rm.x-t,rm.y-t,i,i)),ek>me&&(U.rect(kh.x-t,kh.y-t,i,i),U.rect(Sm.x-t,Sm.y-t,i,i)),U.rect(Gm.x-t,Gm.y-t,i,i),U.rect(Kp.x-t,Kp.y-t,i,i),U.rect(md.x-t,md.y-t,i,i),U.rect(ai.x-t,ai.y-t,i,i)}if(J>0){var uo=b.$23l=tr(os,0,2*-i,O);U.moveTo(uo.x+t,uo.y),U.arc(uo.x,uo.y,t,0,m,!1)}U.fill(),U.stroke(),b.$40l&&b.$44l(U,W,O);var Or,Nr,Bc=s.getLeftTopHelpers(),sd=s.getRightTopHelpers(),Ok=s.getLeftBottomHelpers(),Fr=s.getRightBottomHelpers(),Dg=s.getEdgeHelpers(),Sg=s.getEditHelperSize(),Rm=Sg/2,Yl=function(T,z,M,h){"leftTop"===z?(Or=W.x*Y-Sg-t-("h"===h?M*(Sg+t):0)-1,Nr=W.y*Y-Sg-t-("v"===h?M*(Sg+t):0)-1):"rightTop"===z?(Or=(W.x+W.width)*Y+t+("h"===h?M*(Sg+t):0)+1,Nr=W.y*Y-Sg-t-("v"===h?M*(Sg+t):0)-1):"leftBottom"===z?(Or=W.x*Y-Sg-t-("h"===h?M*(Sg+t):0)-1,Nr=(W.y+W.height)*Y+t+("v"===h?M*(Sg+t):0)+1):"rightBottom"===z&&(Or=(W.x+W.width)*Y+t+("h"===h?M*(Sg+t):0)+1,Nr=(W.y+W.height)*Y+t+("v"===h?M*(Sg+t):0)+1);var d=Or+Rm,V=Nr+Rm,X=(W.x+W.width/2)*Y,E=(W.y+W.height/2)*Y,H=tr({x:X,y:E},d-X,V-E,O);if("host"===T){if(q>0)return b.$77l(U,O,H),!0}else if("edge"===T){if(f>0)return b.$80l(U,O,H),!0}else if("remove"===T){if(I>0)return Fn&&1===Fn.length&&Fn[0]instanceof o?b.$81l(U,O,{x:X+Sg/2+5,y:E}):b.$81l(U,O,H),!0}else if("parent"===T){if(_>0)return Fn&&1===Fn.length&&Fn[0]instanceof o?b.$76l(U,O,{x:X-Sg/2-5,y:E}):b.$76l(U,O,H),!0}else if("elevation"===T){if(zq>0)return b.$85l(U,O,H),!0}else if("tall"===T){if(jl>0)return b.$86l(U,O,H),!0}else if("source"===T||"target"===T){var S=Fn[0],$=s.getDataUI(S),n=Nl($,!0),w=n[0],L=n[1];if(qm&&"source"===T)return b.$84l(U,W,w,!0,S.isLooped(),z,M,h),!0;if(Ji&&"target"===T)return b.$84l(U,W,L,!1,S.isLooped(),z,M,h),!0}};if(Bc&&Bc.length>0){var vs=0;Bc.forEach(function(n){Yl(n,"leftTop",vs,s.getLeftTopHelpersAlign()||"h")&&vs++})}if(sd&&sd.length>0){var vs=0;sd.forEach(function(Z){Yl(Z,"rightTop",vs,s.getRightTopHelpersAlign()||"h")&&vs++})}if(Ok&&Ok.length>0){var vs=0;Ok.forEach(function(P){Yl(P,"leftBottom",vs,s.getLeftBottomHelpersAlign()||"h")&&vs++})}if(Fr&&Fr.length>0){var vs=0;Fr.forEach(function(I){Yl(I,"rightBottom",vs,s.getRightBottomHelpersAlign()||"h")&&vs++})}if(Dg&&Dg.length>0&&((qm||Ji)&&Fn&&1===Fn.length&&Fn[0]instanceof o?!0:!1)){var vs=0;Dg.forEach(function(P){Yl(P,"edge",vs,"h")&&vs++})}if(b.$72l){var zi,Dn=b.$67l,Nk=b.$68l,bd=b.$69l,sm=(b.$71l,b.$70l),Wg=b.$82l,Zk=b.$83l;if(1===Dn?zi=Nk:2===Dn?zi=bd:3===Dn?zi=sm:5===Dn?zi=Wg:6===Dn&&(zi=Zk),zi){var bj=s.lp(b.$72l),jk=s.getDataAt(b.$72l);if(jk&&jk instanceof Q){var Sb,km,nd;if(b.$73l=jk,1===Dn)if(jk instanceof c.Grid)Sb=b.$75l=Dl(jk,bj);else if(jk instanceof c.Shape){nd=b.$74l=Td(jk,bj);var Od=jk.getPoints();if(nd){var qd=nd.attachIndex,lg=xg(jk,s.getDataUI(jk),qd)+1,Qg=lg+1>=Od.size()?0:lg+1,Qq=Od.get(lg),cj=Od.get(Qg),ln=jk.p(),sl=jk.getRotation();Qq=tr(ln,Qq.x-ln.x,Qq.y-ln.y,sl),cj=tr(ln,cj.x-ln.x,cj.y-ln.y,sl),U.beginPath(),U.strokeStyle=V,U.lineWidth=$,U.moveTo(Qq.x*Y,Qq.y*Y),U.lineTo(cj.x*Y,cj.y*Y),U.stroke()}}Sb?km=Sb.rect:(km=v.clone(s.getDataUIBounds(jk)),v.grow(km,2)),U.beginPath(),U.rect(km.x*Y,km.y*Y,km.width*Y,km.height*Y),U.strokeStyle=1===Dn||4===Dn||6===Dn?z:d,U.lineWidth=2,U.setLineDash&&U.setLineDash([8,8]),U.stroke()}else delete b.$73l;bj.x=bj.x*Y,bj.y=bj.y*Y;var Vb=yp(zi.x,zi.y,bj.x,bj.y),Af=tr(zi,bj.x-zi.x,bj.y-zi.y,-Vb),vm=Af.x-zi.x;U.save(),U.translate(zi.x,zi.y),U.rotate(Vb),p.width=vm,p.height=40;var sk=d;(1===Dn||4===Dn||6===Dn)&&(sk=z),p.comps[0].gradientColor=sk,v.drawImage(U,p,0,-20,vm,40),U.restore()}}}if(r.each(function(r){var p=s.getDataUI(r);if(p){var q,F,T=p._55O,N=p._78o;if(T&&T._43O&&r instanceof k?(q=T.$15l,F=r.getSegments(),F&&F.size()||(F=Ah(q)),r.isClosePath()&&F.indexOf(5)<0&&(F=new G(F._as),F.add(5))):T&&N&&T._43O&&(q=r.s("edge.points"),F=r.s("edge.segments"),q=lq(p,q),F&&F.size()||(F=Ah(q)),q&&(q=q._as)),q&&F){var D=0,j=F.size(),P=b._hoverSegmentIndex;q=q.slice(0);for(var v=0;v<q.length;v++)q[v]=be(q[v],Y);U.beginPath(),U.strokeStyle=B,U.lineWidth=1,D=0;for(var v=0;j>v;v++){var x=F.get(v);if(1===x||2===x)D++;else if(3===x){var l=q[D-1],u=q[D],O=q[D+1];U.moveTo(l.x,l.y),U.lineTo(u.x,u.y),U.lineTo(O.x,O.y),D+=2}else if(4===x){var l=q[D-1],W=q[D],S=q[D+1],O=q[D+2];U.moveTo(l.x,l.y),U.lineTo(W.x,W.y),U.moveTo(S.x,S.y),U.lineTo(O.x,O.y),D+=3}}if(U.stroke(),L===r||R===r&&"points"===R.s("edge.type")){U.beginPath(),D=0,U.strokeStyle=V,U.lineWidth=$;for(var v=0;j>v;v++){var x=F.get(v);if(1===x||2===x){if(P===v){var l=q[D-1],O=q[D];U.moveTo(l.x,l.y),U.lineTo(O.x,O.y);break}D++}else if(3===x){if(P===v){var l=q[D-1],u=q[D],O=q[D+1];U.moveTo(l.x,l.y),U.quadraticCurveTo(u.x,u.y,O.x,O.y);break}D+=2}else if(4===x){if(P===v){var l=q[D-1],W=q[D],S=q[D+1],O=q[D+2];U.moveTo(l.x,l.y),U.bezierCurveTo(W.x,W.y,S.x,S.y,O.x,O.y);break}D+=3}else if(5===x&&P===v){var l=q[D-1],O=q[0];U.moveTo(l.x,l.y),U.lineTo(O.x,O.y);break}}U.stroke()}U.beginPath(),D=0,U.strokeStyle=M,U.lineWidth=1,U.fillStyle=A;for(var v=0;j>v;v++){var x=F.get(v);if(1===x||2===x){var O=q[D];U.moveTo(O.x+t,O.y),U.arc(O.x,O.y,t,0,m,!0),D++}else if(3===x){var O=q[D+1];U.moveTo(O.x+t,O.y),U.arc(O.x,O.y,t,0,m,!0),D+=2}else if(4===x){var O=q[D+2];U.moveTo(O.x+t,O.y),U.arc(O.x,O.y,t,0,m,!0),D+=3}}U.fill(),U.stroke(),U.beginPath(),D=0,U.strokeStyle=Z,U.lineWidth=1,U.fillStyle=K;for(var v=0;j>v;v++){var x=F.get(v);if(1===x||2===x)D++;else if(3===x){var u=q[D];U.moveTo(u.x+t,u.y),U.arc(u.x,u.y,t,0,m,!0),D+=2}else if(4===x){var W=q[D],S=q[D+1];U.moveTo(W.x+t,W.y),U.arc(W.x,W.y,t,0,m,!0),U.moveTo(S.x+t,S.y),U.arc(S.x,S.y,t,0,m,!0),D+=3}}if(U.fill(),U.stroke(),U.beginPath(),D=0,U.strokeStyle=g,U.lineWidth=2,(L===r||R===r)&&b.$9l!=n){var O=q[b.$9l];U.moveTo(O.x+t,O.y),U.arc(O.x,O.y,t,0,m,!0),U.stroke()}}}}),b.$87l&&s.sm().contains(b.$87l)){var Tp,Xg=b.$87l,Yg=b.$88l,Sg=s.getEditHelperSize(),Rm=Sg/2;if(s.isHelperEditable(Xg,"pointElevation"))if(Xg instanceof k){var Ui=Xg.getPosition();Tp=v.clone(Xg.getPoints().get(Yg)),Tp=tr({x:Ui.x,y:Ui.y},Tp.x-Ui.x,Tp.y-Ui.y,Xg.getRotation()),Tp.x*=Y,Tp.y*=Y,U.translate(Tp.x,Tp.y),v.drawImage(U,v.getImage("xeditinteractor_elevationIcon"),Rm,-Rm,Sg,Sg),U.translate(-Tp.x,-Tp.y),b._pointElevationHelperPoint={x:Tp.x+Sg,y:Tp.y}}else if(Xg instanceof o){var Jg=lq(s.getDataUI(Xg),Xg.s("edge.points")),Tp=v.clone(Jg.get(Yg));Tp.x*=Y,Tp.y*=Y,U.translate(Tp.x,Tp.y),v.drawImage(U,v.getImage("xeditinteractor_elevationIcon"),Rm,-Rm,Sg,Sg),U.translate(-Tp.x,-Tp.y),b._pointElevationHelperPoint={x:Tp.x+Sg,y:Tp.y}}}U.restore(),b.$5l=0}},$89l:function(f,K,P,Q){f.save();var z=this,a=z.gv,d=a.getEditHelperSize(),T=d/2;f.beginPath(),f.translate(P.x,P.y),f.rotate(K),v.drawImage(f,Q,-T,-T,d,d),f.restore()},$85l:function(Q,M,R){var y=this;y.$90l=R,y.$89l(Q,M,R,v.getImage("xeditinteractor_elevationIcon"))},$86l:function(q,y,T){var B=this;B.$91l=T,B.$89l(q,y,T,v.getImage("xeditinteractor_tallIcon"))},$77l:function(G,F,t){var K=this;K.$68l=t,K.$89l(G,F,t,v.getImage("xeditinteractor_hostIcon"))},$80l:function(_,O,Q){var H=this;H.$70l=Q,H.$89l(_,O,Q,v.getImage("xeditinteractor_edgeIcon"))},$81l:function(V,Q,K){var X=this;X.$71l=K,X.$89l(V,Q,K,v.getImage("xeditinteractor_removeIcon"))},$76l:function(D,C,A){var w=this;w.$69l=A,w.$89l(D,C,A,v.getImage("xeditinteractor_parentIcon"))},$84l:function(u,t,o,T,M){var z,r=this,n=r.gv,m=n.getZoom(),I=n.getEditHelperSize(),G=I/2;o.x*=m,o.y*=m,M&&(T?o.x-=G+5:o.x+=G+5),o.y-=I-2,T?(r.$82l=o,z=v.getImage("xeditinteractor_sourceIcon")):(r.$83l=o,z=v.getImage("xeditinteractor_targetIcon")),u.beginPath(),u.translate(o.x,o.y),v.drawImage(u,z,-G,-G,I,I),u.translate(-o.x,-o.y)},$44l:function(h,V,L){h.save();var X=this.gv.getZoom(),w=l(g(V.width,2)+g(V.height,2))/2*X+10,O=w,t=O+8,G=O+18,H=L,i=V.x+V.width/2,o=V.y+V.height/2;h.translate(i*X,o*X),h.beginPath(),h.strokeStyle="rgb(150, 150, 150)";for(var Q=0,s=0,J=0,Y=0,f=0,r=0;360>r;r++)Q=r*F/180,0===r%5&&(s=Z(Q)*O,J=A(Q)*O,Y=Z(Q)*t,f=A(Q)*t,h.moveTo(s,J),h.lineTo(Y,f)),0===r%45&&(s=Z(Q)*O,J=A(Q)*O,Y=Z(Q)*G,f=A(Q)*G,h.moveTo(s,J),h.lineTo(Y,f));h.stroke(),h.beginPath(),h.rotate(-x),h.beginPath(),h.fillStyle="rgba(255, 0, 0, 0.1)",h.strokeStyle="rgb(157, 157, 157)",h.moveTo(0,0),h.arc(0,0,G,0,L,!1),h.fill(),h.beginPath(),h.moveTo(0+G,0),h.arc(0,0,G,0,L,!1),h.stroke(),h.rotate(x),h.font="bold 12px Verdana, Arial";var u=20*A(H),M=20*Z(H),R=W(180*H/F)+"°";h.textAlign="center",h.textBaseline="middle",h.beginPath();var z=h.measureText("365.°").width;h.fillStyle="white",h.rect(u-z/2,-M-10,z,20),h.fill(),h.beginPath(),h.fillStyle="rgb(79,79,79)",h.fillText(R,u,-M),h.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);