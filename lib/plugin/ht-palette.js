!function(j,J,Y){"use strict";var $="px",G="0",n="innerHTML",r="className",k=ht.Default,x=ht.Color,L=ht.Node,H="position",b="top",o="left",u=k.animate,p=k.getInternal(),e="width",G="0",a="none",l="max-height",m="font",O="background",A="border-box",v="user-select",R="box-sizing",_="overflow",U=k.isTouchable,p=k.getInternal(),T=x.titleIconBackground,I=k.scrollBarInteractiveSize,h=/msie 9/.test(j.navigator?j.navigator.userAgent.toLowerCase():""),i=null,q=function(){return document},D=function(r){return q().createElement(r)},F=function(){return D("div")},C=function(){var f=F(),n=f.style;return n.msTouchAction=a,n.cursor="default",U&&n.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",i),n.position="absolute",n.left=G,n.top=G,f},E=function(){return D("canvas")},y=function(){return document.body},g=function(U,S,G){U.style.setProperty(S,G,i)},S=function(k,J){k.style.removeProperty(J)},M=function(Q,e,E){k.def(ht.widget[Q],e,E)},w=function(d,h){d.appendChild(h)},t=function(A,w){A.removeChild(w)},X=p.addEventListener;p.removeEventListener,p.addMethod(k,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:T,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:T}]},paletteTitleLabelColor:k.labelSelectColor,paletteTitleLabelFont:k.labelFont,paletteContentLabelFont:k.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:k.widgetTitleHeight,paletteTitleBackground:x.titleBackground,paletteTitleHoverBackground:x.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:Y,paletteItemHoverBorderColor:x.highlight,paletteItemSelectBackground:x.highlight},!0);var s=".palette-item:hover{border: 1px solid "+k.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+k.paletteTitleHoverBackground+" !important}",f=document.createElement("style");U||(f.styleSheet?f.styleSheet.cssText=s:f.appendChild(q().createTextNode(s))),q().getElementsByTagName("head")[0].appendChild(f);var B=function(a){var v=this;v.$22h=a,v.addListeners()};k.def(B,J,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var x=this;x.$36h&&y().removeChild(x.$36h),x.$23h=x.$24h=x.$25h=x.$35h=x.$36h=i},handle_touchstart:function(_){for(var F,u=this,v=u.$22h,Q=_.target,$=v.sm(),l=v.dm(),A="palette-header",M="palette-header-tool",m="palette-item",t=!1,B=!1,j=!1;Q&&(Q[r]||"").indexOf(A)<0&&(Q[r]||"").indexOf(m)<0;)Q=Q.parentNode;if(Q&&Q[r].indexOf(M)>=0?t=!0:Q&&Q[r].indexOf(A)>=0?j=!0:Q&&Q[r].indexOf(m)>=0&&(B=!0),k.isLeftButton(_))if(u.$27h(_))u.$24h=k.getClientPoint(_),u.$25h=v.ty();else if(t){k.preventDefault(_),F=Q.parentNode.$11h;var N=l.getDataById(F),o=N.s("tools")[Q.toolIndex];o.action&&o.action.call(v)}else if(j){k.preventDefault(_),F=Q.$11h;var N=l.getDataById(F);N.isExpanded()?N.setExpanded(!1):N.setExpanded(!0)}else if(B){F=Q.$11h;var T=l.getDataById(F);$.ss(T),v.handleDragAndDrop&&(k.preventDefault(_),T.s("draggable")&&(v.handleDragAndDrop(_,"prepare"),u.$35h=0)),T.s("draggable")||(k.preventDefault(_),u.$24h=k.getClientPoint(_),u.$25h=v.ty())}else k.preventDefault(_),u.$24h=k.getClientPoint(_),u.$25h=v.ty();else u.$26h(_)},handle_mousedown:function(b){this.handle_touchstart(b)},handle_mousewheel:function(j){this.handleScroll(j,j.wheelDelta/40,j.wheelDelta!==j.wheelDeltaX)},handle_DOMMouseScroll:function(O){this.handleScroll(O,-O.detail,1)},handleScroll:function(d,x,m){var q=this.$22h;k.preventDefault(d),m&&q._41o()&&q.ty(q.ty()+20*x)},handle_mouseup:function(E){this.handle_touchend(E)},handle_touchend:function(y){var d=this;d.$37h(y),d.$26h(y)},handleWindowMouseUp:function(o){this.handleWindowTouchEnd(o)},handleWindowTouchEnd:function(j){var e=this;e.$37h(j),e.$26h(j)},$37h:function(q){var e=this,h=e.$22h;2===e.$35h&&(e.$35h=3,h.handleDragAndDrop(q,"end"))},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(b){var I=this,L=I.$22h,s=I.$23h,B=I.$24h,l=I.$25h,e=k.getClientPoint(b),q=L._29I,m=I.$36h;if(1===I.$35h||2===I.$35h){if(I.$35h=2,L.handleDragAndDrop(b,"between"),U){var H=b.touches[0];b=H?H:b.changedTouches[0]}m.style.left=b.pageX-parseInt(m.width)/2+$,m.style.top=b.pageY-parseInt(m.height)/2+$}else"p"===s?L.ty(l+e.y-B.y):"v"===s&&L.ty(l+(B.y-e.y)/q.height*L._59I)},handle_mousemove:function(L){this.handle_touchmove(L)},handle_touchmove:function(O){if(!k.isDragging()&&k.isLeftButton(O)){var B=this,p=B.$22h,j=B.$27h(O);if(B.$24h){if(!B.$23h){if(k.getDistance(k.getClientPoint(O),B.$24h)<2)return;B.$23h=j?"v":"p",k.startDragging(B)}}else if(j)p._43o();else if(0===B.$35h){if(B.$35h=1,p.handleDragAndDrop(O,"begin"),U){var w=O.touches[0];O=w?w:O.changedTouches[0]}var R=B.$36h=new Image,M=p.$10h[p.sm().ld().getId()].querySelector(".image-box"),Q=parseInt(M.style.width),I=parseInt(M.style.height);R.draggable=!1,R.src=M.toDataURL(),R.width=Q,R.height=I,R.style.position="absolute",R.style.left=O.pageX-Q/2+$,R.style.top=O.pageY-I/2+$,y().appendChild(R),k.startDragging(B)}}},$27h:function(s){var m=this.$22h,L=m.getView(),y=L.getBoundingClientRect(),t=m._29I,K=s.clientX-y.left+L.scrollLeft;return m._41o()&&t.x+t.width-K<I}}),ht.widget.Palette=function(Q){var T=this,L=T._view=p.createView(null,T);T.$9h={},T.$10h={},T.$4h={},T._29I={x:0,y:0,width:0,height:0},T._59I=0,T.dm(Q?Q:new ht.DataModel),L[r]="ht-widget-palette",T.$29h=new B(T),g(L,O,k.paletteContentBackground),g(L,_,"auto"),g(L,R,A),g(L,"-moz-"+R,A),g(L,"-webkit-"+v,a),g(L,"-moz-"+v,a),g(L,"-ms-"+v,a),g(L,v,a),g(L,"position","absolute"),g(L,"overflow","hidden"),w(L,T._79O=C()),X(L,"dragstart",function(n){n.dataTransfer&&(n.dataTransfer.setData("Text","nodeid:"+n.target.$11h),n.dataTransfer.effectAllowed="all",T.$29h.$26h())})},M("Palette",J,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:k.autoHideScrollBar,_scrollBarSize:k.scrollBarSize,_scrollBarColor:k.scrollBarColor,getViewRect:function(){return this._29I},ty:function(Y){return Y==i?this.getTranslateY():(this.setTranslateY(Y),void 0)},setTranslateY:function(Y){if(this.$32h==i){var A=this,s=A.$33h(Y),f=A.$30h;A.$30h=s,A.fp("translateY",f,s)}},getTranslateY:function(){return this.$30h},setLayout:function(H){var Y,y,k=this,$=k._layout;k._layout=H,"smallicons"===H?Y=y=20:"iconsonly"===H?Y=y=50:(Y=70,y=50),k.setItemImageWidth(Y),k.setItemImageHeight(y),k.setItemImagePadding(4),k.fp("layout",$,H)},getDataAt:function(l){for(var G=l.target;G&&G.$11h==i;)G=G.parentNode;return G&&G.$11h!=i?this.getDataModel().getDataById(G.$11h):void 0},$20h:function(){var T=16;return U&&(T*=1.2),T},$19h:function(){return k.paletteTitleHeight},$18h:function(){var X=k.paletteSeparatorWidth,r=k.paletteTitleBackground,y=k.paletteSeparatorColor||k.brighter(r);return X+$+" solid "+y},$17h:function(i){g(i,"cursor","pointer"),g(i,"display","inline-block"),g(i,"margin-right",(U?8:4)+$),g(i,"vertical-align",b)},$1h:function(N){var l=this,M=F(),z=F(),L=D("span");M[r]="palette-header",g(M,H,"relative"),g(M,O,k.paletteTitleBackground),g(M,"color",k.paletteTitleLabelColor),g(M,b,G),g(M,R,A),g(M,"-moz-"+R,A),g(M,"padding","0 5px 0 0"),g(M,"border-top",l.$18h()),g(M,e,"100%"),g(M,"cursor","pointer"),g(M,"white-space","nowrap"),g(M,_,"hidden"),g(M,m,k.paletteTitleLabelFont),g(M,"line-height",l.$19h()+$),M.$11h=N.getId();var o=E(),J=l.$19h(),i=l.$20h();l.$17h(o),p.setCanvas(o,i,J),w(M,o);var h=N.s("tools");if(h)for(var x=0;x<h.length;x++){var Q=E();l.$17h(Q),p.setCanvas(Q,i,J),Q[r]="palette-header-tool palette-header-tool"+N.getId()+"-"+x,Q.style.position="absolute",Q.style.right=(i+10)*x+"px",Q.toolIndex=x,w(M,Q)}return o[r]="palette-toggle-icon-"+N.getId(),z[r]="palette-content",g(z,"max-height",0+$),g(z,m,k.paletteContentLabelFont),g(z,_,"hidden"),z.$11h=N.getId(),l.$9h[N.getId()]=z,L[n]=N.getName(),g(L,m,k.paletteTitleLabelFont),w(M,o),w(M,L),[M,z]},$2h:function(V){var l=this,A=l._layout,j=h&&V.s("draggable")?D("a"):F(),v=E(),z=F(),S=V.getName()||"",P=V.s("title")||V.getToolTip()||S,t=l._itemMargin;v[r]="image-box";var i=l.getItemImageWidth(),N=l.getItemImageHeight();return p.setCanvas(v,i,N),w(j,v),z[n]=S,z[r]="label-box","iconsonly"!==A&&w(j,z),j[r]="palette-item",g(j,"vertical-align",b),g(j,"cursor","pointer"),g(j,"border-radius",5+$),g(j,"border","1px solid transparent"),g(j,"text-align","center"),g(j,"display","inline-block"),g(j,"margin-left",t+$),g(j,"margin-top",t+$),g(j,"color",k.paletteContentLabelColor),"smallicons"===A?(g(v,"vertical-align","middle"),g(j,"margin-left",2+$),g(j,"margin-top",2+$),g(j,"padding",2+$),g(j,"text-align",o),g(z,"display","inline-block"),g(z,"min-width",l.$21h+l._itemMargin+$)):"largeicons"===A&&(g(z,"max-width",i+$),g(z,"overflow","hidden")),j.$11h=V.getId(),P&&(j.title=P),V.s("draggable")&&!l.handleDragAndDrop&&(h?(j.href="#",g(j,"text-decoration",a)):j.draggable="true"),j},$16h:function(G,v,n,i){var $=p.initContext(G);p.translateAndScale($,0,0,1),$.clearRect(0,0,n,n);var E=(n-i)/2;k.drawStretchImage($,k.getImage(v),"fill",0,E,i,i),$.restore()},$15h:function(J){var m=this,d=J.getId(),c=m._view.querySelector(".palette-toggle-icon-"+d),M=J.isExpanded()?k.paletteCollapseIcon:k.paletteExpandIcon;if(c&&M){var $=m.$19h(),s=m.$20h();m.$16h(c,M,$,s)}},_drawToolsIcon:function(L){var j=this,t=L.s("tools");if(t)for(var p=0;p<t.length;p++){var P=j._view.querySelector(".palette-header-tool"+L.getId()+"-"+p),$=t[p].icon,Z=j.$19h(),m=j.$20h();j.$16h(P,$,Z,m)}},$14h:function(e){var C=this,M=e.getId(),Q=C.$10h[M].querySelector(".image-box"),A=e.getImage(),_=e.s("image.stretch");if(Q&&A){var J=p.initContext(Q),n=C.getItemImagePadding();n="smallicons"===C._layout?n/2:n;var m=C.getItemImageWidth()-2*n,B=C.getItemImageHeight()-2*n;p.translateAndScale(J,0,0,1),J.clearRect(0,0,m,B),k.drawStretchImage(J,k.getImage(A),_,n,n,m,B,e,C),J.restore()}},validateImpl:function(){var m,j,g,y=this,O=y.$9h,a=y._layout,f=y.$10h,P=y.$4h,p=y._view,K=y.dm();if(y.$13h&&(delete y.$13h,P={},K.each(function(s){P[s.getId()]=s})),"smallicons"===a)for(var Y in P){var I=P[Y];if(I instanceof L){var Q=I.getName()||"",S=k.getTextSize(k.paletteContentLabelFont,Q).width;y.$21h!=i&&y.$21h>S||(y.$21h=S)}}for(var Y in P){g=P[Y];var M,e;if(K.contains(g)){if(g instanceof ht.Group){var F,V=y.$1h(g),o=f[g.getId()];o&&(F=o.nextSibling,t(p,F),t(p,o)),j=K.getSiblings(g).indexOf(g);var s=p.children[2*j]||y._79O;s&&s.parentNode?(p.insertBefore(V[0],s),p.insertBefore(F||V[1],s)):(p.appendChild(V[0]),p.appendChild(F||V[1])),f[g.getId()]=V[0],m=O[g.getId()]=F||V[1],e=g.$12h;var Z=g.s("promptText");e||(g.$12h=D("div"),g.$12h[n]=Z||"",e=g.$12h),0===g.getChildren().size()?m.contains(e)||w(m,e):m.contains(e)&&t(m,e)}else if(M=g.getParent()){var A=y.$2h(g),z=f[g.getId()];m=O[M.getId()],z&&t(z.parentNode,z),j=K.getSiblings(g).indexOf(g);var r=m.children[j];r?m.insertBefore(A,r):w(m,A),f[g.getId()]=A,y.$14h(g)}}else{var N=f[g.getId()],W=N.parentNode;if(g instanceof ht.Group){var h=N.nextSibling;t(p,N),t(p,h),delete O[g.getId()]}else t(W,N),0===W.children.length&&(M=K.getDataById(W.$11h),M&&(e=M.$12h,e&&!W.contains(e)&&w(W,e)));delete f[g.getId()]}}y.$4h={};var H=function(){var z=y._59I,v=0;y.$32h!=i&&(clearInterval(y.$32h),v=0,delete y.$32h),y.$32h=setInterval(function(){y.$31h(),z===y._59I?(v++,v>=2&&(clearInterval(y.$32h),delete y.$32h)):(v=0,z=y._59I)},30)};for(var R in O)if(m=O[R],g=K.getDataById(O[R].$11h),y.$15h(g),y._drawToolsIcon(g),g.isExpanded()){if(m.style.maxHeight===0+$){var E=m.scrollHeight+y._itemMargin+$;u(m).duration(200).set(l,E).set("padding-bottom",y._itemMargin+$).end(function(){return function(){H()}}(E))}else m.style.maxHeight=m.scrollHeight+$;m.style.paddingBottom=y._itemMargin+$}else m.style.maxHeight!==0+$&&u(m).duration(200).set(l,G).set("padding-bottom",G).end(function(){return function(){H()}}(m));y.$28h(),y.$31h()},$31h:function(){for(var o=this,M=o._view,N=0,V=M.children,l=0;l<V.length;l++){var A=V[l];A.className&&A.className.indexOf("palette-")>=0&&(N+=A.offsetHeight)}o._59I=N,o.$30h=o.$33h(o.ty());var C=o.ty();M.scrollTop=-C,o._29I={x:0,y:-C,width:M.clientWidth,height:M.clientHeight},g(o._79O,b,-C+$),o._93I()},$33h:function(i){var k=this,u=k._29I.height-k._59I;return u>i&&(i=u),i>0?0:Math.round(i)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(v){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(v.property)<0&&this.redraw(),"translateY"===v.property&&(this.iv(),this._43o())},findDataByName:function(U){for(var b=this.dm().getDatas(),B=0;B<b.size();B++){var N=b.get(B);if(N.getName()===U)return N}},setDataModel:function(G){var B=this,J=B._dataModel,L=B._selectionModel;J!==G&&(J&&(J.umm(B.$6h,B),J.umd(B.$8h,B),J.umh(B.$7h,B),L||J.sm().ums(B.$28h,B)),B._dataModel=G,G.mm(B.$6h,B),G.md(B.$8h,B),G.mh(B.$7h,B),L?L._21I(G):G.sm().ms(B.$28h,B),B.sm().setSelectionMode("single"),B.fp("dataModel",J,G))},$6h:function(z){var u=this,l=u._view,k=z.data,e=u.$4h;"add"===z.kind?e[k.getId()]=k:"remove"===z.kind?e[k.getId()]=k:"clear"===z.kind&&(u.$10h={},u.$9h={},u.$4h={},l[n]=""),u.iv()},$7h:function(g){var R=this,F=g.data;R.$4h[F.getId()]=F,R.iv()},$8h:function(f){var $=this,W=f.data,E=f.property;"expanded"===E?$.iv():($.$4h[W.getId()]=W,$.iv())},$28h:function(){var x,I=this,v=I.sm(),K="palette-item",Q=v.ld();this.dm().each(function(v){x=I.$10h[v.getId()],x&&x[r].indexOf(K)>=0&&(v===Q?g(x,O,k.paletteItemSelectBackground):S(x,O))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);