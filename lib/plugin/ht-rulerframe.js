!function(y,v){"use strict";var M="position",i="absolute",S="relative",s="px",Q="left",R="right",N="top",K="bottom",t="display",H="none",_="block",q=ht.Default,A=q.getInternal(),I=Math.floor,x=Math.ceil,Z=Math.PI,E=null,j=y.parseInt,C=function(l){return l.getContext("2d")},Y=function(){return document},p=function(x){return Y().createElement(x)},G=function(){return p("canvas")},O=function(W,C,v){W.style.setProperty(C,v,E)},g=function(g,K,u){q.def(ht.widget[g],K,u)},d=function(W,x){W.appendChild(x)},X=function(l,T){l.removeChild(T)},A=q.getInternal(),l=A.addEventListener,U=A.removeEventListener;ht.widget.RulerFrame=function(H){var t=this,R=t._view=A.createView(null,t),z=t.$1k=G(),n=t.$2k=G(),I=t.$3k=G(),u=t.$4k=G();t._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},t._topRulerConfig={visible:!0},t._rightRulerConfig={visible:!1},t._bottomRulerConfig={visible:!1},t._leftRulerConfig={visible:!0},d(R,z),d(R,I),d(R,n),d(R,u),O(R,M,S),O(R,"box-sizing","border-box"),O(R,"-moz-box-sizing","border-box"),O(z,M,i),O(n,M,i),O(I,M,i),O(u,M,i),t.$14k=function(){t.$13k=1,t.iv()},t.$15k=function(y){if(t._topRulerConfig.guideVisible||t._rightRulerConfig.guideVisible||t._bottomRulerConfig.guideVisible||t._leftRulerConfig.guideVisible||t._defaultRulerConfig.guideVisible||(t._topRulerConfig.guideTipVisible||t._rightRulerConfig.guideTipVisible||t._bottomRulerConfig.guideTipVisible||t._leftRulerConfig.guideTipVisible||t._defaultRulerConfig.guideTipVisible)&&t._component){var z=R.getBoundingClientRect();t.$16k={x:y.clientX-z.left,y:y.clientY-z.top},t.$5k()}},t.setComponent(H)},g("RulerFrame",v,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(n){var W=this,R=W._component,Q=W.getView();if(Q){if(W._component=n,W.fp("component",R,n),R){var Y=W.getComponentView(R);X(Q,Y),U(Q,"mousemove",W.$15k),W.removeComponentPropertyChangeListener(R,W.$14k)}if(n){var v=W.getComponentView(n);d(Q,v),O(v,M,i),l(Q,"mousemove",W.$15k),W.addComponentPropertyChangeListener(n,W.$14k)}}},addComponentPropertyChangeListener:function(i,x){i&&i.mp&&i.mp(x)},removeComponentPropertyChangeListener:function(v,s){v&&v.ump&&v.ump(s)},getComponentHZoom:function(B){return B&&B.getZoom?B.getZoom():1},getComponentVZoom:function(J){return J&&J.getZoom?J.getZoom():1},getComponentViewRect:function(v){return v&&v.getViewRect?v.getViewRect():void 0},getComponentView:function(P){return P&&P.getView?P.getView():P},invalidateComponent:function(X){X&&X.iv&&X.iv()},validateComponent:function(K){K&&K.validate&&K.validate()},$7k:function(G,W,i,Z,U,w,Q,h,y,r,X,I){if(W.visible){var s=this._defaultRulerConfig,$="borderStyle",N="borderColor",Y="borderWidth",n="background",j=W[$]||s[$],o=W[N]||s[N],k=W[Y]||s[Y],v=W.size!=E?W.size:s.size,q=W[n]||s[n],J=v+k,C=this.$6k(k,j,o,G,i,U,J,Q,h,y,r,X,I);O(G,U,"0px"),w?A.setCanvas(G,Z-C,v):A.setCanvas(G,v,Z-C),O(G,"background",q),O(G,t,_)}else O(G,t,H),O(this.getComponentView(this._component),U,"0px")},$6k:function(f,b,Z,u,E,B,t,c,U,Y,h,Q,z){var V=0;return O(u,E,f+"px "+b+" "+Z),O(this.getComponentView(this._component),B,t+s),c?(O(u,U,Y+s),V+=Y):O(u,U,"0px"),h?(O(u,Q,z+s),V+=z):O(u,Q,"0px"),V},validateImpl:function(){var l=this,T=l._component,D=l.$1k,o=l.$2k,h=l.$3k,v=l.$4k,r=l._view,y=l._defaultRulerConfig,f=l._topRulerConfig,O=l._rightRulerConfig,k=l._bottomRulerConfig,A=l._leftRulerConfig,w=y.size;if(r&&T){var j=f.size!=E?f.size:w,x=O.size!=E?O.size:w,Y=k.size!=E?k.size:w,F=A.size!=E?A.size:w;l.$7k(D,f,"border-bottom",r.offsetWidth,N,!0,A.visible,Q,F,O.visible,R,x),l.$7k(o,O,"border-left",r.offsetHeight,R,!1,f.visible,N,j,k.visible,K,Y),l.$7k(h,k,"border-top",r.offsetWidth,K,!0,A.visible,Q,F,O.visible,R,x),l.$7k(v,A,"border-right",r.offsetHeight,Q,!1,f.visible,N,j,k.visible,K,Y),l.$13k?delete l.$13k:l.invalidateComponent(T),l.validateComponent(T),l.$5k()}},$5k:function(){function c(G,J,X,H,x,I){if(J.visible){var e=C(G),h=J[p]||T,z=J[A]!=E?J[A]:b,q=J[m]||r,d=J[Y]||K,c=J.size!=E?J.size:F,Ag=J[O]||l,Te=J[P]||B,Ml=J[k]||u,Jq=J[Z]!=E?J[Z]:U,Qq=J[v]!=E?J[v]:R,Dr=J[t]!=E?J[t]:M,$c=J[V]!=E?J[V]:_,Tk=J[j]!=E?J[j]:a,gr=J[n]!=E?J[n]:L,_b=J[y]||Xf,Gi=J[i]||Kc;z&&(h=w[I]=w.$8k(w[I]||h,J[Q]||f,J[W]||D,H?s:$,Te)),X.call(w,e,g,o,N,S,c,H?s:$,h,q,d,x,Ag,Ml);var kh=w.$16k;(Jq||Qq)&&kh&&(H?w.$9k(e,kh.x,c,_b,Gi,Jq,Qq,Dr,$c,Tk,gr):w.$10k(e,kh.y,c,_b,Gi,Jq,Qq,Dr,$c,Tk,gr,x))}}var w=this,q=w.$1k,e=w.$2k,J=w.$3k,I=w.$4k,H=w._topRulerConfig,d=w._rightRulerConfig,x=w._bottomRulerConfig,h=w._leftRulerConfig,G=w._defaultRulerConfig,X=w._component,z=w.getComponentViewRect(X),s=w.getComponentHZoom(X),$=w.getComponentVZoom(X),g=z.x*s,N=g+z.width*s,o=z.y*$,S=o+z.height*$,F=w._defaultRulerConfig.size,p="defaultMajorTickSpacing",Q="maxPhysicalMajorTickSpacing",W="minPhysicalMajorTickSpacing",A="tickSpacingAdaptable",m="majorTickTextFont",Y="majorTickTextColor",O="majorTickColor",k="minorTickColor",Z="guideVisible",v="guideTipVisible",t="guideTipBorderColor",V="guideTipTextColor",j="guideTipTextFont",n="guideTipBackground",y="guideColor",i="guideWidth",P="minMajorTickSpacing",T=G[p],f=G[Q],D=G[W],b=G[A],r=G[m],K=G[Y],l=G[O],B=G[P],u=G[k],U=G[Z],R=G[v],M=G[t],_=G[V],a=G[j],L=G[n],Xf=G[y],Kc=G[i];w._view&&X&&(c(q,H,w.$11k,!0,!1,"_currentTopMajorTickSpacing"),c(e,d,w.$12k,!1,!0,"_currentRightMajorTickSpacing"),c(J,x,w.$11k,!0,!0,"_currentBottomMajorTickSpacing"),c(I,h,w.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(j,m,O,g,G){return O>j*g?j=I(m/g/G)*G:j*g>m&&(j=x(O/g/G)*G),j},getHTipText:function(U){var V=this,g=V._component,N=0,P=V._view.getBoundingClientRect();return g.lp?N=j(g.lp({x:U.x+P.left,y:U.y}).x):N-=j(this.getComponentView(g).style.left)||0,N},$9k:function(U,m,S,W,E,p,B,o,s,k,f){var l=this,L=l._component;U.save(),A.translateAndScale(U,0,0,1);var c=m-(j(this.getComponentView(L).style.left)||0),K=0;if(m=l.getHTipText(l.$16k),p&&(U.beginPath(),U.fillStyle=W,U.rect(c,K,E,S),U.fill()),B){U.beginPath(),U.textAlign="center",U.textBaseline="middle",U.font=k;var V=U.measureText(m).width+6;U.fillStyle=f,U.rect(c-V/2,K,V,S),U.fill(),U.strokeStyle=o,U.stroke(),U.beginPath(),U.fillStyle=s,U.fillText(m,c,K+S/2)}U.restore()},getVTipText:function(W){var c=this,y=c._component,r=0,T=c._view.getBoundingClientRect();return y.lp?r=j(y.lp({x:W.x,y:W.y+T.top}).y):r-=j(this.getComponentView(y).style.top)||0,r},formatScaleText:function(N){return Math.round(N)},$10k:function(O,W,y,w,p,G,s,z,r,P,f,m){var F=this,q=F._component;O.save(),A.translateAndScale(O,0,0,1);var S=y/2,I=W-(j(this.getComponentView(q).style.top)||0);if(W=F.getVTipText(F.$16k),G&&(O.beginPath(),O.fillStyle=w,O.rect(S-y/2,I,y,p),O.fill()),s){O.translate(S,I),O.rotate((m?90:-90)*Z/180),O.translate(-S,-I),O.beginPath(),O.textAlign="center",O.textBaseline="middle",O.font=P;var v=O.measureText(W).width+6;O.fillStyle=f,O.rect(S-v/2,I-y/2,v,y),O.fill(),O.strokeStyle=z,O.stroke(),O.fillStyle=r,O.fillText(W,S,I)}O.restore()},$11k:function(P,m,L,f,p,K,X,U,W,J,_,a,F){P.save(),L=0;var s=m,E=f,x=(s+E)/2;m=0,f=E-s,A.translateAndScale(P,0,0,1);var r=0,Z=0,c=j(K/2),n=K-c,k=_?0:c,C=U*X,$=C/10;m-=C,f+=C,P.clearRect(m,0,f-m,K),P.beginPath(),P.fillStyle=F;var i=I(x/$)*$-s;for(r=i;f>r;r+=$)P.rect(r,L+k,1,n);for(r=i;r>m;r-=$)P.rect(r,L+k,1,n);for(P.fill(),k=_?0:1,P.beginPath(),P.fillStyle=a,i=I(x/C)*C-s,r=i;f>r;r+=C)P.rect(r,L+k,1,K-1);for(r=i;r>m;r-=C)P.rect(r,L+k,1,K-1);P.fill();var e=j(/\d+px/.exec(W)[0]),z=(e||10)/2;P.textBaseline="middle",k=_?K-z-2:z+2,P.beginPath(),P.fillStyle=J,P.font=W;var l=I(x/C)*C/X;for(r=i,Z=l;f>r;r+=C,Z+=U){var t=this.getHScaleText?this.getHScaleText(r):Z;P.fillText(this.formatScaleText(t),r+2,L+k)}for(r=i,Z=l;r>m;r-=C,Z-=U){var t=this.getHScaleText?this.getHScaleText(r):Z;P.fillText(this.formatScaleText(t),r+2,L+k)}P.restore()},$12k:function(R,N,Y,b,h,W,P,S,_,c,B,w,k){function C(I,r,$,L,m,V){m=F.getVScaleText?F.getVScaleText($):m,m=F.formatScaleText(m),R.translate(I+r,$),R.rotate(-L),R.translate(-I-r,-$),R.fillText(m,I+r+(V?2:1),$),R.translate(I+r,$),R.rotate(L),R.translate(-I-r,-$)}R.save(),N=0;var X=Y,o=h,e=(X+o)/2;Y=0,h=o-X,A.translateAndScale(R,0,0,1);var m=0,F=this,g=0,q=j(W/2),E=W-q,H=B?0:q,f=S*P,i=f/10;Y-=f,h+=f,R.clearRect(N,0,W,h-Y),R.beginPath(),R.fillStyle=k;var z=I(e/i)*i-X;for(m=z;h>m;m+=i)R.rect(N+H,m,E,1);for(m=z;m>Y;m-=i)R.rect(N+H,m,E,1);for(R.fill(),H=B?0:1,R.beginPath(),R.fillStyle=w,z=I(e/f)*f-X,m=z;h>m;m+=f)R.rect(N+H,m,W-1,1);for(m=z;m>Y;m-=f)R.rect(N+H,m,W-1,1);R.fill();var T=j(/\d+px/.exec(_)[0]),d=(T||10)/2,u=90*Z/180;R.textBaseline="middle",H=B?W-d:d+2,u=B?-u:u,R.beginPath(),R.fillStyle=c,R.font=_;var y=I(e/f)*f/P;for(m=z,g=y;h>m;m+=f,g+=S)C(N,H,m,u,g,B);for(m=z,g=y;m>Y;m-=f,g-=S)C(N,H,m,u,g,B);R.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var h=this,V=h._component,i=h._view;V&&h.removeComponentPropertyChangeListener(V,h.$14k),i&&(U(i,"mousemove",h.$15k),X(i.parentNode,i),h._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);