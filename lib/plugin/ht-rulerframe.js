!function(Y,d){"use strict";var w="position",X="absolute",R="relative",J="px",_="left",S="right",B="top",m="bottom",k="display",c="none",x="block",r=ht.Default,T=r.getInternal(),V=Math.floor,O=Math.ceil,F=Math.PI,l=null,M=Y.parseInt,u=function(F){return F.getContext("2d")},H=function(){return document},C=function(U){return H().createElement(U)},N=function(){return C("canvas")},U=function(b,N,R){b.style.setProperty(N,R,l)},g=function(l,b,f){r.def(ht.widget[l],b,f)},v=function(X,G){X.appendChild(G)},G=function(u,y){u.removeChild(y)},T=r.getInternal(),Q=T.addEventListener,D=T.removeEventListener;ht.widget.RulerFrame=function(d){var p=this,D=p._view=T.createView(null,p),i=p.$1k=N(),W=p.$2k=N(),y=p.$3k=N(),n=p.$4k=N();p._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},p._topRulerConfig={visible:!0},p._rightRulerConfig={visible:!1},p._bottomRulerConfig={visible:!1},p._leftRulerConfig={visible:!0},v(D,i),v(D,y),v(D,W),v(D,n),U(D,w,R),U(D,"box-sizing","border-box"),U(D,"-moz-box-sizing","border-box"),U(i,w,X),U(W,w,X),U(y,w,X),U(n,w,X),p.$14k=function(){p.$13k=1,p.iv()},p.$15k=function(n){if(p._topRulerConfig.guideVisible||p._rightRulerConfig.guideVisible||p._bottomRulerConfig.guideVisible||p._leftRulerConfig.guideVisible||p._defaultRulerConfig.guideVisible||(p._topRulerConfig.guideTipVisible||p._rightRulerConfig.guideTipVisible||p._bottomRulerConfig.guideTipVisible||p._leftRulerConfig.guideTipVisible||p._defaultRulerConfig.guideTipVisible)&&p._component){var B=D.getBoundingClientRect();p.$16k={x:n.clientX-B.left,y:n.clientY-B.top},p.$5k()}},p.setComponent(d)},g("RulerFrame",d,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(K){var p=this,Y=p._component,I=p.getView();if(I){if(p._component=K,p.fp("component",Y,K),Y){var Z=p.getComponentView(Y);G(I,Z),D(I,"mousemove",p.$15k),p.removeComponentPropertyChangeListener(Y,p.$14k)}if(K){var A=p.getComponentView(K);v(I,A),U(A,w,X),Q(I,"mousemove",p.$15k),p.addComponentPropertyChangeListener(K,p.$14k)}}},addComponentPropertyChangeListener:function(x,Y){x&&x.mp&&x.mp(Y)},removeComponentPropertyChangeListener:function(L,E){L&&L.ump&&L.ump(E)},getComponentHZoom:function(N){return N&&N.getZoom?N.getZoom():1},getComponentVZoom:function(c){return c&&c.getZoom?c.getZoom():1},getComponentViewRect:function($){return $&&$.getViewRect?$.getViewRect():void 0},getComponentView:function(B){return B&&B.getView?B.getView():B},invalidateComponent:function(x){x&&x.iv&&x.iv()},validateComponent:function(K){K&&K.validate&&K.validate()},$7k:function(K,F,n,J,g,o,L,q,O,R,E,_){if(F.visible){var Y=this._defaultRulerConfig,b="borderStyle",r="borderColor",h="borderWidth",y="background",v=F[b]||Y[b],j=F[r]||Y[r],M=F[h]||Y[h],G=F.size!=l?F.size:Y.size,A=F[y]||Y[y],B=G+M,W=this.$6k(M,v,j,K,n,g,B,L,q,O,R,E,_);U(K,g,"0px"),o?T.setCanvas(K,J-W,G):T.setCanvas(K,G,J-W),U(K,"background",A),U(K,k,x)}else U(K,k,c),U(this.getComponentView(this._component),g,"0px")},$6k:function(f,a,l,M,N,b,G,V,F,P,T,Q,R){var K=0;return U(M,N,f+"px "+a+" "+l),U(this.getComponentView(this._component),b,G+J),V?(U(M,F,P+J),K+=P):U(M,F,"0px"),T?(U(M,Q,R+J),K+=R):U(M,Q,"0px"),K},validateImpl:function(){var J=this,w=J._component,h=J.$1k,P=J.$2k,r=J.$3k,R=J.$4k,s=J._view,e=J._defaultRulerConfig,V=J._topRulerConfig,q=J._rightRulerConfig,W=J._bottomRulerConfig,E=J._leftRulerConfig,G=e.size;if(s&&w){var Y=V.size!=l?V.size:G,z=q.size!=l?q.size:G,c=W.size!=l?W.size:G,I=E.size!=l?E.size:G;J.$7k(h,V,"border-bottom",s.offsetWidth,B,!0,E.visible,_,I,q.visible,S,z),J.$7k(P,q,"border-left",s.offsetHeight,S,!1,V.visible,B,Y,W.visible,m,c),J.$7k(r,W,"border-top",s.offsetWidth,m,!0,E.visible,_,I,q.visible,S,z),J.$7k(R,E,"border-right",s.offsetHeight,_,!1,V.visible,B,Y,W.visible,m,c),J.$13k?delete J.$13k:J.invalidateComponent(w),J.validateComponent(w),J.$5k()}},$5k:function(){function y(g,G,y,X,v,V){if(G.visible){var _=u(g),c=G[s]||L,w=G[b]!=l?G[b]:r,j=G[S]||q,d=G[k]||O,Y=G.size!=l?G.size:C,pd=G[U]||R,Ph=G[M]||p,lr=G[z]||K,dm=G[a]!=l?G[a]:E,vn=G[P]!=l?G[P]:h,Hb=G[I]!=l?G[I]:N,Of=G[A]!=l?G[A]:$,mr=G[o]!=l?G[o]:x,Pi=G[J]!=l?G[J]:B,hi=G[W]||mg,Zh=G[t]||$e;w&&(c=D[V]=D.$8k(D[V]||c,G[Q]||F,G[i]||m,X?e:T,Ph)),y.call(D,_,H,f,n,Z,Y,X?e:T,c,j,d,v,pd,lr);var Rf=D.$16k;(dm||vn)&&Rf&&(X?D.$9k(_,Rf.x,Y,hi,Zh,dm,vn,Hb,Of,mr,Pi):D.$10k(_,Rf.y,Y,hi,Zh,dm,vn,Hb,Of,mr,Pi,v))}}var D=this,G=D.$1k,v=D.$2k,_=D.$3k,j=D.$4k,Y=D._topRulerConfig,X=D._rightRulerConfig,w=D._bottomRulerConfig,d=D._leftRulerConfig,g=D._defaultRulerConfig,c=D._component,V=D.getComponentViewRect(c),e=D.getComponentHZoom(c),T=D.getComponentVZoom(c),H=V.x*e,n=H+V.width*e,f=V.y*T,Z=f+V.height*T,C=D._defaultRulerConfig.size,s="defaultMajorTickSpacing",Q="maxPhysicalMajorTickSpacing",i="minPhysicalMajorTickSpacing",b="tickSpacingAdaptable",S="majorTickTextFont",k="majorTickTextColor",U="majorTickColor",z="minorTickColor",a="guideVisible",P="guideTipVisible",I="guideTipBorderColor",A="guideTipTextColor",o="guideTipTextFont",J="guideTipBackground",W="guideColor",t="guideWidth",M="minMajorTickSpacing",L=g[s],F=g[Q],m=g[i],r=g[b],q=g[S],O=g[k],R=g[U],p=g[M],K=g[z],E=g[a],h=g[P],N=g[I],$=g[A],x=g[o],B=g[J],mg=g[W],$e=g[t];D._view&&c&&(y(G,Y,D.$11k,!0,!1,"_currentTopMajorTickSpacing"),y(v,X,D.$12k,!1,!0,"_currentRightMajorTickSpacing"),y(_,w,D.$11k,!0,!0,"_currentBottomMajorTickSpacing"),y(j,d,D.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(g,d,n,o,w){return n>g*o?g=V(d/o/w)*w:g*o>d&&(g=O(n/o/w)*w),g},getHTipText:function(p){var q=this,$=q._component,i=0,Q=q._view.getBoundingClientRect();return $.lp?i=M($.lp({x:p.x+Q.left,y:p.y}).x):i-=M(this.getComponentView($).style.left)||0,i},$9k:function(f,C,u,g,J,I,t,m,h,r,O){var c=this,d=c._component;f.save(),T.translateAndScale(f,0,0,1);var v=C-(M(this.getComponentView(d).style.left)||0),W=0;if(C=c.getHTipText(c.$16k),I&&(f.beginPath(),f.fillStyle=g,f.rect(v,W,J,u),f.fill()),t){f.beginPath(),f.textAlign="center",f.textBaseline="middle",f.font=r;var q=f.measureText(C).width+6;f.fillStyle=O,f.rect(v-q/2,W,q,u),f.fill(),f.strokeStyle=m,f.stroke(),f.beginPath(),f.fillStyle=h,f.fillText(C,v,W+u/2)}f.restore()},getVTipText:function(l){var W=this,a=W._component,I=0,F=W._view.getBoundingClientRect();return a.lp?I=M(a.lp({x:l.x,y:l.y+F.top}).y):I-=M(this.getComponentView(a).style.top)||0,I},formatScaleText:function(z){return Math.round(z)},$10k:function(c,J,H,G,O,t,a,e,U,_,I,A){var u=this,$=u._component;c.save(),T.translateAndScale(c,0,0,1);var p=H/2,K=J-(M(this.getComponentView($).style.top)||0);if(J=u.getVTipText(u.$16k),t&&(c.beginPath(),c.fillStyle=G,c.rect(p-H/2,K,H,O),c.fill()),a){c.translate(p,K),c.rotate((A?90:-90)*F/180),c.translate(-p,-K),c.beginPath(),c.textAlign="center",c.textBaseline="middle",c.font=_;var W=c.measureText(J).width+6;c.fillStyle=I,c.rect(p-W/2,K-H/2,W,H),c.fill(),c.strokeStyle=e,c.stroke(),c.fillStyle=U,c.fillText(J,p,K)}c.restore()},$11k:function(s,b,l,v,z,U,g,X,F,x,Z,E,N){s.save(),l=0;var D=b,e=v,Y=(D+e)/2;b=0,v=e-D,T.translateAndScale(s,0,0,1);var W=0,t=0,o=M(U/2),G=U-o,p=Z?0:o,I=X*g,q=I/10;b-=I,v+=I,s.clearRect(b,0,v-b,U),s.beginPath(),s.fillStyle=N;var i=V(Y/q)*q-D;for(W=i;v>W;W+=q)s.rect(W,l+p,1,G);for(W=i;W>b;W-=q)s.rect(W,l+p,1,G);for(s.fill(),p=Z?0:1,s.beginPath(),s.fillStyle=E,i=V(Y/I)*I-D,W=i;v>W;W+=I)s.rect(W,l+p,1,U-1);for(W=i;W>b;W-=I)s.rect(W,l+p,1,U-1);s.fill();var R=M(/\d+px/.exec(F)[0]),Q=(R||10)/2;s.textBaseline="middle",p=Z?U-Q-2:Q+2,s.beginPath(),s.fillStyle=x,s.font=F;var L=V(Y/I)*I/g;for(W=i,t=L;v>W;W+=I,t+=X){var C=this.getHScaleText?this.getHScaleText(W):t;s.fillText(this.formatScaleText(C),W+2,l+p)}for(W=i,t=L;W>b;W-=I,t-=X){var C=this.getHScaleText?this.getHScaleText(W):t;s.fillText(this.formatScaleText(C),W+2,l+p)}s.restore()},$12k:function(D,s,z,B,R,P,X,p,Z,k,A,v,S){function w(E,I,o,N,U,m){U=n.getVScaleText?n.getVScaleText(o):U,U=n.formatScaleText(U),D.translate(E+I,o),D.rotate(-N),D.translate(-E-I,-o),D.fillText(U,E+I+(m?2:1),o),D.translate(E+I,o),D.rotate(N),D.translate(-E-I,-o)}D.save(),s=0;var g=z,t=R,j=(g+t)/2;z=0,R=t-g,T.translateAndScale(D,0,0,1);var N=0,n=this,m=0,q=M(P/2),o=P-q,O=A?0:q,C=p*X,b=C/10;z-=C,R+=C,D.clearRect(s,0,P,R-z),D.beginPath(),D.fillStyle=S;var G=V(j/b)*b-g;for(N=G;R>N;N+=b)D.rect(s+O,N,o,1);for(N=G;N>z;N-=b)D.rect(s+O,N,o,1);for(D.fill(),O=A?0:1,D.beginPath(),D.fillStyle=v,G=V(j/C)*C-g,N=G;R>N;N+=C)D.rect(s+O,N,P-1,1);for(N=G;N>z;N-=C)D.rect(s+O,N,P-1,1);D.fill();var y=M(/\d+px/.exec(Z)[0]),H=(y||10)/2,L=90*F/180;D.textBaseline="middle",O=A?P-H:H+2,L=A?-L:L,D.beginPath(),D.fillStyle=k,D.font=Z;var J=V(j/C)*C/X;for(N=G,m=J;R>N;N+=C,m+=p)w(s,O,N,L,m,A);for(N=G,m=J;N>z;N-=C,m-=p)w(s,O,N,L,m,A);D.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var H=this,J=H._component,v=H._view;J&&H.removeComponentPropertyChangeListener(J,H.$14k),v&&(D(v,"mousemove",H.$15k),G(v.parentNode,v),H._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);